(this.webpackJsonp=this.webpackJsonp||[]).push([[5,6,11],{228:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(10),a=n.n(r),c=n(5),o=n.n(c),i=n(25),s=n.n(i),l=n(26),u=n.n(l),b=n(238),j=n.n(b),d=n(54),f=n(657),O=n(115),g=n(293),m=n(82);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){function e(){s()(this,e)}var t,n,r,a;return u()(e,null,[{key:"writeToFile",value:(a=o()((function*(t){yield Object(m.a)(e.logFilePath,JSON.stringify(t)+"\n").catch((function(e){return console.log(e)}))})),function(e){return a.apply(this,arguments)})},{key:"logBasicDeviceInfo",value:(r=o()((function*(){if(!e.hasLoggedBasicDeviceInfo){var t={type:"DEVICE_INFO",appBuildNumber:f.a.getBuildNumber(),appBuildVariant:d.a.VARIANT||"",appVersion:g.version,appVersionBinary:f.a.getVersion(),osApiLevel:f.a.getApiLevelSync(),osName:f.a.getSystemName()||f.a.getBaseOsSync(),osVersion:f.a.getSystemVersion(),theme:O.a.getState().session.config.theme};yield e.writeToFile(t),e.hasLoggedBasicDeviceInfo=!0}})),function(){return r.apply(this,arguments)})},{key:"logRequest",value:(n=o()((function*(t){yield e.logBasicDeviceInfo(),parseInt(d.a.ENABLE_DEBUG_OPTIONS,10)&&(t.endpoint.includes("login")||(yield e.writeToFile(p({type:"REQUEST"},t))))})),function(e){return n.apply(this,arguments)})},{key:"logRequestSync",value:function(t){o()((function*(){yield e.logBasicDeviceInfo(),yield e.logRequest(t)}))()}},{key:"logError",value:(t=o()((function*(t){yield e.logBasicDeviceInfo(),yield e.writeToFile(p({type:"ERROR"},t))})),function(e){return t.apply(this,arguments)})}]),e}();y.logsDirectoryPath=Object(m.d)(),y.logFilePath=y.logsDirectoryPath+"/request_log-"+j()().format("YYYY-MM-DD-THHmmssSSS")+".txt",y.hasLoggedBasicDeviceInfo=!1},293:function(e){e.exports=JSON.parse('{"version":"0.5.1","versionCode":3,"from":"GITHUB"}')},524:function(e,t,n){var r={"./af":298,"./af.js":298,"./ar":299,"./ar-dz":300,"./ar-dz.js":300,"./ar-kw":301,"./ar-kw.js":301,"./ar-ly":302,"./ar-ly.js":302,"./ar-ma":303,"./ar-ma.js":303,"./ar-sa":304,"./ar-sa.js":304,"./ar-tn":305,"./ar-tn.js":305,"./ar.js":299,"./az":306,"./az.js":306,"./be":307,"./be.js":307,"./bg":308,"./bg.js":308,"./bm":309,"./bm.js":309,"./bn":310,"./bn-bd":311,"./bn-bd.js":311,"./bn.js":310,"./bo":312,"./bo.js":312,"./br":313,"./br.js":313,"./bs":314,"./bs.js":314,"./ca":315,"./ca.js":315,"./cs":316,"./cs.js":316,"./cv":317,"./cv.js":317,"./cy":318,"./cy.js":318,"./da":319,"./da.js":319,"./de":320,"./de-at":321,"./de-at.js":321,"./de-ch":322,"./de-ch.js":322,"./de.js":320,"./dv":323,"./dv.js":323,"./el":324,"./el.js":324,"./en-au":325,"./en-au.js":325,"./en-ca":326,"./en-ca.js":326,"./en-gb":327,"./en-gb.js":327,"./en-ie":328,"./en-ie.js":328,"./en-il":329,"./en-il.js":329,"./en-in":330,"./en-in.js":330,"./en-nz":331,"./en-nz.js":331,"./en-sg":332,"./en-sg.js":332,"./eo":333,"./eo.js":333,"./es":334,"./es-do":335,"./es-do.js":335,"./es-mx":336,"./es-mx.js":336,"./es-us":337,"./es-us.js":337,"./es.js":334,"./et":338,"./et.js":338,"./eu":339,"./eu.js":339,"./fa":340,"./fa.js":340,"./fi":341,"./fi.js":341,"./fil":342,"./fil.js":342,"./fo":343,"./fo.js":343,"./fr":344,"./fr-ca":345,"./fr-ca.js":345,"./fr-ch":346,"./fr-ch.js":346,"./fr.js":344,"./fy":347,"./fy.js":347,"./ga":348,"./ga.js":348,"./gd":349,"./gd.js":349,"./gl":350,"./gl.js":350,"./gom-deva":351,"./gom-deva.js":351,"./gom-latn":352,"./gom-latn.js":352,"./gu":353,"./gu.js":353,"./he":354,"./he.js":354,"./hi":355,"./hi.js":355,"./hr":356,"./hr.js":356,"./hu":357,"./hu.js":357,"./hy-am":358,"./hy-am.js":358,"./id":359,"./id.js":359,"./is":360,"./is.js":360,"./it":361,"./it-ch":362,"./it-ch.js":362,"./it.js":361,"./ja":363,"./ja.js":363,"./jv":364,"./jv.js":364,"./ka":365,"./ka.js":365,"./kk":366,"./kk.js":366,"./km":367,"./km.js":367,"./kn":368,"./kn.js":368,"./ko":369,"./ko.js":369,"./ku":370,"./ku.js":370,"./ky":371,"./ky.js":371,"./lb":372,"./lb.js":372,"./lo":373,"./lo.js":373,"./lt":374,"./lt.js":374,"./lv":375,"./lv.js":375,"./me":376,"./me.js":376,"./mi":377,"./mi.js":377,"./mk":378,"./mk.js":378,"./ml":379,"./ml.js":379,"./mn":380,"./mn.js":380,"./mr":381,"./mr.js":381,"./ms":382,"./ms-my":383,"./ms-my.js":383,"./ms.js":382,"./mt":384,"./mt.js":384,"./my":385,"./my.js":385,"./nb":386,"./nb.js":386,"./ne":387,"./ne.js":387,"./nl":388,"./nl-be":389,"./nl-be.js":389,"./nl.js":388,"./nn":390,"./nn.js":390,"./oc-lnc":391,"./oc-lnc.js":391,"./pa-in":392,"./pa-in.js":392,"./pl":393,"./pl.js":393,"./pt":394,"./pt-br":395,"./pt-br.js":395,"./pt.js":394,"./ro":396,"./ro.js":396,"./ru":397,"./ru.js":397,"./sd":398,"./sd.js":398,"./se":399,"./se.js":399,"./si":400,"./si.js":400,"./sk":401,"./sk.js":401,"./sl":402,"./sl.js":402,"./sq":403,"./sq.js":403,"./sr":404,"./sr-cyrl":405,"./sr-cyrl.js":405,"./sr.js":404,"./ss":406,"./ss.js":406,"./sv":407,"./sv.js":407,"./sw":408,"./sw.js":408,"./ta":409,"./ta.js":409,"./te":410,"./te.js":410,"./tet":411,"./tet.js":411,"./tg":412,"./tg.js":412,"./th":413,"./th.js":413,"./tk":414,"./tk.js":414,"./tl-ph":415,"./tl-ph.js":415,"./tlh":416,"./tlh.js":416,"./tr":417,"./tr.js":417,"./tzl":418,"./tzl.js":418,"./tzm":419,"./tzm-latn":420,"./tzm-latn.js":420,"./tzm.js":419,"./ug-cn":421,"./ug-cn.js":421,"./uk":422,"./uk.js":422,"./ur":423,"./ur.js":423,"./uz":424,"./uz-latn":425,"./uz-latn.js":425,"./uz.js":424,"./vi":426,"./vi.js":426,"./x-pseudo":427,"./x-pseudo.js":427,"./yo":428,"./yo.js":428,"./zh-cn":429,"./zh-cn.js":429,"./zh-hk":430,"./zh-hk.js":430,"./zh-mo":431,"./zh-mo.js":431,"./zh-tw":432,"./zh-tw.js":432};function a(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=c,e.exports=a,a.id=524},656:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(280),c=n(3),o=n(4),i=n(36),s=n(1);t.default=function(e){var t=e.children,n=Object(r.useContext)(i.a).dark,l=Object(r.useMemo)((function(){return n?c.b.gray200:void 0}),[n]),u=Object(r.useMemo)((function(){return{p:{marginVertical:4*o.a,color:l}}}),[l]);return Object(s.jsx)(a.TRenderEngineProvider,{tagsStyles:u,children:Object(s.jsx)(a.RenderHTMLConfigProvider,{children:t})})}},972:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Or}));var r,a,c,o,i=n(10),s=n.n(i),l=n(14),u=n.n(l),b=n(0),j=n(7),d=n(3),f=n(237),O=n(28),g=n(2),m=n(5),h=n.n(m),p=n(20),y=n(54),x=n(293),v=(r=h()((function*(){return 200===(yield fetch("https://api.github.com")).status})),function(){return r.apply(this,arguments)}),w=(a=h()((function*(){return yield(yield fetch("https://raw.githubusercontent.com/open-polito/open-polito/master/release.json")).json()})),function(){return a.apply(this,arguments)}),k=(c=h()((function*(e){return yield(yield fetch("https://api.github.com/repos/open-polito/open-polito/releases/tags/"+e,{headers:{Accept:"application/vnd.github+json"}})).json()})),o=h()((function*(){"android"!==p.a.OS||["PLAY_STORE"].includes(x.from)||h()((function*(){if(yield v())try{return(yield w()).find((function(e){return e.type===y.a.VARIANT&&e.versionCode>x.versionCode}))}catch(e){}}))()})),function(){return o.apply(this,arguments)}),C=function(){var e=h()((function*(){}));return function(){return e.apply(this,arguments)}}(),S=(function(){var e=h()((function*(){}))}(),function(){var e=h()((function*(){}))}(),n(74)),D=n(526),P=n(254),I=n(109),_=n(283),E=n(511),T=n(513),M=n(239),z=n(36),R=n(4),L=n(45),N=n(98),B=n(49),H=n(21),V=n(1),A=function(e){var t,n=e.title,r=e.actions,a=e.dismissable,c=void 0===a||a,o=e.onDismiss,i=void 0===o?function(){}:o,s=e.children,l=e.icon,f=e.accentColor,O=Object(b.useContext)(z.a),g=O.dark,m=O.size,h=Object(b.useContext)(S.a),p=h.visible,y=h.hideModal,x=Object(b.useState)(!0),v=u()(x,2),w=v[0],k=v[1],C=Object(b.useCallback)((function(){c&&(setTimeout((function(){return k(!1)}),200),y(),i())}),[y,c,i]),A=Object(_.a)(0),F=Object(E.a)(((t=function(){return{backgroundColor:"rgba(0, 0, 0, "+A.value/2+")",opacity:A.value,transform:[{scale:1.1-.1*A.value}]}})._closure={offset:A},t.asString='function _f(){const{offset}=jsThis._closure;{return{backgroundColor:"rgba(0, 0, 0, "+offset.value/2+")",opacity:offset.value,transform:[{scale:1.1-0.1*offset.value}]};}}',t.__workletHash=0xef79486089b,t.__location="/home/runner/work/open-polito/open-polito/src/components/modals/ModalBase.tsx (66:37)",t.__optimalization=3,t));return Object(b.useEffect)((function(){A.value=Object(T.a)(p?1:0,{duration:200})}),[p,A]),Object(V.jsx)(D.a,{transparent:!0,visible:w,animationType:"none",statusBarTranslucent:!0,onRequestClose:C,children:Object(V.jsx)(M.default.View,{style:[F,{flex:1}],children:Object(V.jsx)(I.a,{activeOpacity:1,onPress:C,style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(V.jsxs)(I.a,{activeOpacity:1,style:[{width:m>=L.a.lg?"50%":"90%",maxHeight:"80%",backgroundColor:g?d.b.gray700:d.b.gray200,borderRadius:4*R.a,marginHorizontal:16*R.a}],children:[Object(V.jsx)(P.a,{children:Object(V.jsxs)(j.a,{style:{paddingVertical:24*R.a,paddingHorizontal:16*R.a},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[l&&Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(B.a,{name:l,color:f,size:24*R.a}),Object(V.jsx)(j.a,{style:{width:16*R.a}})]}),Object(V.jsx)(H.a,{s:16,w:"m",c:g?d.b.gray100:d.b.gray800,children:n})]}),Object(V.jsx)(j.a,{style:{marginTop:16*R.a},children:s})]})}),r&&Object(V.jsx)(j.a,{style:{flexDirection:"row",paddingBottom:24*R.a,paddingHorizontal:16*R.a},children:r.map((function(e,t){return Object(V.jsx)(j.a,{style:[{flex:1},0!==t?{marginLeft:32*R.a}:{}],children:Object(V.jsx)(N.a,{color:"colored"===e.type?f:d.b.accent300,secondary:"secondary"===e.type,text:e.label,onPress:function(){e.onSelect(e.value).then((function(){e.dismiss&&C()}))}})},e.value)}))})]})})})})},F=function(e){var t=e.title,n=e.children,r=e.onConfirm,a=void 0===r?function(){}:r,c=e.onCancel,o=void 0===c?function(){}:c,i=e.icon,s=e.accentColor,l=e.customLabels,u=Object(b.useContext)(S.a).hideModal,j=Object(f.a)().t,d=Object(b.useMemo)((function(){return[{type:"secondary",label:l?l.cancel:j("cancel"),value:"cancel",onSelect:(t=h()((function*(){o(),u()})),function(){return t.apply(this,arguments)}),dismiss:!0},{type:"colored",label:l?l.confirm:j("confirm"),value:"confirm",onSelect:(e=h()((function*(){a(),u()})),function(){return e.apply(this,arguments)}),dismiss:!0}];var e,t}),[u,o,a,j,l]);return Object(V.jsx)(A,{icon:i,accentColor:s,title:t,actions:d,children:n})},G=n(66),U=n(280),Y=function(){return Object(V.jsx)("div",{children:"Updater for web not implemented yet"})},W=n(971),q=n(974),J=n(281),X=n(8),Q=n(43),K=n.n(Q),Z=n(287),$=n(255),ee=function(e){var t=e.items,n=e.onChange,r=Object(b.useState)(t&&t.length>0?t[0].value:""),a=u()(r,2),c=a[0],o=a[1];return Object(V.jsx)(j.a,{style:{flexDirection:"row"},children:t.map((function(e){return Object(V.jsx)(j.a,{children:Object(V.jsx)(I.a,{onPress:function(){n(e.value),o(e.value)},children:Object(V.jsx)(j.a,{style:{paddingHorizontal:8*R.a,paddingVertical:4*R.a,borderWidth:1*R.a,borderRadius:16*R.a,borderColor:e.value===c?d.b.accent300:d.b.gray200,marginRight:8*R.a},children:Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:e.value===c?d.b.accent300:d.b.gray200,children:e.label})})})})}))})};function te(){var e=Object(f.a)().t,t=Object(b.useContext)(z.a).dark;return Object(V.jsx)(j.a,{style:{flex:1,flexDirection:"row",justifyContent:"center"},children:Object(V.jsx)(H.a,{s:12,w:"m",c:t?d.b.gray200:d.b.gray700,children:e("noContent")})})}var ne=n(238),re=n.n(ne),ae=n(263),ce=n(73),oe=function(e){var t,n=e.item,r=e.onPress,a=e.dark,c=Object(b.useState)(0),o=u()(c,2),i=o[0],s=o[1],l=Object(b.useMemo)((function(){return n.length/60}),[n.length]),f=Object(b.useMemo)((function(){var e=Math.ceil(60*(l-Math.floor(l))).toString();return 1===e.length&&(e="0"+e),e}),[l]),O=Object(E.a)(((t=function(){return{opacity:Object(T.a)(0===i?0:1,{duration:200})}})._closure={withTiming:T.a,width:i},t.asString="function _f(){const{withTiming,width}=jsThis._closure;{return{opacity:withTiming(width===0?0:1,{duration:200})};}}",t.__workletHash=4868393672747,t.__location="/home/runner/work/open-polito/open-polito/src/ui/VideoCard.tsx (36:37)",t.__optimalization=2,t)),g=Math.floor(l)+":"+f+":00";return Object(V.jsx)(M.default.View,{style:[O],children:Object(V.jsxs)(ce.a,{onLayout:function(e){return s(e.nativeEvent.layout.width)},onPress:r,android_ripple:{color:d.b.lightGray},style:[{flexDirection:"row",justifyContent:"space-between",paddingVertical:12*R.a,paddingHorizontal:16*R.a}],children:[Object(V.jsxs)(j.a,{style:{width:.4*i,height:.23*i},children:[Object(V.jsx)(ae.a,{source:{uri:0!==n.cover_url.length?n.cover_url:void 0},style:{width:"100%",height:"100%",backgroundColor:"#000"},resizeMode:"contain"}),Object(V.jsx)(j.a,{style:{position:"absolute",right:0,bottom:0,padding:4*R.a,backgroundColor:"#000"},children:Object(V.jsx)(H.a,{s:10*R.a,w:"m",c:d.b.gray100,children:g})})]}),Object(V.jsx)(j.a,{style:{marginLeft:16*R.a,flex:1,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start"},children:Object(V.jsxs)(j.a,{children:[Object(V.jsx)(H.a,{w:"m",s:12*R.a,c:a?d.b.gray100:d.b.gray800,numberOfLines:2,children:n.title}),Object(V.jsx)(H.a,{w:"r",s:10*R.a,c:a?d.b.gray200:d.b.gray700,numberOfLines:1,style:{marginVertical:8*R.a},children:re()(n.date).format("ll")})]})})]},n.date+n.title)})},ie=function(e){var t,n=e.courseData,r=e.onYearChange;return Object(V.jsxs)(j.a,{style:{marginLeft:16*R.a},children:[Object(V.jsx)(j.a,{style:{height:16*R.a}}),Object(V.jsx)(ee,{items:Object.keys((null==n||null==(t=n.extendedInfo)?void 0:t.vc_recordings)||{}).sort((function(e,t){return e<t?1:-1})).map((function(e){return{label:e,value:e}})),onChange:function(e){return r(e)}}),Object(V.jsx)(j.a,{style:{height:8*R.a}})]})},se=function(e){var t=e.courseId,n=e.dark,r=e.refreshControl,a=(Object(f.a)().t,Object(Z.p)()),c=Object(b.useState)("current"),o=u()(c,2),i=o[0],s=o[1],l=Object(O.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name==t}))})),d=Object(b.useMemo)((function(){var e,t;return"current"===i?K()((null==l||null==(t=l.extendedInfo)?void 0:t.vc_recordings.current)||[]).sort((function(e,t){return t.date-e.date})):K()((null==l||null==(e=l.extendedInfo)?void 0:e.vc_recordings[parseInt(i,10)])||[]).sort((function(e,t){return t.date-e.date}))}),[l,i]);return Object(V.jsx)(j.a,{style:{flex:1},children:Object(V.jsx)($.a,{data:d,ListEmptyComponent:Object(V.jsx)(te,{}),refreshControl:r,ListHeaderComponent:Object(V.jsx)(ie,{courseData:l,onYearChange:function(e){return s(e)}}),renderItem:function(e){var r=e.item;return Object(V.jsx)(oe,{item:r,dark:n,onPress:function(){a.navigate("Video",{video:r,courseId:t})}})}})})},le=n(76),ue=n(138),be=n(961),je=X.a.create({blackText:{color:d.b.black},whiteText:{color:d.b.white},grayText:{color:d.b.gray},textRegular:{fontFamily:"Inter-Regular"},textMedium:{fontFamily:"Inter-Medium"},textBold:{fontFamily:"Inter-Bold"},textExtraSmall:{fontSize:10},textSmall:{fontSize:12},textNormal:{fontSize:16},textMediumSize:{fontSize:20},textLarge:{fontSize:24},textExtraLarge:{fontSize:32},textTitleLarge:{fontSize:42},withHorizontalPadding:{paddingHorizontal:24},withRoundedBorder:{borderRadius:4},safePaddingTop:{paddingTop:40},container:{flex:1,flexDirection:"column",alignContent:"space-between"},paddingFromHeader:{paddingTop:32},titleBar:{width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},tabNavigator:{backgroundColor:d.b.white,height:60,tabBarActiveTintColor:d.b.white,paddingBottom:8},elevated:{shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.23,shadowRadius:2.62,elevation:4},elevatedSmooth:{shadowColor:"#bbb",shadowOffset:{width:0,height:12},shadowOpacity:.58,shadowRadius:16,elevation:24},border:{borderRadius:8,borderColor:d.b.lightGray,borderWidth:.5}}),de=n(251);function fe(e){var t=e.width,n=Object(b.useRef)(new de.a.Value(0)).current;return Object(b.useEffect)((function(){de.a.loop(de.a.timing(n,{toValue:1.5,duration:2e3,useNativeDriver:!0})).start()}),[]),Object(V.jsxs)(j.a,{style:{width:t,height:t,borderRadius:t/2},children:[Object(V.jsx)(de.a.View,{style:[{backgroundColor:d.b.white,width:t,height:t,borderRadius:t/2,opacity:de.a.subtract(1.5,n)},{transform:[{scale:n}]}]}),Object(V.jsx)(j.a,{style:{position:"absolute",left:t/4,top:t/4,width:t/2,height:t/2,borderRadius:t/4,backgroundColor:d.b.white}})]})}var Oe=n(75);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(e){var t=e.name,n=void 0===t?"":t,r=e.action,a=void 0===r?function(){}:r,c=e.compact,o=void 0!==c&&c,i=e.withButton,s=void 0===i||i,l=e.withPadding,u=void 0===l||l,b=e.fullHeight,O=void 0!==b&&b,g=e.children,m=e.dark,h=e.style,p=Object(f.a)().t;return Object(V.jsx)(j.a,{style:me(me(me({},je.elevatedSmooth),je.border),{},{backgroundColor:d.b.white,width:o?"48%":"100%",flex:0},h),children:Object(V.jsx)(Oe.a,{style:{paddingHorizontal:u?12:0,paddingVertical:u?8:0,flex:O?1:0},android_ripple:{color:d.b.lightGray},onPress:function(){a()},children:Object(V.jsxs)(j.a,{style:{flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",flex:1},children:[n?Object(V.jsx)(H.a,{w:"m",s:12*R.a,c:m?d.b.gray100:d.b.gray800,children:n}):null,g,s&&Object(V.jsx)(j.a,{style:{backgroundColor:d.b.lightGray,padding:8,borderRadius:8,marginVertical:4,width:"100%",flexDirection:"row",justifyContent:"center"},children:Object(V.jsx)(H.a,{w:"m",s:10*R.a,c:m?d.b.gray100:d.b.gray800,children:p("open")})})]})})})},pe=n(78);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e.liveClass,n=e.courseName,r=e.device,a=Object(b.useState)(!0),c=u()(a,2),o=c[0],i=c[1],s=Object(b.useState)(0),l=u()(s,2),f=(l[0],l[1]),O=Object(b.useRef)(),g=function(){return re.a.utc(re()(Date.now()).diff(re()(t.date))).format("HH:mm:ss")};return Object(b.useEffect)((function(){return h()((function*(){O.current=setInterval((function(){o&&f(g())}),1e3)}))(),function(){clearInterval(O.current),i(!1)}}),[]),Object(V.jsx)(he,{withButton:!1,withPadding:!1,action:function(){h()((function*(){yield Object(pe.a)((yield Object(ue.getLessonURL)(r,t)).url||"")}))()},children:Object(V.jsxs)(be.a,{start:{x:.2,y:.1},end:{x:.7,y:.9},colors:["#EA0000","#C30000"],style:xe(xe(xe({paddingVertical:16,paddingHorizontal:24},je.elevatedSmooth),je.border),{},{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),children:[Object(V.jsxs)(j.a,{style:{flex:1,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:-je.withHorizontalPadding.paddingHorizontal/2},children:[Object(V.jsx)(j.a,{style:{marginRight:8},children:Object(V.jsx)(fe,{width:40})}),Object(V.jsxs)(j.a,{style:{flex:3,flexDirection:"column",justifyContent:"flex-start"},children:[Object(V.jsx)(H.a,{s:12*R.a,w:"b",c:d.b.white,children:"LIVE"}),Object(V.jsx)(H.a,{s:12*R.a,w:"b",c:d.b.white,children:g()})]})]}),Object(V.jsxs)(j.a,{style:{flex:1,flexDirection:"column",justifyContent:"center",alignItems:"flex-end"},children:[Object(V.jsx)(H.a,{s:10*R.a,w:"b",c:d.b.white,children:t.title}),Object(V.jsx)(H.a,{s:10*R.a,w:"b",c:d.b.white,children:n})]})]})})};function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=function(e){var t=e.title,n=e.dark,r=e.style,a=void 0===r?{}:r,c=e.children;return Object(V.jsxs)(j.a,{style:ke({},a),children:[Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:n?d.b.gray100:d.b.gray800,children:t}),Object(V.jsx)(j.a,{style:{marginTop:16*R.a},children:c})]})},Se=n(171),De=[{icon:"file-text",color:d.b.gray200,colorLight:d.b.gray700,extensions:["csv","log","md","txt"]},{icon:"archive",color:d.b.gray200,colorLight:d.b.gray700,extensions:["7z","bz","gz","rar","tar","zip","xz"]},{icon:"file-code",color:d.b.black,extensions:["asm","c","cpp","cs","css","go","h","hpp","htm","html","java","js","json","jsx","ts","tsx","php","py","rs","xml"]},{icon:"photo",color:d.b.gradient1,extensions:["bmp","gif","jpg","jpeg","png","svg","tiff"]},{icon:"movie",color:d.b.gradient1,extensions:["flv","mkv","mp4","mov","wmv","avi","webm"]},{icon:"headphones",color:d.b.red,extensions:["aac","alac","flac","m4a","mp3","ogg","wav","wma"]},{icon:"file-text",color:d.b.gradient1,extensions:["doc","docm","docx","odt"]},{icon:"file-text",color:"#ff3848",extensions:["pdf"]},{icon:"presentation",color:d.b.orange,extensions:["odp","ppt","pptm","pptx"]},{icon:"table",color:d.b.green,extensions:["ods","xls","xlsm","xlsx"]}];var Pe=["B","kB","MB","GB","TB"],Ie=function(e,t){Object(Se.getDownloadURL)(e,t).then((function(e){return Object(pe.a)(e)}))},_e=function(e){var t=e.item,n=e.relativeDate,r=void 0!==n&&n,a=e.dark,c=e.course,o=void 0===c?"":c,i=e.onPress,s=void 0===i?function(){}:i,l=e.children,u=Object(b.useMemo)((function(){return"file"===t.type?(e=1e3*t.size,n=Math.floor(e),r=Math.min(n>0?Math.floor(Math.floor(Math.log10(n))/3):0,Pe.length-1),(n/Math.pow(10,0===r?1:3*r)).toFixed(2)+" "+Pe[r]):"";var e,n,r}),[t]),f=Object(b.useContext)(z.a).device,O=Object(b.useMemo)((function(){return"file"===t.type?function(e,t){for(var n=e.split(".").pop().toLowerCase(),r=0;r<De.length;r++){var a=De[r],c=a.icon;if(a.extensions.includes(n)){var o=t?De[r].color:De[r].colorLight||De[r].color;return Object(V.jsx)(B.a,{name:c,color:o,size:24*R.a})}}return Object(V.jsx)(B.a,{name:"file-unknown",color:d.b.gray500,size:24*R.a})}(t.filename,a):Object(V.jsx)(B.a,{name:"folder",color:a?d.b.gray200:d.b.gray700,size:24*R.a})}),[t,a]);return Object(V.jsxs)(j.a,{style:{flexDirection:"column"},children:[Object(V.jsxs)(ce.a,{android_ripple:{color:d.b.lightGray},onPress:function(){"file"===t.type||s()},style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center",flex:1},children:[O,Object(V.jsxs)(j.a,{style:{flexDirection:"column",justifyContent:"flex-start",marginLeft:10*R.a,flex:1},children:[Object(V.jsx)(j.a,{style:{marginRight:10*R.a},children:Object(V.jsx)(H.a,{c:a?d.b.gray100:d.b.gray800,w:"m",s:12*R.a,numberOfLines:1,children:t.name})}),"file"===t.type&&Object(V.jsx)(j.a,{style:{flexDirection:"column",flex:1},children:Object(V.jsxs)(H.a,{numberOfLines:1,w:"r",s:10*R.a,c:d.b.gray300,children:[u+" · ",r?re()(t.creation_date).fromNow():re()(t.creation_date).format("ll"),o?" · "+o:""]})})]})]}),"file"===t.type?Object(V.jsx)(Oe.a,{android_ripple:{color:d.b.lightGray},onPress:function(){return Ie(f,t)},children:Object(V.jsx)(B.a,{name:"download",size:24*R.a,color:d.b.accent300})}):null]}),"dir"===t.type?Object(V.jsxs)(j.a,{style:{flexDirection:"row"},children:[Object(V.jsx)(j.a,{style:{width:16*R.a,alignItems:"flex-start"},children:Object(V.jsx)(j.a,{style:{flex:1,marginLeft:4*R.a,width:2*R.a,backgroundColor:a?d.b.gray600:d.b.gray300}})}),Object(V.jsx)(j.a,{style:{flex:1},children:l})]}):null]})},Ee=n(111),Te=n(934),Me=/<\/?\w+[^>]*>/g,ze=function(e){return void 0===e.topic},Re=function(e){var t,n=e.type,r=e.notification,a=e.dark,c=e.read,o=void 0===c||c,i=e.courseName,s=void 0===i?"":i,l=Object(b.useMemo)((function(){switch(n){case Ee.NotificationType.TEST:return"test-pipe";case Ee.NotificationType.DIRECT:return"message-dots";case Ee.NotificationType.NOTICE:return"bell";case Ee.NotificationType.MATERIAL:return"files";default:return"bell"}}),[n]),u=Object(b.useMemo)((function(){return ze(r)?(e=r.text,Object(Te.decode)(e).replace(Me,"")):r.title;var e}),[r]),f=Object(b.useMemo)((function(){return ze(r)?r.text:r.body}),[r]),O=Object(b.useMemo)((function(){return re()(ze(r)?r.date:r.time).format("ll")}),[r]),g=Object(_.a)(o?0:1),m=Object(E.a)(((t=function(){return{width:8*R.a*g.value,height:8*R.a*g.value,backgroundColor:d.b.red,borderRadius:8*R.a}})._closure={p:R.a,offset:g,colors:{red:d.b.red}},t.asString="function _f(){const{p,offset,colors}=jsThis._closure;{return{width:8*p*offset.value,height:8*p*offset.value,backgroundColor:colors.red,borderRadius:8*p};}}",t.__workletHash=9456528118976,t.__location="/home/runner/work/open-polito/open-polito/src/ui/Notification.tsx (74:37)",t.__optimalization=3,t));return Object(b.useEffect)((function(){o&&(g.value=Object(T.a)(0,{duration:200}))}),[o]),Object(V.jsxs)(j.a,{style:{flexDirection:"column"},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(V.jsxs)(j.a,{style:{width:32*R.a,height:32*R.a,borderRadius:4*R.a,backgroundColor:a?d.b.gray700:d.b.gray200,alignItems:"center",justifyContent:"center",marginRight:16*R.a},children:[Object(V.jsx)(j.a,{style:{position:"absolute",justifyContent:"center",alignItems:"center",top:-4*R.a,right:-4*R.a,width:8*R.a,height:8*R.a},children:Object(V.jsx)(M.default.View,{style:[m]})}),Object(V.jsx)(B.a,{name:l,color:d.b.accent300,size:16*R.a})]}),Object(V.jsxs)(j.a,{style:{flexDirection:"column",flex:1},children:[Object(V.jsx)(H.a,{s:12*R.a,c:a?d.b.gray100:d.b.gray800,w:"r",numberOfLines:ze(r)?1:2,children:u}),Object(V.jsxs)(H.a,{s:10*R.a,c:a?d.b.gray200:d.b.gray700,w:"r",numberOfLines:2,children:[O,ze(r)?r.course_name&&" · "+r.course_name:s&&" · "+s]})]})]}),!!f&&Object(V.jsx)(j.a,{style:{marginTop:12*R.a,padding:16*R.a,borderRadius:4*R.a,backgroundColor:a?d.b.gray700:d.b.gray200},children:Object(V.jsx)(U.RenderHTMLSource,{source:{html:f}})})]})};function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=function(e){var t,n,r,a,c,o=e.code,i=(e.changeTab,Object(f.a)().t),s=Object(b.useContext)(z.a),l=s.device,u=s.dark,m=Object(O.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name==o}))})),h=(null==m||null==(t=m.extendedInfo)?void 0:t.material)||[],p=function(e,t,n){return Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center",marginBottom:(n+1)%3==0?0:8*R.a},children:[Object(V.jsx)(B.a,{name:t,size:16*R.a,color:u?d.b.gray200:d.b.gray700}),Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:u?d.b.gray200:d.b.gray700,style:{marginLeft:8*R.a},children:e})]},t)},y=Object(b.useMemo)((function(){var e,t,n,r;return[{name:(null==m||null==(e=m.extendedInfo)?void 0:e.professor.surname)+" "+(null==m||null==(t=m.extendedInfo)?void 0:t.professor.name),icon:"user-circle"},{name:(null==m?void 0:m.basicInfo.num_credits)+" "+i("credits"),icon:"north-star"},{name:null==m?void 0:m.basicInfo.code,icon:"grid-pattern"},{name:i("year")+" "+((null==m||null==(n=m.extendedInfo)?void 0:n.degree_year)||"")+", "+i("period")+" "+(null==m||null==(r=m.extendedInfo)?void 0:r.year_period)||"",icon:"calendar-time"}]}),[m]);return Object(V.jsxs)(j.a,{children:[Object(V.jsx)(Ce,{dark:u,title:i("summary"),children:(null==m?void 0:m.status.code)==g.b.PENDING?Object(V.jsx)(le.a,{}):Object(V.jsxs)(j.a,{style:{flexDirection:"row"},children:[Object(V.jsx)(j.a,{style:{flex:1},children:y.slice(0,2).map((function(e,t){return p(e.name||"",e.icon,t)}))}),Object(V.jsx)(j.a,{style:{flex:1},children:y.slice(2).map((function(e,t){return p(e.name||"",e.icon,t)}))})]})}),(null==m||null==(n=m.extendedInfo)?void 0:n.live_lessons.map((function(e){return Object(V.jsx)(ve,{liveClass:e,courseName:m.basicInfo.name,device:l},e.meeting_id)})))||null,Object(V.jsx)(Ce,{dark:u,title:i("latestFiles"),style:{marginTop:24},children:Object(V.jsx)(j.a,{style:{marginTop:-8},children:(null==m?void 0:m.status.code)==g.b.PENDING?Object(V.jsx)(le.a,{}):(c=h||[],function e(t){return t.flatMap((function(t){return"file"==t.type?[t]:[t].concat(e(t.children))})).filter((function(e){return"file"==e.type}))}(c||[]).sort((function(e,t){return t.creation_date-e.creation_date})).slice(0,3)).map((function(e){return Object(V.jsx)(_e,{item:e,dark:u})}))})}),Object(V.jsx)(Ce,{dark:u,title:i("latestAlert"),style:{marginTop:16},children:(null==m?void 0:m.status.code)==g.b.PENDING?Object(V.jsx)(le.a,{}):((null==m||null==(r=m.extendedInfo)?void 0:r.notices)||[]).length>0?Object(V.jsx)(Re,{notification:Ne(Ne({},null==m||null==(a=m.extendedInfo)?void 0:a.notices[0]),{},{course_code:(null==m?void 0:m.basicInfo.code)||"",course_name:(null==m?void 0:m.basicInfo.name)||""}),type:Ee.NotificationType.NOTICE,dark:u}):null})]})};function He(e){var t=e.dark,n=e.item,r=Object(b.useState)(!1),a=u()(r,2),c=a[0],o=a[1];return Object(V.jsx)(j.a,{children:"file"==n.type?Object(V.jsx)(_e,{dark:t,item:n}):Object(V.jsx)(j.a,{children:Object(V.jsx)(_e,{dark:t,item:n,onPress:function(){o(!c)},children:c?n.children.map((function(e){return Object(V.jsx)(He,{dark:t,item:e},e.code)})):[]})})})}function Ve(e){var t,n,r=e.courseId,a=e.dark,c=Object(O.c)((function(e){return e.courses})).courses;return Object(V.jsx)(j.a,{children:"all"==r?c.map((function(e){var t;return Object(V.jsx)(He,{item:{type:"dir",code:e.basicInfo.code+e.basicInfo.name,name:e.basicInfo.name,children:(null==(t=e.extendedInfo)?void 0:t.material)||[]},dark:a},e.basicInfo.code+e.basicInfo.name)})):((null==(t=c.find((function(e){return e.basicInfo.code+e.basicInfo.name==r})))||null==(n=t.extendedInfo)?void 0:n.material)||[]).map((function(e){return Object(V.jsx)(He,{item:e,dark:a},e.code)}))})}var Ae=function(e){var t=e.alerts,n=e.dark,r=e.refreshControl,a=Object(b.useMemo)((function(){return X.a.create({container:{paddingHorizontal:16*R.a,flex:1}})}),[n]);return Object(V.jsx)(j.a,{style:{flexDirection:"column",flex:1},children:Object(V.jsx)($.a,{style:a.container,ListEmptyComponent:Object(V.jsx)(te,{}),ListHeaderComponent:function(){return Object(V.jsx)(j.a,{style:{height:24*R.a}})},refreshControl:r,data:t,initialNumToRender:1,keyExtractor:function(e){return e.id+e.date+e.text.slice(0,10)},renderItem:function(e){return Object(V.jsx)(j.a,{style:{marginBottom:24*R.a},children:Object(V.jsx)(Re,{type:Ee.NotificationType.NOTICE,notification:e.item,dark:n})})}})})},Fe=n(119),Ge=n(108);function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We,qe=X.a.create({badge:{position:"absolute",width:20*R.a,height:20*R.a,borderRadius:20*R.a,backgroundColor:d.b.red,right:-10*R.a,top:-10*R.a,justifyContent:"center",alignItems:"center"}}),Je=function(e){var t=e.children,n=e.style,r=void 0===n?{}:n,a=e.number,c=Object(b.useMemo)((function(){return"string"==typeof a?a:a>99?"99+":a}),[a]);return Object(V.jsxs)(j.a,{style:Ye({},r),children:[t,0!==c?Object(V.jsx)(j.a,{style:qe.badge,children:Object(V.jsx)(H.a,{w:"r",s:10*R.a,c:d.b.gray100,children:c})}):null]})},Xe=n(31),Qe=n(29);function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.MAIN=0]="MAIN",e[e.SECONDARY=1]="SECONDARY"}(We||(We={}));var $e=function(e){var t=e.title,n=e.headerType,r=Object(b.useContext)(z.a).dark,a=Object(O.c)((function(e){return e.user.notifications})),c=Object(O.c)((function(e){return e.session.config})),o=Object(O.b)(),i=Object(b.useMemo)((function(){return a.filter((function(e){return!e.is_read})).length}),[a]),s=Object(Z.p)(),l=Object(b.useMemo)((function(){return r?"moon-stars":"sun"}),[r]),u=Object(b.useCallback)((function(){o(Object(Qe.e)(Ze(Ze({},c),{},{theme:r?"light":"dark"})))}),[r,c,o]),f=Object(b.useMemo)((function(){return X.a.create({header:{flexDirection:"row",marginHorizontal:12*R.a,marginVertical:16*R.a,alignItems:"center"},headerSection:{flex:1,flexDirection:"row",alignItems:"center"},headerMiddle:{flex:2,flexDirection:"row",justifyContent:"center"},headerEnd:{justifyContent:"flex-end"}})}),[]);return Object(V.jsx)(j.a,{style:f.header,children:n===We.MAIN?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(j.a,{style:f.headerSection,children:Object(V.jsx)(ce.a,{onPress:function(){s.dispatch(Z.c.toggleDrawer())},children:Object(V.jsx)(Je,{number:0,style:{marginRight:16*R.a},children:Object(V.jsx)(B.a,{name:"menu-2",size:24*R.a,color:r?d.b.gray100:d.b.gray800})})})}),Object(V.jsx)(j.a,{style:Ze(Ze({},f.headerSection),f.headerMiddle),children:Object(V.jsx)(H.a,{c:r?d.b.gray100:d.b.gray800,w:"m",s:16*R.a,numberOfLines:1,children:t})}),Object(V.jsxs)(j.a,{style:Ze(Ze({},f.headerSection),f.headerEnd),children:["mobile"!==Xe.a&&Object(V.jsx)(ce.a,{onPress:u,children:Object(V.jsx)(B.a,{name:l,size:24*R.a,color:r?d.b.gray100:d.b.gray800,style:{marginRight:16*R.a}})}),Object(V.jsx)(ce.a,{onPress:function(){return s.navigate("Search")},children:Object(V.jsx)(B.a,{name:"search",size:24*R.a,color:r?d.b.gray100:d.b.gray800,style:{marginRight:16*R.a}})}),Object(V.jsx)(ce.a,{onPress:function(){return s.navigate("Notifications")},children:Object(V.jsx)(Je,{number:i,children:Object(V.jsx)(B.a,{name:"bell",size:24*R.a,color:r?d.b.gray100:d.b.gray800})})})]})]}):n===We.SECONDARY?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ce.a,{onPress:s.goBack,children:Object(V.jsx)(B.a,{name:"arrow-left",size:24*R.a,color:r?d.b.gray200:d.b.gray700})}),Object(V.jsx)(H.a,{s:16*R.a,w:"m",c:r?d.b.gray100:d.b.gray800,style:{marginLeft:16*R.a},children:t})]}):null})};function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nt=function(e){var t=e.adjusted,n=void 0!==t&&t,r=e.items,a=e.onChange,c=e.defaultIndex,o=void 0===c?0:c,i=e.dark,s=e.style,l=void 0===s?{}:s,f=Object(b.useState)(o),O=u()(f,2),g=O[0],m=O[1],h=Object(b.useMemo)((function(){return X.a.create({container:{},adjusted:{marginTop:24*R.a,paddingHorizontal:16*R.a},tab:{},selectedIndicator:{marginTop:4*R.a,height:2*R.a,backgroundColor:d.b.accent300}})}),[i,n]);return Object(V.jsx)(j.a,{children:Object(V.jsx)(P.a,{contentContainerStyle:tt(tt(tt({},h.container),l),n?h.adjusted:{}),horizontal:!0,showsHorizontalScrollIndicator:!1,children:r.map((function(e,t){return Object(V.jsx)(j.a,{style:h.tab,children:Object(V.jsxs)(ce.a,{style:{marginRight:24*R.a},onPress:function(){return m(e=t),void a(e);var e},children:[Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:t==g?d.b.accent300:i?d.b.gray100:d.b.gray800,children:e.label}),t==g?Object(V.jsx)(j.a,{style:h.selectedIndicator}):null]})},e.value)}))})})};function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e){e.navigation;var t,n=e.route,r=Object(O.b)(),a=Object(f.a)().t,c=Object(b.useContext)(z.a),o=c.device,i=c.dark,s=n.params.courseCode,l=Object(O.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name==s}))})),d=Object(b.useState)(0),m=u()(d,2),h=m[0],p=m[1],y=Object(b.useMemo)((function(){return["overview","material","alerts","videos"]}),[]);Object(b.useEffect)((function(){l&&(null==l?void 0:l.status.code)!==g.b.PENDING&&(null==l?void 0:l.status.code)!==g.b.SUCCESS&&r(Object(Fe.c)({basicCourseInfo:l.basicInfo,device:o}))}),[l,o,r]);var x=Object(b.useCallback)((function(){r(Object(Fe.c)({basicCourseInfo:l.basicInfo,device:o}))}),[l,o,r]),v=Object(b.useMemo)((function(){return(null==l?void 0:l.status.code)===g.b.PENDING}),[l]),w=Object(b.useMemo)((function(){return X.a.create({container:{paddingHorizontal:16*R.a,paddingBottom:16*R.a}})}),[]),k=Object(b.useMemo)((function(){var e;switch(y[h]){case"overview":return Object(V.jsxs)(P.a,{refreshControl:Object(V.jsx)(J.a,{refreshing:v,onRefresh:x}),style:w.container,children:[Object(V.jsx)(j.a,{style:{height:24*R.a}}),Object(V.jsx)(Be,{code:s,changeTab:p}),Object(V.jsx)(j.a,{style:{height:16*R.a}})]});case"material":return Object(V.jsxs)(P.a,{refreshControl:Object(V.jsx)(J.a,{refreshing:v,onRefresh:x}),style:w.container,children:[Object(V.jsx)(j.a,{style:{height:24*R.a}}),Object(V.jsx)(Ve,{dark:i,courseId:s}),Object(V.jsx)(j.a,{style:{marginBottom:16*R.a}})]});case"alerts":return Object(V.jsx)(Ae,{refreshControl:Object(V.jsx)(J.a,{refreshing:v,onRefresh:x}),dark:i,alerts:(null==l||null==(e=l.extendedInfo)?void 0:e.notices.map((function(e){return at(at({},e),{},{course_code:l.basicInfo.code,course_name:l.basicInfo.name})})))||[]});case"videos":return Object(V.jsx)(se,{refreshControl:Object(V.jsx)(J.a,{refreshing:v,onRefresh:x}),dark:i,courseId:s})}}),[w.container,s,null==l?void 0:l.basicInfo.code,null==l?void 0:l.basicInfo.name,null==l||null==(t=l.extendedInfo)?void 0:t.notices,h,i,x,v,y]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:(null==l?void 0:l.basicInfo.name)||"",headerType:We.SECONDARY}),Object(V.jsx)(nt,{adjusted:!0,dark:i,onChange:function(e){p(e)},items:y.map((function(e){return{label:a(e),value:e}}))}),Object(V.jsx)(j.a,{style:{flex:1},children:k})]})}var ot=n(94),it=function(e){var t=e.title,n=e.items,r=e.onSelect,a=Object(b.useContext)(z.a).dark,c=Object(b.useContext)(S.a).hideModal,o=Object(b.useCallback)((function(e){r(e),c()}),[r,c]);return Object(V.jsx)(A,{title:t,dismissable:!0,children:n.map((function(e){return Object(V.jsx)(I.a,{onPress:function(){return o(e.value)},children:Object(V.jsx)(j.a,{style:{paddingVertical:8*R.a},children:Object(V.jsx)(H.a,{s:12*R.a,w:"r",c:a?d.b.gray100:d.b.gray800,children:e.label})})},e.value)}))})};function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e){var t=e.navigation,n=Object(f.a)().t,r=(Object(O.b)(),Object(b.useContext)(z.a).dark),a=Object(b.useContext)(S.a).setModal,c=Object(O.c)((function(e){return e.courses.courses})),o=Object(b.useState)(""),i=u()(o,2),s=i[0],l=i[1],g=Object(b.useState)([]),m=u()(g,2),p=m[0],y=m[1],x=Object(b.useState)(""),v=u()(x,2),w=v[0],k=v[1],C=Object(b.useState)(!0),D=u()(C,2),P=D[0],I=D[1],_=Object(b.useState)(null),E=u()(_,2),T=E[0],M=E[1],L=Object(b.useState)(null),N=u()(L,2),A=N[0],F=N[1],G=Object(b.useMemo)((function(){return[{label:n("allCourses"),value:""}].concat(K()(c.map((function(e){return{label:e.basicInfo.name,value:e.basicInfo.code+e.basicInfo.name}}))))}),[c]);Object(b.useEffect)((function(){U(s)}),[w,s]);var U=function(e){var t=e.toLowerCase().trim();T&&clearTimeout(T),A&&clearTimeout(A),I(!0),M(setTimeout((function(){W(t),F(setTimeout((function(){I(!1)}),500))}),50))},Y=function e(t,n,r,a){var c=[];return n.forEach((function(n){"file"==n.type?(n.name+n.filename).toLowerCase().includes(t)&&c.push(lt(lt({},n),{},{course_code:a,course_name:r})):"dir"==n.type&&c.push.apply(c,K()(e(t,n.children,r,a)))})),c},W=function(e){h()((function*(){setTimeout((function(){var t=[];if(""!==e){if(w){var n,r,a=c.find((function(e){return w===""+e.basicInfo.code+e.basicInfo.name}));if(!a)return void(t=[]);(n=t).push.apply(n,K()(Y(e,(null==(r=a.extendedInfo)?void 0:r.material)||[],a.basicInfo.name,a.basicInfo.code)))}else c.forEach((function(n){var r,a;(r=t).push.apply(r,K()(Y(e,(null==(a=n.extendedInfo)?void 0:a.material)||[],n.basicInfo.name,n.basicInfo.code)))}));y(t)}else y([])}),0)}))()};return Object(V.jsxs)(Ge.a,{children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center",paddingHorizontal:12*R.a,paddingVertical:16*R.a},children:[Object(V.jsx)(ce.a,{onPress:t.goBack,style:{marginRight:16*R.a},children:Object(V.jsx)(B.a,{name:"arrow-left",color:r?d.b.gray200:d.b.gray700,size:24*R.a})}),Object(V.jsx)(ot.a,{initiallyFocused:!0,icon:"search",dark:r,placeholder:n("searchForAnything"),autoFocus:!0,onChangeText:function(e){var t=e.toLowerCase().trim();l(t),U(t)},style:{flex:1}}),Object(V.jsx)(ce.a,{onPress:function(){a(Object(V.jsx)(it,{items:G,title:n("selectCourseDropdown"),onSelect:function(e){return k(e)}}))},style:{marginLeft:16*R.a},children:Object(V.jsx)(Je,{number:""===w?0:"",children:Object(V.jsx)(B.a,{name:"adjustments",color:r?d.b.gray200:d.b.gray700,size:24*R.a})})})]}),Object(V.jsx)(nt,{dark:r,items:[{label:n("files"),value:"files"}],onChange:function(){},adjusted:!0}),Object(V.jsx)($.a,{style:{paddingTop:24*R.a,paddingHorizontal:16*R.a},contentContainerStyle:{flexGrow:1},data:P?p.slice(0,10):p,keyExtractor:function(e){return e.code},initialNumToRender:10,maxToRenderPerBatch:10,renderItem:function(e){var t=e.item;return Object(V.jsx)(j.a,{children:Object(V.jsx)(_e,{item:t,dark:r,course:t.course_name},t.code)},t.code)},ListEmptyComponent:Object(V.jsxs)(j.a,{style:{flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(V.jsx)(B.a,{name:"search-off",size:64*R.a,color:r?d.b.gray300:d.b.gray600}),Object(V.jsxs)(j.a,{style:{marginTop:8*R.a,flexDirection:"column",alignItems:"center"},children:[Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:r?d.b.gray200:d.b.gray700,style:{marginBottom:8*R.a},children:n("noResults")}),Object(V.jsx)(H.a,{s:10*R.a,w:"m",c:r?d.b.gray300:d.b.gray600,children:n("tryADifferentTerm")})]})]}),ListFooterComponent:Object(V.jsx)(j.a,{style:{marginBottom:24*R.a}})})]})}var bt=n(117),jt=function(e){var t=e.video;return Object(V.jsx)("video",{src:t.url,controls:!0,autoPlay:!0})},dt=function(e){var t=e.courseData,n=e.video,r=e.dark;return Object(V.jsxs)(j.a,{children:[Object(V.jsx)(H.a,{s:16*R.a,w:"b",c:r?d.b.gray100:d.b.gray800,children:n.title}),Object(V.jsxs)(H.a,{s:12*R.a,w:"m",c:r?d.b.gray200:d.b.gray500,style:{marginTop:8*R.a},children:[null==t?void 0:t.basicInfo.name," · ",re()(n.date).format("ll")]}),Object(V.jsx)(j.a,{style:{marginVertical:24*R.a}})]})},ft=function(e){var t=e.currentVideo,n=e.windowWidth,r=e.windowHeight;return Object(V.jsx)(j.a,{style:[{width:"100%"},"mobile"!==Xe.a&&{flex:1},!!n&&{height:n/1.78},!!r&&{maxHeight:r/2}],children:Object(V.jsx)(jt,{video:t})})},Ot=function(e){var t=e.currentVideo,n=e.relatedVideos,r=e.dark,a=e.setCurrentVideo,c=e.courseData,o=Object(f.a)().t;return Object(V.jsx)($.a,{data:n,renderItem:function(e){var n=e.item;return Object(V.jsx)(j.a,{style:[n.url===t.url?{backgroundColor:r?d.b.gray600:d.b.gray300}:{}],children:Object(V.jsx)(oe,{item:n,dark:r,onPress:function(){return a(n)}})})},keyExtractor:function(e){return e.url},ListHeaderComponent:function(){return Object(V.jsxs)(j.a,{style:{paddingHorizontal:16*R.a,paddingBottom:16*R.a},children:[!!c&&Object(V.jsx)(j.a,{style:{marginTop:16*R.a},children:Object(V.jsx)(dt,{video:t,courseData:c,dark:r})}),Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:r?d.b.gray100:d.b.gray800,children:o("relatedVideos")})]})}})};function gt(e){var t=e.route.params,n=t.video,r=t.courseId,a=Object(b.useState)(n),c=u()(a,2),o=c[0],i=c[1],s=Object(O.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name===r}))})),l=Object(b.useMemo)((function(){var e;return K()((null==s||null==(e=s.extendedInfo)?void 0:e.vc_recordings.current)||[]).sort((function(e,t){return t.date-e.date}))}),[s]),d=Object(b.useContext)(z.a),f=d.dark,g=d.size,m=Object(bt.a)(),h=m.width,p=m.height,y=Object(b.useMemo)((function(){return Object(V.jsx)(ft,{currentVideo:o,windowWidth:"mobile"===Xe.a?h:void 0,windowHeight:g>=L.a.lg&&"mobile"===Xe.a?p:void 0})}),[o,p,g,h]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:n.title,headerType:We.SECONDARY}),Object(V.jsx)(j.a,{style:{flex:1,overflow:"scroll"},children:Object(V.jsxs)(j.a,{style:g>=L.a.lg?{flexDirection:"row",alignItems:"flex-start",flex:1,paddingHorizontal:64*R.a}:{flexDirection:"column",justifyContent:"flex-start",flex:1},children:[Object(V.jsxs)(j.a,{style:g>=L.a.lg?{flex:2}:"mobile"===Xe.a&&{flex:1},children:[Object(V.jsx)(j.a,{children:y}),Object(V.jsx)(j.a,{style:g>=L.a.lg?{marginTop:24*R.a,flex:1}:{flex:1},children:g>=L.a.lg?Object(V.jsx)(dt,{courseData:s,video:o,dark:f}):Object(V.jsx)(j.a,{style:{flex:1},children:Object(V.jsx)(Ot,{courseData:s,currentVideo:o,relatedVideos:l,setCurrentVideo:i,dark:f})})})]}),g>=L.a.lg&&Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(j.a,{style:{width:32*R.a}}),Object(V.jsx)(j.a,{style:{flex:1},children:Object(V.jsx)(Ot,{currentVideo:o,relatedVideos:l,setCurrentVideo:i,dark:f})})]})]})})]})}function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=[{name:"Courses",icon:"school"},{name:"Material",icon:"folders"},{name:"Email",icon:"mail"},{name:"ExamSessions",icon:"ballpen"}],yt=[d.b.accent300,d.b.red,"#9b51e0","#f2c94c"],xt=function(){var e=Object(f.a)().t,t=Object(b.useContext)(z.a).dark,n=Object(Z.p)(),r=Object(O.c)((function(e){return e.courses})),a=r.courses,c=r.recentMaterial,o=r.loadExtendedCourseInfoStatus,i=Object(b.useMemo)((function(){return a.flatMap((function(e){var t;return(null==(t=e.extendedInfo)?void 0:t.notices.map((function(t){return ht(ht({},t),{},{course_name:e.basicInfo.name,course_code:e.basicInfo.code})})))||[]})).sort((function(e,t){return t.date-e.date}))[0]}),[a]),s=Object(b.useMemo)((function(){return X.a.create({container:{marginTop:24*R.a,paddingHorizontal:16*R.a,paddingBottom:16*R.a},topSections:{flexDirection:"row",justifyContent:"space-between",paddingBottom:16},topSection:{justifyContent:"center",alignItems:"center"},topSectionInner:{width:40*R.a,height:40*R.a,borderRadius:4*R.a,marginBottom:4*R.a,justifyContent:"center",alignItems:"center"},topSectionText:{position:"absolute",bottom:-16*R.a}})}),[t]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:e("home"),headerType:We.MAIN}),Object(V.jsx)(P.a,{children:Object(V.jsxs)(j.a,{style:s.container,children:[Object(V.jsx)(ce.a,{onPress:function(){n.navigate("Search")},children:Object(V.jsx)(ot.a,{editable:!1,placeholder:e("searchForAnything"),dark:t,icon:"search",style:{marginBottom:32*R.a}})}),Object(V.jsxs)(j.a,{style:s.topSections,children:[pt.map((function(r,a){return Object(V.jsxs)(ce.a,{style:s.topSection,onPress:function(){n.navigate(r.name)},children:[Object(V.jsx)(j.a,{style:ht(ht({},s.topSectionInner),{},{backgroundColor:yt[a]}),children:Object(V.jsx)(B.a,{name:r.icon,size:24*R.a,color:d.b.gray100})}),Object(V.jsx)(H.a,{numberOfLines:1,s:10*R.a,w:"r",c:t?d.b.gray100:d.b.gray800,style:s.topSectionText,children:e(r.name[0].toLowerCase()+r.name.slice(1))})]},r.name)})),Object(V.jsxs)(ce.a,{style:s.topSection,onPress:function(){n.toggleDrawer()},children:[Object(V.jsx)(j.a,{style:ht(ht({},s.topSectionInner),{},{borderColor:d.b.gray200,borderWidth:1*R.a}),children:Object(V.jsx)(B.a,{name:"plus",size:24*R.a,color:d.b.gray200})}),Object(V.jsx)(H.a,{numberOfLines:1,s:10*R.a,w:"r",c:t?d.b.gray100:d.b.gray800,style:s.topSectionText,children:e("more")})]})]}),Object(V.jsx)(Ce,{dark:t,title:e("latestFiles"),style:{marginTop:32*R.a},children:o.code!=g.b.SUCCESS?Object(V.jsx)(le.a,{}):c.slice(0,3).map((function(e){return Object(V.jsx)(j.a,{children:Object(V.jsx)(_e,{relativeDate:!0,dark:t,item:e,course:e.course_name})},e.code)}))}),Object(V.jsx)(Ce,{dark:t,title:e("latestAlert"),style:{marginTop:24*R.a},children:o.code!=g.b.SUCCESS?Object(V.jsx)(le.a,{}):Object(V.jsx)(Re,{type:Ee.NotificationType.NOTICE,notification:i,dark:t})})]})})]})},vt=n(963),wt=n(77),kt=n(137),Ct=function(){var e=h()((function*(e){return yield Object(kt.emailUrl)(e)}));return function(t){return e.apply(this,arguments)}}();function St(){var e=Object(f.a)().t,t=Object(b.useContext)(z.a),n=t.dark,r=t.device,a=Object(O.b)(),c=Object(b.useState)(!0),o=u()(c,2),i=o[0],s=o[1],l=Object(b.useState)(!1),g=u()(l,2),m=g[0],p=g[1],y=Object(b.useState)(null),x=u()(y,2),v=(x[0],x[1]),w=Object(b.useState)(""),k=u()(w,2),C=k[0],S=k[1];Object(b.useEffect)((function(){return function(){return s(!1)}}),[]),Object(b.useEffect)((function(){h()((function*(){a(Object(wt.e)(r)),!C&&i&&S(yield Ct(r)),C&&"mobile"!==Xe.a&&p(!0)}))()}),[r,a,i,C]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:e("email"),headerType:We.MAIN}),Object(V.jsxs)(M.default.View,{style:{flex:1},children:[m?"mobile"!==Xe.a?Object(V.jsxs)(j.a,{style:{flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:n?d.b.gray100:d.b.gray800,style:{marginRight:16*R.a},children:e("emailCannotBeShownWeb",{genericPlatform:Xe.a})}),Object(V.jsx)(H.a,{href:C,s:12*R.a,w:"m",c:n?d.b.gray100:d.b.gray800,style:{marginRight:16*R.a},children:e("openBrowser")})]}):null:Object(V.jsxs)(j.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:n?d.b.gray100:d.b.gray800,style:{marginRight:16*R.a},children:e("loading")}),Object(V.jsx)(le.a,{})]}),"mobile"===Xe.a&&Object(V.jsx)(j.a,{style:{flex:m?1:0},children:Object(V.jsx)(vt.a,{ref:function(e){return!e&&v(e)},source:{uri:C},onNavigationStateChange:function(e){"mobile"===Xe.a&&(e.loading||m||!i||p(!0))}})})]})]})}var Dt=n(482),Pt=function(e){var t=e.icon,n=e.name,r=e.description,a=e.disabled,c=void 0!==a&&a,o=e.settingsFunction,i=void 0===o?function(){}:o,s=e.toggle,l=void 0!==s&&s,u=e.toggleValue,f=e.padding,O=void 0!==f&&f,g=e.paddingBottom,m=void 0===g||g,h=e.children,p=void 0===h?null:h,y=Object(b.useContext)(z.a).dark,x=Object(b.useMemo)((function(){return X.a.create({container:{flexDirection:"row",alignItems:"center"},textContainer:{flex:1,flexDirection:"column",justifyContent:"flex-start"}})}),[]);return Object(V.jsxs)(j.a,{style:[O?{paddingHorizontal:16*R.a}:{},m?{paddingBottom:16*R.a}:{}],children:[Object(V.jsxs)(ce.a,{disabled:!!p||c,onPress:i,android_ripple:{color:d.b.gray200},style:[x.container,c?{opacity:.5}:{}],children:[t?Object(V.jsx)(j.a,{style:{marginRight:12*R.a},children:Object(V.jsx)(B.a,{name:t,size:24*R.a,color:y?d.b.gray300:d.b.gray600})}):null,Object(V.jsxs)(j.a,{style:x.textContainer,children:[Object(V.jsx)(H.a,{w:"m",s:12*R.a,c:y?d.b.gray100:d.b.gray800,style:{marginBottom:2*R.a},children:n}),r?Object(V.jsx)(H.a,{w:"r",s:10*R.a,c:y?d.b.gray200:d.b.gray700,children:r}):null]}),l?Object(V.jsx)(Dt.a,{value:u,onChange:i}):null]}),Object(V.jsx)(j.a,{children:p})]})},It=n(228);function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=function(){var e=Object(f.a)().t,t=Object(O.b)(),n=Object(O.c)((function(e){return e.session.config}));return Object(V.jsx)(F,{title:e("debugEnableLogging"),icon:"alert-triangle",accentColor:d.b.red,onConfirm:function(){t(Object(Qe.e)(Et(Et({},n),{},{logging:!n.logging}))),t(Object(Qe.g)({message:e("restartToastMessage"),type:"warn",visible:!0}))},children:Object(V.jsx)(U.RenderHTMLSource,{source:{html:e("debugEnableLoggingDialogMessage",{path:It.default.logsDirectoryPath})}})})};function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rt(){var e=Object(f.a)().t,t=Object(b.useContext)(z.a),n=t.dark,r=t.device,a=Object(b.useContext)(S.a).setModal,c=Object(O.c)((function(e){return e.session.config})),o=Object(O.b)(),i=[{icon:"bug",name:e("debugEnableLogging"),description:e("debugEnableLoggingDesc"),settingsFunction:function(){c.logging?o(Object(Qe.e)(zt(zt({},c),{},{logging:!1}))):a(Object(V.jsx)(Tt,{}))},toggle:!0,toggleValue:c.logging},{icon:"arrow-back",name:e("debugResetConfig"),description:e("debugResetConfigDesc"),settingsFunction:function(){o(Object(Qe.d)())}},{icon:"bell-ringing",name:e("debugTestNotification"),description:e("debugTestNotificationDesc"),settingsFunction:function(){o(Object(Qe.g)({message:e("pleaseWait"),type:"info",visible:!0})),h()((function*(){yield Object(Ee.sendTestPushNotification)(r)}))()}}],s=Object(b.useMemo)((function(){return X.a.create({container:{marginTop:24*R.a,paddingHorizontal:16*R.a,paddingBottom:16*R.a}})}),[]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{headerType:We.MAIN,title:e("settings")}),Object(V.jsx)(j.a,{style:s.container,children:parseInt(y.a.ENABLE_DEBUG_OPTIONS)?Object(V.jsx)(Ce,{dark:n,title:e("debugSettings"),children:Object(V.jsx)(j.a,{style:{marginTop:-8*R.a},children:i.map((function(e){return function(e){return Object(V.jsx)(Pt,zt({},e),e.name)}(e)}))})}):null}),Object(V.jsx)(j.a,{style:{marginTop:8,marginBottom:16,flexDirection:"row",justifyContent:"center"},children:Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:n?d.b.gray200:d.b.gray700,children:"v"+x.version})})]})}var Lt=["explore","recentlyAdded"];function Nt(){var e=Object(f.a)().t,t=Object(O.b)(),n=Object(Z.p)(),r=Object(O.c)((function(e){return e.courses.courses})),a=Object(O.c)((function(e){return e.courses})),c=a.getRecentMaterialStatus,o=a.recentMaterial,i=Object(b.useState)(0),s=u()(i,2),l=s[0],d=s[1],m=Object(b.useContext)(z.a),h=m.dark,p=m.device,y=Object(b.useState)(!1),x=u()(y,2),v=x[0],w=x[1],k=Object(b.useState)(!1),C=u()(k,2),S=(C[0],C[1]);Object(b.useEffect)((function(){var e=!0;r.forEach((function(n){n.status.code!=g.b.SUCCESS&&(e=!1,t(Object(Fe.c)({basicCourseInfo:n.basicInfo,device:p})))})),e&&w(!0)}),[]),Object(b.useEffect)((function(){if(!v){var e=!0;r.forEach((function(t){t.status.code!=g.b.SUCCESS&&(e=!1)})),e&&w(!0)}}),[r]),Object(b.useEffect)((function(){v&&c.code!=g.b.SUCCESS&&c.code!=g.b.PENDING&&t(Object(Fe.b)())}),[v]),Object(b.useEffect)((function(){c.code==g.b.SUCCESS&&S(!0)}),[c]);var D=Object(b.useMemo)((function(){return X.a.create({container:{marginTop:24*R.a,paddingHorizontal:16*R.a,paddingBottom:16*R.a}})}),[h]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{headerType:We.MAIN,title:e("material")}),Object(V.jsx)($.a,{data:[0],renderItem:function(){return Object(V.jsxs)(j.a,{style:D.container,children:[Object(V.jsx)(ce.a,{onPress:function(){n.navigate("Search")},children:Object(V.jsx)(ot.a,{editable:!1,placeholder:e("searchForAnything"),dark:h,icon:"search"})}),Object(V.jsx)(nt,{style:{marginTop:24*R.a,marginBottom:16*R.a},onChange:function(e){return d(e)},dark:h,items:Lt.map((function(t){return{label:e(t),value:t}}))}),0==l?Object(V.jsx)(Ve,{courseId:"all",dark:h}):Object(V.jsx)($.a,{data:o,keyExtractor:function(e){return e.code},renderItem:function(e){var t=e.item;return Object(V.jsx)(_e,{item:t,dark:h,course:t.course_name},t.code)}})]})}})]})}var Bt=n(41),Ht=n(973),Vt=n(27),At=n.n(Vt),Ft=n(853),Gt=[{name:"general",items:[{name:"Home",icon:"layout-dashboard"},{name:"Email",icon:"mail"},{name:"Notifications",icon:"bell"},{name:"Settings",icon:"settings"}]},{name:"classes",items:[{name:"Courses",icon:"school"},{name:"Material",icon:"folders"},{name:"Bookings",icon:"ticket"},{name:"Timetable",icon:"clock"}]},{name:"exams",items:[{name:"Exams",icon:"book-2"},{name:"ExamSessions",icon:"ballpen"}]},{name:"headquarters",items:[{name:"Maps",icon:"map-2"},{name:"Classrooms",icon:"building-arch"},{name:"People",icon:"user"}]}],Ut=["dark"];function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qt=function(e){return["Maps","Classrooms","People"].includes(e)},Jt=Gt.flatMap((function(e){return e.items.map((function(e){return e.name}))})),Xt=function(e){var t=e.dark,n=At()(e,Ut),r=Object(f.a)().t,a=Object(O.b)(),c=Object(b.useContext)(z.a),o=Object(O.c)((function(e){return e.user.userInfo})),i=Object(b.useMemo)((function(){return null==o?"":(e=o.degree_type,t=o.degree_name,("corso di laurea in"==e.toLowerCase()?"L3":"corso di laurea magistrale in"==e.toLowerCase()?"LM":"")+" "+t.toLowerCase().replace("ingegneria","").toUpperCase().trim());var e,t}),[o]),s=Object(b.useState)(Jt[0]),l=u()(s,2),g=l[0],m=l[1],h=Object(b.useCallback)((function(){a(Object(Qe.c)(c.device))}),[a,c]),p=Object(b.useMemo)((function(){return X.a.create({drawerScrollView:{backgroundColor:t?d.b.gray800:d.b.gray100},drawer:{flexDirection:"column",paddingHorizontal:16*R.a,paddingVertical:24*R.a},hr:{backgroundColor:d.b.gray500,height:1*R.a,marginBottom:16*R.a},category:{marginBottom:16*R.a}})}),[t]);return Object(V.jsx)(Ft.a,Wt(Wt({style:p.drawerScrollView},n),{},{children:Object(V.jsxs)(j.a,{style:p.drawer,children:[Object(V.jsxs)(j.a,{style:{justifyContent:"flex-start",marginBottom:16*R.a},children:[Object(V.jsx)(H.a,{s:14*R.a,w:"b",c:t?d.b.gray100:d.b.gray800,children:"Open PoliTo"}),Object(V.jsxs)(H.a,{s:10*R.a,w:"r",c:t?d.b.gray200:d.b.gray700,children:["v",x.version]})]}),Object(V.jsx)(j.a,{style:p.hr}),Gt.map((function(e){return Object(V.jsxs)(j.a,{style:p.category,children:[Object(V.jsx)(j.a,{style:{marginBottom:8*R.a},children:Object(V.jsx)(H.a,{s:10*R.a,w:"m",c:t?d.b.gray200:d.b.gray700,children:r(e.name).toUpperCase()})}),e.items.map((function(e){return Object(V.jsxs)(ce.a,{disabled:qt(e.name),style:{paddingVertical:4*R.a,flexDirection:"row",alignItems:"center",opacity:qt(e.name)?.3:1},onPress:function(){m(e.name),n.navigation.navigate(e.name)},children:[Object(V.jsx)(B.a,{name:e.icon,size:24*R.a,color:e.name==g?d.b.accent300:t?d.b.gray100:d.b.gray700,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:e.name==g?d.b.accent300:t?d.b.gray100:d.b.gray800,children:r(e.name.charAt(0).toLowerCase()+e.name.slice(1))})]},e.name)}))]})})),Object(V.jsx)(j.a,{style:p.hr}),Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(V.jsx)(j.a,{style:{width:24*R.a,height:24*R.a,borderRadius:24*R.a,backgroundColor:d.b.accent100,marginRight:8*R.a}}),Object(V.jsxs)(j.a,{style:{justifyContent:"flex-start",flex:1},children:[Object(V.jsxs)(H.a,{numberOfLines:1,w:"b",c:t?d.b.gray100:d.b.gray800,s:12*R.a,children:[null==o?void 0:o.surname," ",null==o?void 0:o.name]}),Object(V.jsx)(H.a,{numberOfLines:1,w:"r",c:t?d.b.gray200:d.b.gray700,s:10*R.a,children:i})]}),Object(V.jsx)(ce.a,{onPress:function(){h()},children:Object(V.jsx)(B.a,{name:"logout",size:24*R.a,color:d.b.accent300})})]})]})}))},Qt=n(93),Kt=n(102),Zt=n(262);function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tn=function(e){var t,n=e.dark,r=e.title,a=e.description,c=e.onPress,o=e.expanded,i=e.sideElement,s=e.expandedElement,l=e.children,f=Object(_.a)(0),O=Object(_.a)(0),g=Object(_.a)(1),m=Object(b.useState)(null),h=u()(m,2),p=h[0],y=h[1],x=Object(_.a)(0),v=Object(_.a)(0),w=Object(E.a)(((t=function(){return{opacity:O.value}})._closure={opacity:O},t.asString="function _f(){const{opacity}=jsThis._closure;{return{opacity:opacity.value};}}",t.__workletHash=1880562015862,t.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (55:41)",t.__optimalization=3,t)),k=Object(b.useState)(s),C=u()(k,2),S=C[0],D=C[1];Object(b.useEffect)((function(){var e;(e=o||!p?s:Object(V.jsx)(j.a,{}))&&setTimeout((function(){D(e)}),o?0:200)}),[o,s,p]);var P=Object(b.useCallback)((function(e){null===p&&(O.value=Object(T.a)(1,{duration:200}),y(e.nativeEvent.layout.height))}),[p,O]);Object(b.useEffect)((function(){if(0!==p){var e=o&&s;f.value=Object(T.a)(e?90:0,{duration:200}),v.value=Object(T.a)(1,{duration:400})}}),[o,f,v,s,p]),Object(b.useEffect)((function(){g.value=Object(T.a)(i?1:0,{duration:400})}),[i,g]);var I=Object(E.a)(function(){var e=function(){return{transform:[{rotate:f.value+"deg"}]}};return e._closure={rotation:f},e.asString='function _f(){const{rotation}=jsThis._closure;{return{transform:[{rotate:rotation.value+"deg"}]};}}',e.__workletHash=0xb8f92e0794d,e.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (125:44)",e.__optimalization=3,e}());Object(b.useEffect)((function(){p&&(x.value=Object(T.a)(o?p:0,{duration:200}))}),[p,x,o]);var z=Object(E.a)(function(){var e=function(){return en(en({},null!==p?{height:x.value}:{}),{},{opacity:Object(T.a)(o&&null!==p?1:0,{duration:200})})};return e._closure={computedHeight:p,expandedElementHeight:x,withTiming:T.a,expanded:o},e.asString="function _f(){const{computedHeight,expandedElementHeight,withTiming,expanded}=jsThis._closure;{return{...(computedHeight!==null?{height:expandedElementHeight.value}:{}),opacity:withTiming(expanded&&computedHeight!==null?1:0,{duration:200})};}}",e.__workletHash=8846081890926,e.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (144:48)",e.__optimalization=2,e}()),L=Object(E.a)(function(){var e=function(){return{opacity:g.value}};return e._closure={sideElementOpacity:g},e.asString="function _f(){const{sideElementOpacity}=jsThis._closure;{return{opacity:sideElementOpacity.value};}}",e.__workletHash=0xf81030983f6,e.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (155:44)",e.__optimalization=3,e}()),N=Object(b.useMemo)((function(){return X.a.create({button:{paddingVertical:8*R.a,paddingLeft:16*R.a,paddingRight:8*R.a,marginBottom:16*R.a,backgroundColor:n?d.b.gray700:d.b.gray200,borderRadius:4*R.a}})}),[n]);return Object(V.jsx)(M.default.View,{style:[w],children:Object(V.jsx)(ce.a,{onPress:c,android_ripple:{color:n?d.b.gray400:d.b.gray500},style:N.button,children:Object(V.jsx)(j.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:s?"flex-start":"center"},children:Object(V.jsxs)(j.a,{style:{flex:1},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(V.jsxs)(j.a,{style:{flex:4},children:[r&&Object(V.jsx)(H.a,{s:12*R.a,c:n?d.b.gray200:d.b.gray700,w:"m",children:r}),a&&Object(V.jsx)(H.a,{s:10*R.a,c:n?d.b.gray300:d.b.gray600,w:"r",children:a})]}),Object(V.jsx)(M.default.View,{style:[L,{flex:i?1:0}],children:i}),Object(V.jsx)(j.a,{style:{justifyContent:"flex-start",alignItems:"center"},children:Object(V.jsx)(j.a,{children:Object(V.jsx)(M.default.View,{style:[I],children:Object(V.jsx)(B.a,{name:"chevron-right",color:n?d.b.gray200:d.b.gray700,size:24*R.a})})})})]}),Object(V.jsxs)(j.a,{style:{paddingRight:8*R.a},children:[l,Object(V.jsx)(M.default.View,{onLayout:function(e){return P(e)},style:[z],children:S})]})]})})})})};function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an=function(e){e.ctxId;var t=e.subctx,n=e.language,r=e.dark,a=(Object(b.useContext)(z.a).device,Object(b.useState)({loaded:!1,expanded:!1,mounted:!0,slots:[]})),c=u()(a,2),o=(c[0],c[1]);return Object(b.useEffect)((function(){return function(){return o((function(e){return rn(rn({},e),{},{mounted:!1})}))}}),[]),Object(V.jsxs)(j.a,{children:[Object(V.jsx)(Oe.a,{onPress:function(){return o((function(e){return rn(rn({},e),{},{expanded:!e.expanded})}))},android_ripple:{color:d.b.lightGray},style:{paddingVertical:8*R.a},children:Object(V.jsx)(H.a,{s:10*R.a,w:"m",c:r?d.b.gray200:d.b.gray700,children:"it"===n?t.ita.name:t.eng.name})}),Object(V.jsx)(j.a,{})]},t.id)},cn=function(e){var t,n=e.ctx,r=e.language,a=e.dark,c=Object(b.useState)(!1),o=u()(c,2),i=o[0],s=o[1];return Object(V.jsx)(j.a,{children:Object(V.jsx)(tn,{expanded:i,dark:a,onPress:function(){s(!i)},description:"it"===r?n.ita.description:n.eng.description,title:"it"===r?n.ita.name:n.eng.name,expandedElement:n.subcontexts&&n.subcontexts.length>0?Object(V.jsx)(j.a,{style:{marginTop:16*R.a},children:null==(t=n.subcontexts)?void 0:t.map((function(e){return Object(V.jsx)(an,{dark:a,subctx:e,language:r,ctxId:n.id},e.id)}))}):null})})},on=function(e){var t=e.dark,n=e.booking,r=e.barcodeUrl,a=Object(b.useState)(!1),c=u()(a,2),o=c[0],i=c[1],s=Object(b.useMemo)((function(){return[{type:"date",label:re()(n.start_time).format("ll"),icon:"calendar-time"},{type:"time",label:re()(n.start_time).format("LT")+" - "+re()(n.end_time).format("LT"),icon:"clock"}]}),[n]);return Object(V.jsx)(tn,{title:n.course_id?n.course_name+" - "+n.course_id:n.subcontext_name,description:n.context_name,expanded:o,dark:t,sideElement:!o&&Object(V.jsx)(ae.a,{source:{uri:r},style:{width:"100%",aspectRatio:2.5,resizeMode:"contain"},resizeMode:"contain"}),expandedElement:Object(V.jsx)(j.a,{style:{flex:1,marginTop:16*R.a},children:Object(V.jsx)(ae.a,{source:{uri:r},style:{width:"100%",aspectRatio:2.5,resizeMode:"contain"}})}),onPress:function(){return i((function(e){return!e}))},children:Object(V.jsx)(j.a,{style:{marginTop:16*R.a},children:s.map((function(e,n){return Object(V.jsxs)(j.a,{style:[{flexDirection:"row",alignItems:"center"},n>0&&{marginTop:8*R.a}],children:[Object(V.jsx)(B.a,{name:e.icon,size:16*R.a,color:t?d.b.gray200:d.b.gray700,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{style:{marginRight:8*R.a},s:10*R.a,w:"r",c:t?d.b.gray200:d.b.gray700,children:e.label})]})}))})})},sn=function(){var e=Object(f.a)().t,t=Object(b.useContext)(z.a),n=t.device,r=t.dark,a=Object(O.b)(),c=Object(O.c)((function(e){return e.user})),o=c.userInfo,i=c.getBookingsStatus,s=c.getBookingContextsStatus,l=c.bookings,d=c.bookingContexts,m=Object(b.useRef)(!0),p=Object(b.useMemo)((function(){return["myBookings","newBooking"]}),[]),y=Object(b.useState)({currentTab:p[0],barcodeUrl:""}),x=u()(y,2),v=x[0],w=x[1],k=Object(b.useMemo)((function(){return i.code===g.b.PENDING||s.code===g.b.PENDING}),[i,s]),C=Object(b.useCallback)((function(e){"myBookings"===e&&a(Object(wt.c)(n)),"newBooking"===e&&a(Object(wt.b)(n))}),[n,a]);Object(b.useEffect)((function(){""===v.barcodeUrl&&o&&w((function(e){return rn(rn({},e),{},{barcodeUrl:Object(Kt.barcode_url)(o.current_id)})}))}),[v.barcodeUrl,o]),Object(b.useEffect)((function(){h()((function*(){v.currentTab===p[0]?a(Object(wt.c)(n)):v.currentTab===p[1]&&a(Object(wt.b)(n))}))()}),[v.currentTab,o,n,a,p]),Object(b.useEffect)((function(){return function(){m.current=!1}}),[]);var S=Object(b.useMemo)((function(){return X.a.create({container:{marginTop:24*R.a,paddingHorizontal:16*R.a,flex:1}})}),[]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:e("bookings"),headerType:We.MAIN}),Object(V.jsx)(nt,{adjusted:!0,dark:r,onChange:function(e){return w((function(t){return rn(rn({},t),{},{currentTab:p[e]})}))},items:p.map((function(t){return{label:e(t),value:t}}))}),Object(V.jsx)(j.a,{style:S.container,children:Object(V.jsx)(Zt.ScrollView,{refreshControl:Object(V.jsx)(J.a,{refreshing:k,onRefresh:function(){return C(v.currentTab===p[0]?"myBookings":"newBooking")}}),children:v.currentTab===p[0]&&i.code===g.b.PENDING||v.currentTab===p[1]&&s.code===g.b.PENDING?Object(V.jsx)(le.a,{}):v.currentTab===p[0]?0===l.length?Object(V.jsx)(te,{}):l.map((function(e){return Object(V.jsx)(on,{dark:r,booking:e,barcodeUrl:v.barcodeUrl},""+e.context_id+e.subcontext_id+e.start_time+e.end_time)})):0===d.length?Object(V.jsx)(te,{}):d.map((function(e){return Object(V.jsx)(cn,{dark:r,ctx:e,language:Qt.b.language},e.id)}))})})]})},ln=n(939),un=n(37),bn=n(454),jn=n.n(bn),dn=function(e){var t=e.width,n=e.height,r=e.children;return Object(V.jsx)(j.a,{style:{width:t,height:n},children:r})},fn=function(e){var t,n=e.children,r=Object(b.useState)(!1),a=u()(r,2),c=a[0],o=a[1],i=Object(b.useState)(!0),s=u()(i,2),l=s[0],j=s[1],d=Object(_.a)(0),f=Object(E.a)(((t=function(){return{opacity:d.value,transform:[{translateY:8-8*d.value},{translateX:8-8*d.value}]}})._closure={offset:d},t.asString="function _f(){const{offset}=jsThis._closure;{return{opacity:offset.value,transform:[{translateY:8-offset.value*8},{translateX:8-offset.value*8}]};}}",t.__workletHash=4069580825127,t.__location="/home/runner/work/open-polito/open-polito/src/components/loaders/LoaderBase.tsx (16:37)",t.__optimalization=3,t));return Object(b.useEffect)((function(){return h()((function*(){setTimeout((function(){l&&o(!0)}),150)}))(),function(){j(!1)}}),[]),Object(b.useEffect)((function(){c&&(d.value=Object(T.a)(1,{duration:200}))}),[c]),c?Object(V.jsx)(M.default.View,{style:[f],children:n}):null},On=function(e){var t=e.w,n=e.h,r=Object(b.useState)(Math.ceil(2*Math.random())),a=u()(r,1)[0],c=Object(b.useState)(Array.from({length:a},(function(e,t){return(t+1)*(3+Math.random())*n}))),o=u()(c,1)[0];return Object(V.jsx)(j.a,{style:{height:10*n,position:"absolute"},children:Object(V.jsx)(fn,{children:Object(V.jsx)(dn,{width:t,height:15*n,children:Array.from({length:a}).map((function(e,r){return Object(V.jsx)(bn.Rect,{x:0,y:o[r],rx:4*R.a,ry:4*R.a,width:t-4,height:2*n},r)}))})})})},gn=function(e){var t=e.slot,n=Object(b.useContext)(z.a).dark,r=Object(b.useMemo)((function(){return[{icon:"map-pin",name:t.room},{icon:"align-justified",name:t.type},{icon:"clock",name:re()(t.start_time).format("HH:mm")+" - "+re()(t.end_time).format("HH:mm")+" ("+re()(t.start_time).format("ll")+")"},{icon:"user",name:t.professor.surname+" "+t.professor.name}]}),[t]);return Object(V.jsx)(A,{title:t.course_name,children:r.map((function(e,t){return Object(V.jsxs)(j.a,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginTop:(0==t?0:8)*R.a},children:[Object(V.jsx)(B.a,{name:e.icon,size:16*R.a,color:n?d.b.gray300:d.b.gray600,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{s:12*R.a,c:n?d.b.gray100:d.b.gray800,w:"r",children:e.name})]})}))})},mn=function(e){var t=e.overlapGroup,n=e.slot,r=e.w,a=e.h,c=e.courseNames,o=e.index,i=Object(b.useContext)(S.a).setModal,s=Object(_.a)(0),l=Object(_.a)(0),f=Object(_.a)(0),O=Object(b.useState)(0),g=u()(O,2),m=g[0],h=g[1];Object(b.useEffect)((function(){l.value=1}),[]),Object(b.useEffect)((function(){s.value=r,r>=60&&setTimeout((function(){f.value=1}),100)}),[r]);var p,y=Object(E.a)(((p=function(){return{opacity:Object(T.a)(f.value,{duration:500})}})._closure={withTiming:T.a,textOpacity:f},p.asString="function _f(){const{withTiming,textOpacity}=jsThis._closure;{return{opacity:withTiming(textOpacity.value,{duration:500})};}}",p.__workletHash=3417517497760,p.__location="/home/runner/work/open-polito/open-polito/src/components/timetable/TimetableEvent.tsx (53:48)",p.__optimalization=2,p)),x=Object(E.a)(function(){var e=function(){return{width:Object(T.a)(t.length>0?s.value/t.length:s.value,{duration:250}),left:Object(T.a)(t.length>0?o*(s.value/t.length):0,{duration:250})}};return e._closure={withTiming:T.a,overlapGroup:t,offset:s,index:o},e.asString="function _f(){const{withTiming,overlapGroup,offset,index}=jsThis._closure;{return{width:withTiming(overlapGroup.length>0?offset.value/overlapGroup.length:offset.value,{duration:250}),left:withTiming(overlapGroup.length>0?index*(offset.value/overlapGroup.length):0,{duration:250})};}}",e.__workletHash=0xa9304f61bed,e.__location="/home/runner/work/open-polito/open-polito/src/components/timetable/TimetableEvent.tsx (57:37)",e.__optimalization=2,e}());return Object(V.jsx)(M.default.View,{onLayout:function(e){return h(e.nativeEvent.layout.width)},style:[{overflow:"hidden",position:"absolute",top:a+re.a.duration(re()(n.start_time).diff(re()(n.start_time).set({h:8,m:0}))).as("ms")/36e5*a-a/2,borderRadius:4*R.a,backgroundColor:d.a[c.findIndex((function(e){return e==n.course_name}))],height:re.a.duration(n.end_time-n.start_time).as("ms")/36e5*a},x],children:Object(V.jsxs)(I.a,{style:{flex:1,padding:4*R.a},onPress:function(){i(Object(V.jsx)(gn,{slot:n}))},children:[m>=25?Object(V.jsx)(M.default.View,{style:[y],children:Object(V.jsx)(H.a,{w:"r",s:8*R.a,c:d.b.white,numberOfLines:2,children:n.course_name})}):null,m>=60?Object(V.jsxs)(M.default.View,{style:[y],children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",marginTop:8*R.a,alignItems:"center",justifyContent:"flex-start",overflow:"hidden"},children:[Object(V.jsx)(B.a,{name:"map-pin",size:8*R.a,color:d.b.gray50}),Object(V.jsx)(H.a,{w:"r",s:8*R.a,c:d.b.gray50,numberOfLines:2,style:{marginLeft:2*R.a},children:n.room})]}),Object(V.jsxs)(j.a,{style:{opacity:l.value,flexDirection:"row",marginTop:4*R.a,alignItems:"center",justifyContent:"flex-start",overflow:"hidden"},children:[Object(V.jsx)(B.a,{name:"list",size:8*R.a,color:d.b.gray50}),Object(V.jsx)(H.a,{w:"r",s:8*R.a,c:d.b.gray50,numberOfLines:2,style:{marginLeft:2*R.a},children:n.type})]})]}):null]})})},hn=function(e){var t=e.fake,n=void 0!==t&&t,r=e.day,a=e.h,c=e.courseNames,o=e.config,i=(e.index,Object(b.useState)(0)),s=u()(i,2),l=s[0],f=s[1],O=Object(b.useMemo)((function(){return K()(r).sort((function(e,t){return o.timetablePriority.indexOf(t.course_name)-o.timetablePriority.indexOf(e.course_name)}))}),[o.timetablePriority,r]),g=Object(b.useMemo)((function(){if("priority"===o.timetableOverlap)return[];if(0===r.length)return[];for(var e=[],t=re()(r[0].start_time).set({h:8,m:45}),n=function(n){t.add(90,"m");var a=[];r.map((function(e){e.start_time<t.toDate().getTime()&&t.toDate().getTime()<e.end_time&&a.push(e)})),a.length>1&&e.push(a)},a=0;a<9;a++)n();return e}),[r,o.timetableOverlap]);return Object(V.jsx)(j.a,{onLayout:function(e){f(e.nativeEvent.layout.width)},style:{backgroundColor:d.b.white,flex:1,zIndex:200,flexDirection:"column",justifyContent:"flex-start",alignItems:"center",borderColor:d.b.gray200,marginHorizontal:1*R.a},children:n?Object(V.jsx)(On,{w:l,h:a}):"priority"===o.timetableOverlap?O.map((function(e,t){return Object(V.jsx)(mn,{overlapGroup:[],slot:e,w:l,h:a,courseNames:c,index:t},t)})):r.map((function(e,t){var n=function(e){var t=[];return g.forEach((function(n){n.includes(e)&&(t=n)})),t}(e),r=n.findIndex((function(t){return e===t}));return Object(V.jsx)(mn,{overlapGroup:n,slot:e,w:l,h:a,courseNames:c,index:r},t)}))})};function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xn=function(e){var t=e.loaded,n=e.timetableDays,r=e.layout,a=e.selectedDay,c=Object(O.b)(),o=Object(O.c)((function(e){return e.session.config})),i=Object(b.useState)(un.a.get("window").height/15),s=u()(i,2),l=s[0],d=(s[1],Object(b.useState)(["","",""])),f=u()(d,2),g=f[0],m=f[1],h=Object(b.useMemo)((function(){return 1===n.length?n:n.slice(1,6)}),[n]);return Object(b.useEffect)((function(){var e;m((e=[],n.forEach((function(t){t.forEach((function(t){e.includes(t.course_name)||e.push(t.course_name)}))})),e.sort()))}),[h]),Object(b.useEffect)((function(){if(o.timetableOverlap&&o.timetablePriority){var e=K()(o.timetablePriority),t=!1;g.forEach((function(n){""===n.trim()||o.timetablePriority.includes(n)||(e.push(n),t=!0)})),t&&c(Object(Qe.e)(yn(yn({},o),{},{timetablePriority:e})))}}),[h,g,o,c]),Object(V.jsx)(j.a,{style:{position:"absolute",left:0,right:0,top:0,bottom:0,flex:1,marginLeft:32*R.a,marginRight:16*R.a,flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:("week"===r?h:[h[a-1]]).map((function(e,n){return Object(V.jsx)(hn,{fake:!t,config:o,day:e,h:l,index:n,courseNames:g},n)}))})},vn=function(e){var t=e.showLine,n=e.dark,r=Object(b.useState)(un.a.get("window").height/15),a=u()(r,2),c=a[0],o=(a[1],Object(b.useState)(re()())),i=u()(o,2),s=i[0],l=i[1],f=Object(b.useState)(!0),O=u()(f,2),g=O[0],m=O[1],h=Object(b.useState)(null),p=u()(h,2),y=p[0];p[1];Object(b.useEffect)((function(){return m(!0),function(){y&&clearTimeout(y),m(!1)}}),[]),Object(b.useEffect)((function(){setTimeout((function(){g&&l(re()())}),1e4)}),[s,g]);var x=X.a.create({padding:{paddingLeft:8*R.a,paddingRight:16*R.a,paddingBottom:16*R.a}});return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(j.a,{style:[x.padding,{flex:1,flexDirection:"column",justifyContent:"flex-start",alignItems:"stretch"}],children:Array.from({length:14}).map((function(e,t){return Object(V.jsxs)(j.a,{style:{width:"100%",height:0==t?c/2:c,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end"},children:[Object(V.jsx)(H.a,{s:8*R.a,c:n?d.b.gray200:d.b.gray700,w:"r",style:{transform:[{translateY:4*R.a}]},children:8+t+":00"}),Object(V.jsx)(j.a,{style:{flex:1,borderBottomWidth:.5*R.a,borderColor:n?d.b.gray500:d.b.gray200,marginLeft:4*R.a,height:c,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end"}})]},t)}))}),t?Object(V.jsx)(j.a,{style:[x.padding,{position:"absolute",left:0,right:0,zIndex:300}],children:Object(V.jsx)(j.a,{style:{height:0,borderTopColor:d.b.red,borderBottomColor:d.b.red,backgroundColor:d.b.red,borderTopWidth:.5*R.a,borderBottomWidth:.5*R.a,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",transform:[{translateY:c+re.a.duration(s.diff(re()().set({h:8,m:0}))).as("ms")/36e5*c-c/2}]},children:Object(V.jsx)(j.a,{style:{backgroundColor:d.b.red,width:8*R.a,height:8*R.a,borderRadius:16*R.a}})})}):null]})},wn=function(e){var t=e.items,n=e.label,r=void 0===n?"":n,a=e.onValueChange,c=e.defaultValue,o=void 0===c?t[0].value:c,i=e.dark,s=Object(b.useState)(o),l=u()(s,2),f=l[0],O=l[1];return Object(b.useEffect)((function(){a(f)}),[f]),Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[r?Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:i?d.b.gray100:d.b.gray800,style:{marginRight:4*R.a},children:r}):null,Object(V.jsx)(j.a,{style:{flexDirection:"row",backgroundColor:i?d.b.gray700:d.b.gray200,marginLeft:4*R.a,borderRadius:4*R.a},children:t.map((function(e,n){return Object(V.jsx)(ce.a,{onPress:function(){O(e.value)},style:[{backgroundColor:e.value==f?d.b.accent300:"rgba(0,0,0,0)",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:4*R.a},0===n?{borderTopLeftRadius:4*R.a,borderBottomLeftRadius:4*R.a}:n===t.length-1?{borderTopRightRadius:4*R.a,borderBottomRightRadius:4*R.a}:{}],children:Object(V.jsx)(B.a,{name:e.icon,size:16*R.a,color:e.value==f?d.b.gray50:i?d.b.gray200:d.b.gray700})},e.value)}))})]})},kn=n(622),Cn=n(959),Sn=n(940),Dn=n.n(Sn),Pn=function(e){var t=e.items,n=e.callback,r=e.disabled,a=e.dark,c=Object(b.useState)(t),o=u()(c,2),i=o[0],s=o[1];Object(b.useEffect)((function(){n(i.map((function(e){return e.label})))}),[i]);return Object(V.jsx)(Zt.GestureHandlerRootView,{children:Object(V.jsx)(Dn.a,{onDragEnd:function(e){var t=e.data;return s(t)},data:i,keyExtractor:function(e){return e.value},renderItem:function(e){var t=e.item,n=(e.index,e.drag);return Object(V.jsx)(Sn.ScaleDecorator,{children:Object(V.jsx)(I.a,{disabled:r,onLongPress:n,onPressIn:n,onPress:n,style:{paddingVertical:4*R.a},children:Object(V.jsxs)(j.a,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:0*R.a,opacity:r?.5:1},children:[Object(V.jsx)(B.a,{name:"grid-dots",size:24*R.a,color:a?d.b.gray300:d.b.gray600}),Object(V.jsx)(j.a,{style:{marginLeft:8*R.a},children:Object(V.jsx)(H.a,{s:12*R.a,c:a?d.b.gray100:d.b.gray800,w:"r",children:t.label})})]})})})}})})};function In(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?In(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var En=function(){var e=Object(O.b)(),t=Object(f.a)().t,n=Object(b.useContext)(z.a).dark,r=Object(b.useState)(!1),a=u()(r,2),c=a[0],o=a[1];Object(b.useEffect)((function(){setTimeout((function(){return o(!0)}),0)}),[]);var i=Object(O.c)((function(e){return e.session.config})),s=Object(b.useMemo)((function(){return i.timetablePriority.map((function(e){return{label:e,value:e}}))}),[i]),l=Object(b.useCallback)((function(){var t="split"===i.timetableOverlap?"priority":"split";e(Object(Qe.e)(_n(_n({},i),{},{timetableOverlap:t})))}),[i,e]),g=Object(b.useMemo)((function(){return[{name:t("timetablePriority"),description:t("timetablePriorityDesc"),icon:"stack-2",toggle:!0,toggleValue:"priority"===i.timetableOverlap,settingsFunction:l},{name:t("timetablePriorityList"),settingsFunction:function(){},disabled:"priority"!==i.timetableOverlap,children:Object(V.jsx)(j.a,{children:Object(V.jsx)(Pn,{dark:n,disabled:"priority"!==i.timetableOverlap,items:s,callback:function(t){return e(Object(Qe.e)(_n(_n({},i),{},{timetablePriority:t.filter((function(e){return""!==e}))})))}})}),paddingBottom:!1}]}),[i,n,e,s,t,l]);return Object(V.jsx)(A,{title:t("timetableOptions"),children:Object(V.jsx)(j.a,{children:c?g.map((function(e){return Object(V.jsx)(Pt,_n({},e),e.name)})):Object(V.jsx)(le.a,{color:d.b.accent300})})})},Tn=function(e){var t,n=e.selectedDay,r=void 0===n?null:n,a=e.timetableDays,c=e.weekStartDate,o=e.onLayoutChanged,i=e.onDayChanged,s=e.onWeekStartDateChanged,l=Object(f.a)().t,u=Object(b.useContext)(z.a).dark,O=Object(b.useContext)(S.a).setModal,g=function(e){m.value=Object(kn.a)(Object(T.a)(0,{duration:250}),Object(T.a)(1,{duration:250})),s(e)},m=Object(_.a)(1),h=Object(E.a)(((t=function(){return{opacity:m.value}})._closure={opacity:m},t.asString="function _f(){const{opacity}=jsThis._closure;{return{opacity:opacity.value};}}",t.__workletHash=1880562015862,t.__location="/home/runner/work/open-polito/open-polito/src/components/timetable/TimetableHeader.tsx (72:37)",t.__optimalization=3,t)),y=Object(b.useMemo)((function(){var e=re()(c),t=re()(c).add(4,"day");return c?c.getTime()==re()().startOf("w").toDate().getTime()?l("thisWeek"):e.get("date")+" "+(e.get("month")!=t.get("month")?e.format("MMM "):"")+(e.get("year")!=t.get("year")?e.format("YYYY "):"")+"- "+t.format("D MMM YYYY"):l("thisWeek")}),[c,l]);return Object(V.jsxs)(j.a,{style:{borderBottomWidth:1*R.a,borderBottomColor:d.b.gray200},children:[Object(V.jsxs)(j.a,{style:{marginBottom:16*R.a,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:["android"===p.a.OS?Object(V.jsx)(N.a,{secondary:!0,small:!0,text:l("jumpToDate"),icon:"chevrons-right",onPress:function(){return e=function(e){e&&g(new Date(e))},void Cn.a.open({mode:"date",value:new Date,onChange:function(t){return e(t.nativeEvent.timestamp)}});var e}}):Object(V.jsx)(j.a,{}),Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(V.jsx)(wn,{defaultValue:"week",onValueChange:function(e){!function(e){o(e)}(e)},label:"Layout:",items:[{icon:"layout-rows",value:"day"},{icon:"layout-columns",value:"week"}],dark:u}),Object(V.jsx)(Zt.TouchableOpacity,{style:{marginLeft:24*R.a},onPress:function(){return O(Object(V.jsx)(En,{}))},children:Object(V.jsx)(B.a,{name:"settings",size:20*R.a,color:u?d.b.gray100:d.b.gray800})})]})]}),Object(V.jsxs)(j.a,{style:{marginBottom:16*R.a,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(V.jsx)(Oe.a,{onPress:function(){return g(re()(c).subtract(1,"w").toDate())},children:Object(V.jsx)(B.a,{name:"arrow-left",size:24*R.a,color:u?d.b.gray100:d.b.gray800})}),Object(V.jsx)(M.default.View,{style:[h],children:Object(V.jsx)(H.a,{c:u?d.b.gray100:d.b.gray800,s:12*R.a,w:"m",children:y})}),Object(V.jsx)(Oe.a,{onPress:function(){return g(re()(c).add(1,"w").toDate())},children:Object(V.jsx)(B.a,{name:"arrow-right",size:24*R.a,color:u?d.b.gray100:d.b.gray800})})]}),Object(V.jsx)(j.a,{style:{marginLeft:12,flexDirection:"row",alignItems:"flex-start",justifyContent:"space-around",paddingBottom:12},children:a.slice(1,6).map((function(e,t){return Object(V.jsxs)(Oe.a,{onPress:function(){i(t+1)},style:{opacity:c?1:0,flexDirection:"column",justifyContent:"center",alignItems:"center",paddingHorizontal:12,paddingVertical:4,borderRadius:4,backgroundColor:r==t+1?d.b.accent300:u?d.b.gray700:d.b.gray200},children:[Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:r==t+1||u?d.b.gray100:d.b.gray800,children:c?re()(c).add(t,"d").format("ddd"):""}),Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:r==t+1||u?d.b.gray100:d.b.gray700,children:c?re()(c).add(t,"d").date():""},t)]},t)}))})]})},Mn=function(){var e,t=Object(f.a)().t,n=Object(b.useContext)(z.a),r=n.device,a=n.dark,c=Object(b.useState)(!1),o=u()(c,2),i=o[0],s=o[1],l=Object(b.useState)(null),d=u()(l,2),O=d[0],g=d[1],m=Object(b.useState)([]),p=u()(m,2),y=p[0],x=p[1],v=Object(b.useMemo)((function(){var e=Array.from({length:7},(function(){return[]}));return y.forEach((function(t){e[re()(t.start_time).day()].push(t)})),e}),[y]),w=Object(b.useState)("day"),k=u()(w,2),C=k[0],S=k[1],D=Object(b.useState)(!0),I=u()(D,2),L=I[0],N=I[1],B=Object(b.useState)(1),H=u()(B,2),A=H[0],F=H[1],G=Object(b.useState)(null),U=u()(G,2),Y=U[0],W=U[1],q=Object(b.useState)(!1),J=u()(q,2),X=J[0],Q=J[1],K=Object(_.a)(0),Z=Object(_.a)(0),$=Object(E.a)(((e=function(){return{opacity:Object(T.a)(Z.value,{duration:500}),transform:[{translateX:K.value}]}})._closure={withTiming:T.a,opacity:Z,offset:K},e.asString="function _f(){const{withTiming,opacity,offset}=jsThis._closure;{return{opacity:withTiming(opacity.value,{duration:500}),transform:[{translateX:offset.value}]};}}",e.__workletHash=9560942952119,e.__location="/home/runner/work/open-polito/open-polito/src/screens/Timetable.tsx (51:37)",e.__optimalization=2,e)),ee=function(e){Z.value=Object(kn.a)(Object(T.a)(0,{duration:250}),Object(T.a)(0,{duration:500}),Object(T.a)(1,{duration:250})),K.value="l"===e?Object(kn.a)(Object(T.a)(32,{duration:750}),Object(T.a)(-32,{duration:0}),Object(T.a)(0,{duration:750})):Object(kn.a)(Object(T.a)(-32,{duration:750}),Object(T.a)(32,{duration:0}),Object(T.a)(0,{duration:750}))};Object(b.useEffect)((function(){return h()((function*(){O||ee("r"),Y&&clearTimeout(Y),W(setTimeout(h()((function*(){s(!1);var e=[];x([]);try{e=yield Object(ln.getTimetable)(r,null!=O?O:new Date),s(!0)}catch(e){}finally{if(!O){var t=re()().startOf("isoWeek").toDate();L&&g(t)}x(e)}})),250))}))(),function(){clearTimeout(Y),N(!1)}}),[X]);var te=Object(b.useMemo)((function(){return"week"===C&&(null==O?void 0:O.getTime())===re()().startOf("isoWeek").toDate().getTime()||"day"===C&&re()(O).add(A-1,"days").toDate().getTime()===re()().startOf("day").toDate().getTime()}),[O,A,C]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{headerType:We.MAIN,title:t("timetable")}),Object(V.jsxs)(j.a,{style:{flex:1,paddingTop:24*R.a},children:[Object(V.jsx)(j.a,{style:{paddingHorizontal:16*R.a},children:Object(V.jsx)(Tn,{selectedDay:"week"===C?null:A,onDayChanged:function(e){F(e)},onLayoutChanged:function(e){S(e)},weekStartDate:O,onWeekStartDateChanged:function(e){O&&e.getTime()<O.getTime()?ee("l"):ee("r"),g(re()(e).startOf("isoWeek").toDate()),Q(!X)},timetableDays:v})}),Object(V.jsx)(P.a,{style:{flex:1},children:Object(V.jsxs)(M.default.View,{style:[$,{flex:1}],children:[Object(V.jsx)(vn,{showLine:te,dark:a}),Object(V.jsx)(xn,{loaded:i,timetableDays:v,layout:C,selectedDay:A})]})})]})]})},zn=function(e){var t=e.label,n=e.value,r=e.max,a=e.radius,c=e.strokeWidth,o=void 0===c?4*R.a:c,i=e.fontSize,s=e.backgroundColor,l=e.dark,u=e.children,f=2*Math.PI*a,O=Object(b.useMemo)((function(){return n<=r?n:r}),[n,r]);return Object(V.jsxs)(j.a,{style:{position:"relative"},children:[Object(V.jsxs)(jn.a,{width:2*(a+o),height:2*(a+o),children:[Object(V.jsx)(bn.Circle,{transform:"rotate(-90 "+(a+o)+" "+(a+o)+")",strokeWidth:o,fill:s||"transparent",stroke:l?d.b.gray700:d.b.gray200,r:a,cx:a+o,cy:a+o}),Object(V.jsx)(bn.Circle,{transform:"rotate(-90 "+(a+o)+" "+(a+o)+")",strokeWidth:o,fill:"transparent",stroke:d.b.accent300,strokeDasharray:f,strokeDashoffset:"number"==typeof O?(100-100*O/r)*f/100:0,r:a,cx:a+o,cy:a+o})]}),Object(V.jsxs)(j.a,{style:{position:"absolute",width:2*(a+o),height:2*(a+o),flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(V.jsx)(H.a,{s:i||(t||"string"==typeof O?10*R.a:16*R.a),c:l?d.b.gray100:d.b.gray800,w:"b",children:t||O}),u]})]})},Rn=n(960),Ln=function(e){var t=e.marks,n=e.dark,r=Object(f.a)().t,a=Object(bt.a)().width-(Object(b.useContext)(z.a).size>=L.a.lg?300:32)*R.a,c=Object(b.useMemo)((function(){return K()(t.filter((function(e){return parseInt(e.mark)&&re.a.duration(Date.now()-e.date).asDays()<=365}))).sort((function(e,t){return e.date-t.date}))}),[t]),o=Object(b.useMemo)((function(){for(var e=new Array(c.length),t=0,n=0;n<c.length;n++)0===n?(t+=c[n].num_credits,e[n]=parseInt(c[n].mark)||0):(e[n]=(e[n-1]*t+(parseInt(c[n].mark)||0)*c[n].num_credits)/(t+c[n].num_credits),t+=c[n].num_credits);return e}),[c]),i=Object(b.useMemo)((function(){return{labels:c.map((function(e){return re()(e.date).format("MMM D")})),datasets:[{data:o,color:function(){return d.b.accent300},strokeWidth:2*R.a}],legend:[r("weightedAverage")]}}),[c,o,r]);return Object(V.jsx)(j.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:0===c.length?Object(V.jsx)(H.a,{s:12,w:"m",c:n?d.b.gray200:d.b.gray700,children:"You'll see your progress when you get at least 1 permament mark."}):Object(V.jsx)(Rn.a,{data:i,width:a,height:220,yAxisInterval:1,chartConfig:{backgroundColor:"#e26a00",backgroundGradientFrom:d.b.gray900,backgroundGradientTo:d.b.gray700,decimalPlaces:2,color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(255, 255, 255, "+e+")"},labelColor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(255, 255, 255, "+e+")"},style:{borderRadius:16},propsForDots:{r:"6",strokeWidth:"2",stroke:d.b.accent300}},style:{borderRadius:4*R.a}})})},Nn=["overview","permanentMarks","provisionalMarks"],Bn=function(e){var t=e.avg,n=e.dark,r=Object(f.a)().t;return Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(V.jsx)(zn,{strokeWidth:8*R.a,radius:30*R.a,value:t,dark:n,max:30}),Object(V.jsxs)(j.a,{style:{marginLeft:16*R.a},children:[Object(V.jsxs)(H.a,{s:16*R.a,w:"m",c:n?d.b.gray100:d.b.gray800,style:{marginBottom:8*R.a},children:[r("yourAverageMark"),"*"]}),Object(V.jsxs)(H.a,{s:10*R.a,w:"r",c:n?d.b.gray300:d.b.gray600,children:["*",r("yourAverageMarkNotice")]})]})]})},Hn=function(e){var t,n=e.mark,r=e.provisional,a=e.dark,c=Object(b.useMemo)((function(){return Vn(n,r,a)}),[n,r,a]),o=Object(f.a)().t;return Object(V.jsxs)(j.a,{style:{flexDirection:"row",padding:16*R.a,borderRadius:4*R.a,backgroundColor:a?d.b.gray700:d.b.gray200,alignItems:"flex-start"},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"column",flex:1},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row"},children:[r?Object(V.jsx)(j.a,{style:{width:16*R.a,height:16*R.a,borderRadius:16*R.a,marginRight:8*R.a,backgroundColor:d.b.gray200,flexDirection:"row",alignItems:"center",justifyContent:"center"},children:Object(V.jsx)(H.a,{s:10,w:"b",c:d.b.gray900,children:n.status})}):null,Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:a?d.b.gray200:d.b.gray700,children:n.name})]}),Object(V.jsx)(j.a,{style:{flexDirection:r?"column":"row",marginTop:16*R.a},children:c})]}),parseInt(n.mark)?Object(V.jsx)(zn,{radius:20*R.a,value:parseInt(n.mark),max:30,dark:a,children:("30 e lode"===(null==(t=n.mark)?void 0:t.toLowerCase())||parseInt(n.mark)>30)&&Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(H.a,{style:{marginTop:-4*R.a},s:8*R.a,c:a?d.b.gray100:d.b.gray800,w:"b",children:"LODE"})})}):Object(V.jsxs)(j.a,{style:[{padding:8*R.a,borderRadius:4*R.a,backgroundColor:d.b.accent300},!n.mark||n.failed||n.absent?{backgroundColor:d.b.red}:null],children:[n.failed?Object(V.jsx)(H.a,{s:12,w:"m",c:d.b.gray100,children:o("examFailed")}):null,n.absent?Object(V.jsx)(H.a,{s:12,w:"m",c:d.b.gray100,children:o("examAbsent")}):null,n.mark?Object(V.jsx)(H.a,{s:12,w:"m",c:d.b.gray100,children:n.mark}):null]})]})},Vn=function(e,t,n){var r=t?["date","message"]:["date","credits"],a=[],c=[];return r.forEach((function(t){switch(t){case"date":a.push("calendar-time"),c.push(re()(e.date).format("ll"));break;case"credits":a.push("north-star"),c.push(e.num_credits+" "+Qt.b.t("credits"));break;case"message":a.push("message"),c.push(e.message||"");break;default:a.push(null),c.push("")}})),r.map((function(e,r){return Object(V.jsxs)(j.a,{style:[{flexDirection:"row",alignItems:"message"==e?"flex-start":"center",flex:1},t&&r>0?{marginTop:8*R.a}:{}],children:[null!==a[r]&&Object(V.jsx)(B.a,{name:a[r],size:16*R.a,color:n?d.b.gray200:d.b.gray700,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{style:{marginRight:8*R.a},s:10*R.a,w:"r",c:n?d.b.gray200:d.b.gray700,children:c[r]||""})]})}))},An=function(){var e=Object(f.a)().t,t=Object(b.useContext)(z.a).dark,n=Object(O.c)((function(e){return e.courses})).marks,r=Object(b.useState)(Nn[0]),a=u()(r,2),c=a[0],o=a[1],i=Object(b.useMemo)((function(){return c==Nn[1]?n.permanent:c==Nn[2]?n.provisional:[]}),[n,c]),s=Object(b.useMemo)((function(){return function(e){var t=e.filter((function(e){return!!parseInt(e.mark||"")})),n=t.reduce((function(e,t){return e+t.num_credits}),0);return parseFloat((t.reduce((function(e,t){return e+parseInt(t.mark)*t.num_credits}),0)/n).toFixed(2))}(n.permanent)}),[n]),l=Object(b.useMemo)((function(){return X.a.create({container:{paddingTop:24*R.a,flex:1},paddingHorizontal:{paddingHorizontal:16*R.a},list:{paddingHorizontal:16*R.a,paddingBottom:24*R.a}})}),[]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:e("exams"),headerType:We.MAIN}),Object(V.jsx)(nt,{dark:t,adjusted:!0,items:Nn.map((function(t){return{label:e(t),value:t}})),onChange:function(e){return o(Nn[e])}}),Object(V.jsxs)(j.a,{style:l.container,children:[c===Nn[2]?Object(V.jsx)(j.a,{style:l.paddingHorizontal,children:Object(V.jsxs)(Zt.TouchableOpacity,{onPress:h()((function*(){return yield Object(pe.a)("https://didattica.polito.it/img/RE_stati.jpg")})),style:{flexDirection:"row",alignItems:"center",marginBottom:16*R.a},children:[Object(V.jsx)(B.a,{name:"help",size:12*R.a,color:t?d.b.gray200:d.b.gray700,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{s:12,w:"m",c:t?d.b.gray200:d.b.gray700,children:e("statusCodeHelp")})]})}):null,c===Nn[0]?Object(V.jsxs)(j.a,{style:l.list,children:[Object(V.jsx)(Bn,{avg:s,dark:t}),Object(V.jsx)(j.a,{style:{height:1*R.a,backgroundColor:d.b.gray500,marginVertical:24*R.a}}),Object(V.jsx)(Ce,{title:e("progressOverTime"),dark:t,children:Object(V.jsx)(j.a,{children:Object(V.jsx)(Ln,{marks:n.permanent||[],dark:t})})})]}):Object(V.jsx)($.a,{contentContainerStyle:l.list,data:i,keyExtractor:function(e){return e.date+e.name},renderItem:function(e){var n=e.item;return Object(V.jsx)(Hn,{mark:(Nn[1],n),provisional:c==Nn[2],dark:t})},ItemSeparatorComponent:function(){return Object(V.jsx)(j.a,{style:{height:16*R.a}})},ListEmptyComponent:Object(V.jsx)(te,{})})]})]})},Fn=n(139),Gn=n(124),Un=n(115),Yn=function(e){var t=e.examSession,n=Object(b.useContext)(z.a).device;return Object(V.jsx)(F,{title:Object(Qt.c)("confirmExamBooking"),onConfirm:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};h()((function*(){var r=!1;try{yield Object(Gn.bookExamSession)(e,t.session_id,t.course_id),r=!0}catch(e){console.log(e)}finally{Un.a.dispatch(Object(Qe.g)({visible:!0,message:Qt.b.t(r?"examsExamBookedToastMessage":"examsExamBookingErrorToastMessage"),type:r?"success":"err"})),n()}}))()}(n,t)},children:Object(V.jsx)(U.RenderHTMLSource,{source:{html:Object(Qt.c)("confirmExamBookingDialogMessage",{code:t.course_id,name:t.exam_name,date:re()(t.date).format("lll"),rooms:t.rooms})}})})},Wn=function(e){var t=e.examSession,n=Object(b.useContext)(z.a).device;return Object(V.jsx)(F,{title:Object(Qt.c)("cancelExamBooking"),accentColor:d.b.red,icon:"alert-triangle",onConfirm:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};h()((function*(){var r=!1;try{yield Object(Gn.cancelExamSession)(e,t.session_id,t.course_id),r=!0}catch(e){console.log(e)}finally{Un.a.dispatch(Object(Qe.g)({visible:!0,message:Qt.b.t(r?"examsExamCanceledToastMessage":"examsExamCancelingErrorToastMessage"),type:r?"success":"err"})),n()}}))()}(n,t)},children:Object(V.jsx)(U.RenderHTMLSource,{source:{html:Object(Qt.c)("cancelExamBookingDialogMessage",{code:t.course_id,name:t.exam_name,date:re()(t.date).format("lll"),rooms:t.rooms})}})})},qn=n(84),Jn=function(e){return e.user_is_signed_up},Xn=function(e){return!e.user_is_signed_up&&0===e.error.id},Qn=["allExams","myBookings","availableToBook","unavailableExams"];function Kn(){var e=Object(f.a)().t,t=Object(O.b)(),n=Object(b.useContext)(z.a),r=n.dark,a=n.device,c=Object(b.useContext)(S.a).setModal,o=Object(O.c)((function(e){return e.exams})),i=o.exams,s=o.getExamsStatus,l=Object(b.useState)(Qn[0]),m=u()(l,2),p=m[0],y=m[1],x=Object(b.useState)("en"),v=u()(x,2),w=v[0],k=v[1];Object(b.useEffect)((function(){s.code!==g.b.IDLE&&s.code!==g.b.ERROR||t(Object(Fn.b)(a)),h()((function*(){switch(Object(qn.a)()){case"en":k("en");break;case"it":k("it");break;default:k("en")}}))()}),[a,t,s.code]);var C=Object(b.useMemo)((function(){s.code!==g.b.PENDING&&t(Object(Fn.b)(a))}),[s,a,t]),D=Object(b.useMemo)((function(){switch(p){case Qn[0]:return i;case Qn[1]:return i.filter((function(e){return Jn(e)}));case Qn[2]:return i.filter((function(e){return Xn(e)}));case Qn[3]:return i.filter((function(e){return!(t=e).user_is_signed_up&&0!==t.error.id;var t}));default:return[]}}),[p,i]),P=function(t){return Object(V.jsxs)(j.a,{style:{flexDirection:"row"},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"column",flex:1,padding:16*R.a,paddingRight:8*R.a,paddingBottom:8*R.a,borderTopLeftRadius:4*R.a,borderBottomLeftRadius:4*R.a,backgroundColor:r?d.b.gray700:d.b.gray200},children:[Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(V.jsx)(B.a,{name:t.user_is_signed_up?"circle-check":0===t.error.id?"circle":"circle-off",color:t.user_is_signed_up?d.b.green:0===t.error.id?d.b.accent200:d.b.red,size:24*R.a,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:r?d.b.gray200:d.b.gray700,children:t.exam_name})]}),Object(V.jsx)(j.a,{style:{flexDirection:"column",marginTop:16*R.a},children:["course","date","deadline","rooms"].map((function(n){return c=t,o="date"===(a=n)?"calendar-time":"course"===a?"grid-pattern":"type"===a?"writing":"deadline"===a?"alert-triangle":"rooms"===a?"map-pin":"user-circle",i="date"===a?re()(c.date).format("lll")+" ("+re()(c.date).fromNow()+")":"course"===a?c.course_id:"type"===a?c.type:"deadline"===a?e("bookingDeadline")+": "+re()(c.signup_deadline).format("lll")+" ("+re()(c.signup_deadline).fromNow()+")":"rooms"===a?c.rooms.join(", "):"(coming soon)",Object(V.jsxs)(j.a,{style:{flexDirection:"row",alignItems:"center",marginBottom:8*R.a},children:[Object(V.jsx)(B.a,{name:o,size:16*R.a,color:r?d.b.gray200:d.b.gray700,style:{marginRight:8*R.a}}),Object(V.jsx)(H.a,{numberOfLines:1,style:{marginRight:8*R.a},s:10*R.a,w:"r",c:r?d.b.gray200:d.b.gray700,children:i})]});var a,c,o,i}))}),0===t.error.id||""===t.error.eng&&""===t.error.ita?null:Object(V.jsx)(H.a,{s:10*R.a,w:"r",c:d.b.red,style:{marginVertical:8*R.a},children:"it"===w?t.error.ita:t.error.eng})]}),Object(V.jsx)(j.a,{style:{flexDirection:"column",justifyContent:"center",borderTopRightRadius:4*R.a,borderBottomRightRadius:4*R.a,backgroundColor:r?d.b.gray600:d.b.gray300},children:Xn(t)||Jn(t)?Object(V.jsx)(I.a,{onPress:function(){return c(Xn(t)?Object(V.jsx)(Yn,{examSession:t}):Object(V.jsx)(Wn,{examSession:t}))},children:Object(V.jsxs)(j.a,{style:{flexDirection:"column",alignItems:"center",padding:8*R.a},children:[Object(V.jsx)(j.a,{style:{marginBottom:4*R.a},children:Object(V.jsx)(B.a,{name:Xn(t)?"circle-plus":"circle-x",color:Xn(t)?d.b.accent300:d.b.red,size:20*R.a})}),Object(V.jsx)(H.a,{s:10*R.a,w:"m",c:Xn(t)?d.b.accent300:d.b.red,children:e(Xn(t)?"bookVerb":"cancel")})]})}):null})]})};return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:e("examSessions"),headerType:We.MAIN}),Object(V.jsx)(nt,{dark:r,adjusted:!0,items:Qn.map((function(t){return{label:e(t),value:t}})),onChange:function(e){return y(Qn[e])}}),Object(V.jsx)($.a,{contentContainerStyle:{paddingTop:24*R.a,paddingHorizontal:16*R.a,paddingBottom:24*R.a},data:D,keyExtractor:function(e){return e.session_id+e.course_id+e.date},renderItem:function(e){var t=e.item;return P(t)},ItemSeparatorComponent:function(){return Object(V.jsx)(j.a,{style:{height:16*R.a}})},ListEmptyComponent:Object(V.jsx)(te,{}),refreshing:s.code==g.b.PENDING,refreshControl:Object(V.jsx)(J.a,{refreshing:s.code==g.b.PENDING,onRefresh:C})})]})}var Zn=function(){return Object(V.jsx)(j.a,{})},$n=function(){return Object(V.jsx)(j.a,{})},er=function(){return Object(V.jsx)(j.a,{})};function tr(e){var t=e.navigation,n=Object(f.a)().t,r=Object(b.useContext)(z.a).dark,a=Object(O.c)((function(e){return e.courses.courses})),c=Object(b.useCallback)((function(e){t.navigate("Course",{courseCode:e.basicInfo.code+e.basicInfo.name})}),[t]),o=Object(b.useMemo)((function(){return X.a.create({container:{marginTop:24*R.a,paddingHorizontal:16*R.a,paddingBottom:16*R.a}})}),[]);return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)($e,{title:n("courses"),headerType:We.MAIN}),Object(V.jsx)(P.a,{children:Object(V.jsxs)(j.a,{style:o.container,children:[a.filter((function(e){return e.isMain})).map((function(e){return Object(V.jsx)(tn,{dark:r,onPress:function(){return c(e)},title:e.basicInfo.name},e.basicInfo.code+e.basicInfo.name)})),a.filter((function(e){return!e.isMain})).length>0?Object(V.jsx)(Ce,{dark:r,title:n("otherCourses"),style:{marginTop:8},children:a.filter((function(e){return!e.isMain})).map((function(e){return Object(V.jsx)(tn,{dark:r,onPress:function(){return c(e)},title:e.basicInfo.name},e.basicInfo.code+e.basicInfo.name)}))}):null]})})]})}var nr=n(289),rr=function(e){var t,n=e.selected,r=e.onChange,a=Object(_.a)(1),c=Object(E.a)(((t=function(){return{width:20*R.a*a.value,height:20*R.a*a.value,borderRadius:4*R.a,backgroundColor:d.b.accent300,alignItems:"center",justifyContent:"center"}})._closure={p:R.a,offset:a,colors:{accent300:d.b.accent300}},t.asString="function _f(){const{p,offset,colors}=jsThis._closure;{return{width:20*p*offset.value,height:20*p*offset.value,borderRadius:4*p,backgroundColor:colors.accent300,alignItems:'center',justifyContent:'center'};}}",t.__workletHash=0xf364d967be,t.__location="/home/runner/work/open-polito/open-polito/src/ui/core/Checkbox.tsx (21:37)",t.__optimalization=3,t));return Object(b.useEffect)((function(){a.value=n?Object(T.a)(1,{duration:100}):Object(T.a)(0,{duration:100})}),[n]),Object(V.jsx)(ce.a,{style:{padding:4*R.a},onPress:function(){r(!n)},children:Object(V.jsx)(j.a,{style:{width:20*R.a,height:20*R.a,backgroundColor:d.b.gray700,borderColor:d.b.gray600,borderWidth:1*R.a,borderRadius:4*R.a,alignItems:"center",justifyContent:"center"},children:Object(V.jsx)(M.default.View,{style:[c],children:Object(V.jsx)(B.a,{name:"check",size:12*R.a,color:d.b.gray50})})})})};function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var cr=function(e){var t,n=e.dark,r=e.n,a=e.handlePress,c=e.courseName,o=e.selecting,i=e.setSelecting,s=e.selected,l=e.onSelectionChange,u=Object(_.a)(0),d=Object(E.a)(((t=function(){return{width:32*R.a*u.value,transform:[{scale:u.value}],alignItems:"flex-start"}})._closure={p:R.a,offset:u},t.asString="function _f(){const{p,offset}=jsThis._closure;{return{width:32*p*offset.value,transform:[{scale:offset.value}],alignItems:'flex-start'};}}",t.__workletHash=0xdf564b7d8b3,t.__location="/home/runner/work/open-polito/open-polito/src/screens/Notifications.tsx (72:45)",t.__optimalization=3,t));return Object(b.useEffect)((function(){u.value=Object(T.a)(o?1:0,{duration:150})}),[o]),Object(V.jsx)(j.a,{style:{flex:1},children:Object(V.jsx)(Zt.LongPressGestureHandler,{onHandlerStateChange:function(e){e.nativeEvent.state===Zt.State.ACTIVE&&(o||(i(!0),l(r.id,!0)))},children:Object(V.jsxs)(M.default.View,{style:{marginBottom:24*R.a,flexDirection:"row",alignItems:"center"},children:[Object(V.jsx)(M.default.View,{style:[d],children:Object(V.jsx)(rr,{selected:s,onChange:function(e){return l(r.id,e)}})}),Object(V.jsx)(ce.a,{style:{flex:1},onPress:function(){return a(r.id)},children:Object(V.jsx)(Re,{type:r.topic,notification:r,dark:n,read:r.is_read,courseName:c})})]})})})},or=function(){var e=Object(f.a)().t,t=Object(O.b)(),n=[{label:e("allF"),value:"all"},{label:e("readF"),value:"read"},{label:e("unreadF"),value:"unread"},{label:e("directAlerts"),value:"direct"},{label:e("courses"),value:"course"},{label:e("material"),value:"material"}],r=Object(b.useMemo)((function(){return X.a.create({container:{paddingTop:24*R.a,flex:1},paddingHorizontal:{paddingHorizontal:16*R.a},list:{paddingHorizontal:16*R.a,paddingBottom:24*R.a}})}),[]),a=Object(O.c)((function(e){return e.user})),c=a.notifications,o=a.getNotificationsStatus,i=Object(O.c)((function(e){return e.courses})),l=Object(b.useContext)(z.a),m=l.device,p=l.dark,y=Object(b.useState)("all"),x=u()(y,2),v=x[0],w=x[1],k=Object(b.useState)(!1),C=u()(k,2),S=C[0],D=C[1],P=function(){D(!0),t(Object(wt.d)(m))};Object(b.useEffect)((function(){S&&o.code!==g.b.PENDING&&D(!1)}),[c,S,o.code,i]);var I,L=function(e){var t=c.findIndex((function(t){return t.id==e}));if(-1!==t&&!c[t].is_read){h()((function*(){yield Object(Ee.markNotificationRead)(m,e)}))();var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},c[t]);n.is_read=!0,Un.a.dispatch(Object(wt.f)([].concat(K()(c.slice(0,t)),[n],K()(c.slice(t+1)))))}},N=Object(b.useMemo)((function(){switch(v){case"all":return c;case"read":return c.filter((function(e){return e.is_read}));case"unread":return c.filter((function(e){return!e.is_read}));case"direct":return c.filter((function(e){return e.topic===Ee.NotificationType.DIRECT}));case"course":return c.filter((function(e){return e.topic===Ee.NotificationType.NOTICE}));case"material":return c.filter((function(e){return e.topic===Ee.NotificationType.MATERIAL}));default:return[]}}),[c,v]),A=Object(b.useState)(!1),F=u()(A,2),G=F[0],U=F[1],Y=Object(b.useState)([]),W=u()(Y,2),q=W[0],Q=W[1],Z=Object(_.a)(1),ee=Object(E.a)(((I=function(){return{transform:[{scale:.75+.25*Z.value},{translateY:128*R.a*(1-Z.value)}]}})._closure={tabOffset:Z,p:R.a},I.asString="function _f(){const{tabOffset,p}=jsThis._closure;{return{transform:[{scale:0.75+0.25*tabOffset.value},{translateY:128*p*(1-tabOffset.value)}]};}}",I.__workletHash=4306454263167,I.__location="/home/runner/work/open-polito/open-polito/src/screens/Notifications.tsx (251:37)",I.__optimalization=3,I));Object(b.useEffect)((function(){Z.value=Object(T.a)(G?1:0,{duration:200})}),[G]),Object(b.useEffect)((function(){G||Q([])}),[G]);Object(b.useEffect)((function(){0===q.length&&U(!1)}),[q]);var ne=Object(b.useCallback)((function(){return G?(U(!1),!0):(Q([]),!1)}),[G]);Object(b.useEffect)((function(){Q([]),U(!1)}),[v]),Object(b.useEffect)((function(){return nr.a.addEventListener("hardwareBackPress",ne),function(){U(!1),Q([]),nr.a.removeEventListener("hardwareBackPress",ne)}}),[]);var re=Object(b.useState)(!1),ae=u()(re,2),oe=ae[0],ie=ae[1],se=function(){for(var e=!0,t=0;t<N.length;t++)if(!q.includes(N[t].id)){e=!1;break}return e},ue=[{icon:se()?"circle-minus":"circle-plus",value:"selectAll",label:se()?e("deselectAll"):e("selectAll"),action:function(){return se()?Q([]):Q(N.map((function(e){return e.id})))}},{icon:oe?"loading":"trash",value:"delete",label:e("delete"),action:function(){h()((function*(){ie(!0);for(var e=0;e<q.length;e++)yield Object(Ee.deleteNotification)(m,q[e]);setTimeout((function(){ie(!1),U(!1)}),500),P()}))()}},{icon:"checks",value:"markAsRead",label:e("markAsRead"),action:function(){q.forEach((function(e){return L(e)})),U(!1)}}];return Object(V.jsxs)(Ge.a,{children:[Object(V.jsx)(M.default.View,{style:[ee,{position:"absolute",bottom:16*R.a,left:0,right:0,zIndex:1e3,backgroundColor:p?d.b.gray700:d.b.gray200,paddingVertical:8*R.a,marginHorizontal:16*R.a,borderRadius:16*R.a,borderWidth:1*R.a,borderColor:p?d.b.gray600:d.b.gray300,flexDirection:"row",justifyContent:"center",alignItems:"center"}],children:ue.map((function(e){return Object(V.jsx)(j.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(V.jsxs)(ce.a,{disabled:"loading"===e.icon,style:{justifyContent:"center",alignItems:"center"},onPress:e.action,children:["loading"===e.icon?Object(V.jsx)(le.a,{color:d.b.accent300,size:20*R.a}):Object(V.jsx)(B.a,{name:e.icon,color:d.b.accent300,size:20*R.a}),Object(V.jsx)(j.a,{style:{height:4*R.a}}),Object(V.jsx)(H.a,{c:d.b.accent300,w:"r",s:10*R.a,children:e.label})]})})}))}),Object(V.jsx)($e,{headerType:We.MAIN,title:e("notifications")}),Object(V.jsx)(nt,{adjusted:!0,dark:p,items:n,onChange:function(e){return w(n[e].value)}}),Object(V.jsx)(j.a,{style:r.container,children:Object(V.jsx)($.a,{contentContainerStyle:r.paddingHorizontal,data:N,keyExtractor:function(e){return e.id.toString()},ListEmptyComponent:Object(V.jsx)(te,{}),refreshControl:Object(V.jsx)(J.a,{refreshing:S,onRefresh:P}),initialNumToRender:10,maxToRenderPerBatch:10,renderItem:function(e){return Object(V.jsx)(cr,{dark:p,n:e.item,handlePress:function(e){return L(e)},courseName:(t=e.item,(null==(n=i.courses.find((function(e){return e.basicInfo.id_incarico===t.course})))?void 0:n.basicInfo.name)||""),selecting:G,setSelecting:function(e){return U(e)},selected:q.includes(e.item.id),onSelectionChange:function(e,t){return function(e,t){Q(t?[].concat(K()(q),[e]):q.filter((function(t){return t!==e})))}(e,t)}});var t,n}})})]})};function ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var sr=Object(Ht.a)();function lr(){var e=Object(O.b)(),t=Object(b.useContext)(z.a),n=t.dark,r=t.device,a=t.size,c=Object(O.c)((function(e){return e.user})).getNotificationsStatus,o=Object(O.c)((function(e){return e.session})).loginStatus,i=Object(O.c)((function(e){return e.courses})),l=i.courses,u=i.getRecentMaterialStatus,j=i.loadCoursesStatus;Object(b.useEffect)((function(){o.code===g.b.IDLE&&e(Object(Qe.b)({method:"token",device:r}))}),[o,r,e]),Object(b.useEffect)((function(){c.code===g.b.IDLE&&o.code===g.b.SUCCESS&&e(Object(wt.d)(r))}),[c,o]),Object(b.useEffect)((function(){o.code===g.b.SUCCESS&&(e(Object(Fe.d)(r)),e(Object(wt.e)(r)),h()((function*(){if("android"===p.a.OS&&"debug"!==y.a.VARIANT){var e=yield Bt.a.NotificationModule.getToken();yield Object(Ee.registerPushNotifications)(r,e)}}))())}),[o]),Object(b.useEffect)((function(){h()((function*(){j.code===g.b.SUCCESS&&(e(Object(Fe.e)(Object(g.e)())),l.forEach((function(t){t.status.code===g.b.IDLE&&e(Object(Fe.c)({basicCourseInfo:t.basicInfo,device:r}))})))}))()}),[j]),Object(b.useEffect)((function(){if(u.code===g.b.IDLE&&j.code===g.b.SUCCESS){var t=!0;l.forEach((function(e){e.status.code!==g.b.SUCCESS&&(t=!1)})),t&&(e(Object(Fe.e)(Object(g.g)())),e(Object(Fe.b)()))}}),[l,u]);var d=Object(b.useCallback)((function(e){return Object(V.jsx)(Xt,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({dark:n},e))}),[n]);return Object(V.jsxs)(sr.Navigator,{screenOptions:{headerShown:!1,drawerType:a>=L.a.lg?"permanent":"front"},useLegacyImplementation:!0,drawerContent:function(e){return d(e)},children:[Object(V.jsx)(sr.Screen,{name:"Home",component:xt}),Object(V.jsx)(sr.Screen,{name:"Email",component:St}),Object(V.jsx)(sr.Screen,{name:"Notifications",component:or}),Object(V.jsx)(sr.Screen,{name:"Settings",component:Rt}),Object(V.jsx)(sr.Screen,{name:"Courses",component:tr}),Object(V.jsx)(sr.Screen,{name:"Material",component:Nt}),Object(V.jsx)(sr.Screen,{name:"Bookings",component:sn}),Object(V.jsx)(sr.Screen,{name:"Timetable",component:Mn}),Object(V.jsx)(sr.Screen,{name:"Exams",component:An}),Object(V.jsx)(sr.Screen,{name:"ExamSessions",component:Kn}),Object(V.jsx)(sr.Screen,{name:"Maps",component:Zn}),Object(V.jsx)(sr.Screen,{name:"Classrooms",component:$n}),Object(V.jsx)(sr.Screen,{name:"People",component:er})]})}var ur=Object(q.a)(),br=function(){return Object(V.jsx)(W.a,{children:Object(V.jsxs)(ur.Navigator,{screenOptions:{headerShown:!1},children:[Object(V.jsx)(ur.Screen,{name:"HomeRouter",component:lr}),Object(V.jsx)(ur.Screen,{name:"Search",component:ut}),Object(V.jsx)(ur.Screen,{name:"Course",component:ct}),Object(V.jsx)(ur.Screen,{name:"Video",component:gt})]})})},jr=n(656);function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Or(){var e=Object(f.a)().t,t=Object(b.useContext)(S.a).setModal,n=Object(b.useContext)(z.a).dark;Object(b.useEffect)((function(){Object(qn.d)(Object(qn.a)())}),[]);var r=Object(b.useState)({checked:!1,acceptedUpdate:!1}),a=u()(r,2),c=a[0],o=a[1];Object(b.useEffect)((function(){c.checked||k().then((function(e){return o((function(t){return fr(fr({},t),{},{releaseData:e,checked:!0})}))})),C()}),[c.checked]),Object(b.useEffect)((function(){if(c.releaseData){var r=Object(G.getLocales)()[0].languageCode,a=c.releaseData.notes.find((function(e){return e.language===r}));t(Object(V.jsxs)(F,{title:e("newUpdateModalTitle"),icon:"download",accentColor:"#2dba2a",onConfirm:function(){return o((function(e){return fr(fr({},e),{},{acceptedUpdate:!0})}))},children:[Object(V.jsx)(H.a,{s:12*R.a,w:"m",c:n?d.b.gray100:d.b.gray800,children:e("newUpdateModalText")+"\n\n"+e("newUpdateModalNotes")+"\n"}),"text"===c.releaseData.format?((null==a?void 0:a.content)||[]).map((function(e){return Object(V.jsx)(H.a,{s:12*R.a,w:"r",c:n?d.b.gray100:d.b.gray800,children:"  • "+e})})):((null==a?void 0:a.content)||[]).map((function(e){return Object(V.jsx)(U.RenderHTMLSource,{source:{html:e}})}))]}))}}),[c.releaseData,n,t,e]);var i=Object(O.c)((function(e){return e.session})).authStatus,s=Object(O.c)((function(e){return e.session.config})).logging,l=Object(b.useState)(null),m=u()(l,2),h=m[0],p=m[1];Object(b.useEffect)((function(){p(s?y({text:e("Logging enabled"),type:"warn"}):null)}),[s,e]);var y=function(e){var t=e.text,n=void 0===t?"":t,r=e.type,a=void 0===r?"warn":r;return Object(V.jsx)(j.a,{style:{backgroundColor:"warn"==a?d.b.orange:d.b.black,paddingVertical:4,flexDirection:"row",justifyContent:"center"},children:Object(V.jsx)(H.a,{s:10*R.a,w:"m",c:d.b.white,children:n})})},x=Object(b.useMemo)((function(){return Object(V.jsxs)(V.Fragment,{children:[h,c.acceptedUpdate?Object(V.jsx)(Y,{releaseData:c.releaseData}):i!==g.a.NOT_VALID?Object(V.jsx)(br,{}):null]})}),[i,h,c]);return"web"===Xe.a?Object(V.jsx)(jr.default,{children:x}):x}}}]);
//# sourceMappingURL=5.c0bcc230.chunk.js.map