(this.webpackJsonp=this.webpackJsonp||[]).push([[4,5,6],{433:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(10),a=n.n(r),c=n(19),o=n.n(c),i=n(1),s=n.n(i),l=n(2),u=n.n(l),b=n(5),d=n.n(b),j=n(90),f=n(662),O=n(177),g=n(474),m=n(129);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){function e(){s()(this,e)}var t,n,r,a;return u()(e,null,[{key:"writeToFile",value:(a=o()((function*(t){yield Object(m.a)(e.logFilePath,JSON.stringify(t)+"\n").catch((function(e){return console.log(e)}))})),function(e){return a.apply(this,arguments)})},{key:"logBasicDeviceInfo",value:(r=o()((function*(){if(!e.hasLoggedBasicDeviceInfo){var t={type:"DEVICE_INFO",appBuildNumber:f.a.getBuildNumber(),appBuildVariant:j.a.VARIANT||"",appVersion:g.version,appVersionBinary:f.a.getVersion(),osApiLevel:f.a.getApiLevelSync(),osName:f.a.getSystemName()||f.a.getBaseOsSync(),osVersion:f.a.getSystemVersion(),theme:O.a.getState().session.config.theme};yield e.writeToFile(t),e.hasLoggedBasicDeviceInfo=!0}})),function(){return r.apply(this,arguments)})},{key:"logRequest",value:(n=o()((function*(t){yield e.logBasicDeviceInfo(),parseInt(j.a.ENABLE_DEBUG_OPTIONS,10)&&(t.endpoint.includes("login")||(yield e.writeToFile(p({type:"REQUEST"},t))))})),function(e){return n.apply(this,arguments)})},{key:"logRequestSync",value:function(t){o()((function*(){yield e.logBasicDeviceInfo(),yield e.logRequest(t)}))()}},{key:"logError",value:(t=o()((function*(t){yield e.logBasicDeviceInfo(),yield e.writeToFile(p({type:"ERROR"},t))})),function(e){return t.apply(this,arguments)})}]),e}();y.logsDirectoryPath=Object(m.d)(),y.logFilePath=y.logsDirectoryPath+"/request_log-"+d()().format("YYYY-MM-DD-THHmmssSSS")+".txt",y.hasLoggedBasicDeviceInfo=!1},474:function(e){e.exports=JSON.parse('{"version":"0.6.1","versionCode":5,"from":"GITHUB"}')},661:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(466),c=n(13),o=n(14),i=n(71),s=n(7);t.default=function(e){var t=e.children,n=Object(r.useContext)(i.a).dark,l=Object(r.useMemo)((function(){return n?c.b.gray200:void 0}),[n]),u=Object(r.useMemo)((function(){return{p:{marginVertical:4*o.a,color:l}}}),[l]);return Object(s.jsx)(a.TRenderEngineProvider,{tagsStyles:u,children:Object(s.jsx)(a.RenderHTMLConfigProvider,{children:t})})}},957:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return xr}));var r,a,c,o,i=n(19),s=n.n(i),l=n(10),u=n.n(l),b=n(6),d=n.n(b),j=n(0),f=n(15),O=n(11),g=n(13),m=n(441),h=n(58),p=n(12),y=n(90),x=n(474),v=n(46),w=(r=s()((function*(){return 200===(yield fetch("https://api.github.com")).status})),function(){return r.apply(this,arguments)}),k=(a=s()((function*(){return yield(yield fetch("https://raw.githubusercontent.com/open-polito/open-polito/master/release.json")).json()})),function(){return a.apply(this,arguments)}),C=(c=s()((function*(e){return yield(yield fetch("https://api.github.com/repos/open-polito/open-polito/releases/tags/"+e,{headers:{Accept:"application/vnd.github+json"}})).json()})),o=s()((function*(){if("android"===f.a.OS&&!["PLAY_STORE"].includes(x.from)||"desktop"===v.a){if(!(yield w()))return;try{return(yield k()).find((function(e){return(void 0===y.a.VARIANT||e.type===y.a.VARIANT)&&e.versionCode>x.versionCode}))}catch(e){}}})),function(){return o.apply(this,arguments)}),S=function(){var e=s()((function*(){}));return function(){return e.apply(this,arguments)}}(),D=(function(){var e=s()((function*(){}))}(),function(){var e=s()((function*(){}))}(),n(119)),P=n(551),I=n(105),_=n(170),E=n(54),T=n(110),M=n(89),R=n(166),z=n(71),L=n(14),N=n(79),B=n(156),H=n(84),V=n(50),A=n(7),F=function(e){var t,n=e.title,r=e.actions,a=e.dismissable,c=void 0===a||a,o=e.onDismiss,i=void 0===o?function(){}:o,s=e.children,l=e.icon,u=e.accentColor,b=Object(j.useContext)(z.a),f=b.dark,m=b.size,h=Object(j.useContext)(D.a),p=h.visible,y=h.hideModal,x=Object(j.useState)(!0),v=d()(x,2),w=v[0],k=v[1],C=Object(j.useCallback)((function(){c&&(setTimeout((function(){return k(!1)}),200),y(),i())}),[y,c,i]),S=Object(E.a)(0),F=Object(T.a)(((t=function(){return{backgroundColor:"rgba(0, 0, 0, "+S.value/2+")",opacity:S.value,transform:[{scale:1.1-.1*S.value}]}})._closure={offset:S},t.asString='function _f(){const{offset}=jsThis._closure;{return{backgroundColor:"rgba(0, 0, 0, "+offset.value/2+")",opacity:offset.value,transform:[{scale:1.1-0.1*offset.value}]};}}',t.__workletHash=0xef79486089b,t.__location="/home/runner/work/open-polito/open-polito/src/components/modals/ModalBase.tsx (66:37)",t.__optimalization=3,t));return Object(j.useEffect)((function(){S.value=Object(M.a)(p?1:0,{duration:200})}),[p,S]),Object(A.jsx)(P.a,{transparent:!0,visible:w,animationType:"none",statusBarTranslucent:!0,onRequestClose:C,children:Object(A.jsx)(R.default.View,{style:[F,{flex:1}],children:Object(A.jsx)(_.a,{activeOpacity:1,onPress:C,style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(A.jsxs)(_.a,{activeOpacity:1,style:[{width:m>=N.a.lg?"50%":"90%",maxHeight:"80%",backgroundColor:f?g.b.gray700:g.b.gray200,borderRadius:4*L.a,marginHorizontal:16*L.a}],children:[Object(A.jsx)(I.a,{children:Object(A.jsxs)(O.a,{style:{paddingVertical:24*L.a,paddingHorizontal:16*L.a},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[l&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(H.a,{name:l,color:u,size:24*L.a}),Object(A.jsx)(O.a,{style:{width:16*L.a}})]}),Object(A.jsx)(V.a,{s:16,w:"m",c:f?g.b.gray100:g.b.gray800,children:n})]}),Object(A.jsx)(O.a,{style:{marginTop:16*L.a},children:s})]})}),r&&Object(A.jsx)(O.a,{style:{flexDirection:"row",paddingBottom:24*L.a,paddingHorizontal:16*L.a},children:r.map((function(e,t){return Object(A.jsx)(O.a,{style:[{flex:1},0!==t?{marginLeft:32*L.a}:{}],children:Object(A.jsx)(B.a,{color:"colored"===e.type?u:g.b.accent300,secondary:"secondary"===e.type,text:e.label,onPress:function(){e.onSelect(e.value).then((function(){e.dismiss&&C()}))}})},e.value)}))})]})})})})},U=function(e){var t=e.title,n=e.children,r=e.onConfirm,a=void 0===r?function(){}:r,c=e.onCancel,o=void 0===c?function(){}:c,i=e.icon,l=e.accentColor,u=e.customLabels,b=Object(j.useContext)(D.a).hideModal,d=Object(m.a)().t,f=Object(j.useMemo)((function(){return[{type:"secondary",label:u?u.cancel:d("cancel"),value:"cancel",onSelect:(t=s()((function*(){o(),b()})),function(){return t.apply(this,arguments)}),dismiss:!0},{type:"colored",label:u?u.confirm:d("confirm"),value:"confirm",onSelect:(e=s()((function*(){a(),b()})),function(){return e.apply(this,arguments)}),dismiss:!0}];var e,t}),[b,o,a,d,u]);return Object(A.jsx)(F,{icon:i,accentColor:l,title:t,actions:f,children:n})},G=n(109),Y=n(466),W=function(){return Object(A.jsx)("div",{children:"Updater for web not implemented yet"})},q=n(956),J=n(959),X=n(173),Q=n(17),K=n(41),Z=n.n(K),$=n(469),ee=n(168),te=function(e){var t=e.items,n=e.onChange,r=Object(j.useState)(t&&t.length>0?t[0].value:""),a=d()(r,2),c=a[0],o=a[1];return Object(A.jsx)(O.a,{style:{flexDirection:"row"},children:t.map((function(e){return Object(A.jsx)(O.a,{children:Object(A.jsx)(_.a,{onPress:function(){n(e.value),o(e.value)},children:Object(A.jsx)(O.a,{style:{paddingHorizontal:8*L.a,paddingVertical:4*L.a,borderWidth:1*L.a,borderRadius:16*L.a,borderColor:e.value===c?g.b.accent300:g.b.gray200,marginRight:8*L.a},children:Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:e.value===c?g.b.accent300:g.b.gray200,children:e.label})})})})}))})};function ne(){var e=Object(m.a)().t,t=Object(j.useContext)(z.a).dark;return Object(A.jsx)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"center"},children:Object(A.jsx)(V.a,{s:12,w:"m",c:t?g.b.gray200:g.b.gray700,children:e("noContent")})})}var re=n(5),ae=n.n(re),ce=n(169),oe=n(118),ie=function(e){var t,n=e.item,r=e.onPress,a=e.dark,c=Object(j.useState)(0),o=d()(c,2),i=o[0],s=o[1],l=Object(j.useMemo)((function(){return n.length/60}),[n.length]),u=Object(j.useMemo)((function(){var e=Math.ceil(60*(l-Math.floor(l))).toString();return 1===e.length&&(e="0"+e),e}),[l]),b=Object(T.a)(((t=function(){return{opacity:Object(M.a)(0===i?0:1,{duration:200})}})._closure={withTiming:M.a,width:i},t.asString="function _f(){const{withTiming,width}=jsThis._closure;{return{opacity:withTiming(width===0?0:1,{duration:200})};}}",t.__workletHash=4868393672747,t.__location="/home/runner/work/open-polito/open-polito/src/ui/VideoCard.tsx (36:37)",t.__optimalization=2,t)),f=Math.floor(l)+":"+u+":00";return Object(A.jsx)(R.default.View,{style:[b],children:Object(A.jsxs)(oe.a,{onLayout:function(e){return s(e.nativeEvent.layout.width)},onPress:r,android_ripple:{color:g.b.lightGray},style:[{flexDirection:"row",justifyContent:"space-between",paddingVertical:12*L.a,paddingHorizontal:16*L.a}],children:[Object(A.jsxs)(O.a,{style:{width:.4*i,height:.23*i},children:[Object(A.jsx)(ce.a,{source:{uri:0!==n.cover_url.length?n.cover_url:void 0},style:{width:"100%",height:"100%",backgroundColor:"#000"},resizeMode:"contain"}),Object(A.jsx)(O.a,{style:{position:"absolute",right:0,bottom:0,padding:4*L.a,backgroundColor:"#000"},children:Object(A.jsx)(V.a,{s:10*L.a,w:"m",c:g.b.gray100,children:f})})]}),Object(A.jsx)(O.a,{style:{marginLeft:16*L.a,flex:1,flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start"},children:Object(A.jsxs)(O.a,{children:[Object(A.jsx)(V.a,{w:"m",s:12*L.a,c:a?g.b.gray100:g.b.gray800,numberOfLines:2,children:n.title}),Object(A.jsx)(V.a,{w:"r",s:10*L.a,c:a?g.b.gray200:g.b.gray700,numberOfLines:1,style:{marginVertical:8*L.a},children:ae()(n.date).format("ll")})]})})]},n.date+n.title)})},se=function(e){var t,n=e.courseData,r=e.onYearChange;return Object(A.jsxs)(O.a,{style:{marginLeft:16*L.a},children:[Object(A.jsx)(O.a,{style:{height:16*L.a}}),Object(A.jsx)(te,{items:Object.keys((null==n||null==(t=n.extendedInfo)?void 0:t.vc_recordings)||{}).sort((function(e,t){return e<t?1:-1})).map((function(e){return{label:e,value:e}})),onChange:function(e){return r(e)}}),Object(A.jsx)(O.a,{style:{height:8*L.a}})]})},le=function(e){var t=e.courseId,n=e.dark,r=e.refreshControl,a=(Object(m.a)().t,Object($.p)()),c=Object(j.useState)("current"),o=d()(c,2),i=o[0],s=o[1],l=Object(h.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name==t}))})),u=Object(j.useMemo)((function(){var e,t;return"current"===i?Z()((null==l||null==(t=l.extendedInfo)?void 0:t.vc_recordings.current)||[]).sort((function(e,t){return t.date-e.date})):Z()((null==l||null==(e=l.extendedInfo)?void 0:e.vc_recordings[parseInt(i,10)])||[]).sort((function(e,t){return t.date-e.date}))}),[l,i]);return Object(A.jsx)(O.a,{style:{flex:1},children:Object(A.jsx)(ee.a,{data:u,ListEmptyComponent:Object(A.jsx)(ne,{}),refreshControl:r,ListHeaderComponent:Object(A.jsx)(se,{courseData:l,onYearChange:function(e){return s(e)}}),renderItem:function(e){var r=e.item;return Object(A.jsx)(ie,{item:r,dark:n,onPress:function(){a.navigate("Video",{video:r,courseId:t})}})}})})},ue=n(120),be=n(344),de=n(948),je=Q.a.create({blackText:{color:g.b.black},whiteText:{color:g.b.white},grayText:{color:g.b.gray},textRegular:{fontFamily:"Inter-Regular"},textMedium:{fontFamily:"Inter-Medium"},textBold:{fontFamily:"Inter-Bold"},textExtraSmall:{fontSize:10},textSmall:{fontSize:12},textNormal:{fontSize:16},textMediumSize:{fontSize:20},textLarge:{fontSize:24},textExtraLarge:{fontSize:32},textTitleLarge:{fontSize:42},withHorizontalPadding:{paddingHorizontal:24},withRoundedBorder:{borderRadius:4},safePaddingTop:{paddingTop:40},container:{flex:1,flexDirection:"column",alignContent:"space-between"},paddingFromHeader:{paddingTop:32},titleBar:{width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},tabNavigator:{backgroundColor:g.b.white,height:60,tabBarActiveTintColor:g.b.white,paddingBottom:8},elevated:{shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.23,shadowRadius:2.62,elevation:4},elevatedSmooth:{shadowColor:"#bbb",shadowOffset:{width:0,height:12},shadowOpacity:.58,shadowRadius:16,elevation:24},border:{borderRadius:8,borderColor:g.b.lightGray,borderWidth:.5}}),fe=n(446);function Oe(e){var t=e.width,n=Object(j.useRef)(new fe.a.Value(0)).current;return Object(j.useEffect)((function(){fe.a.loop(fe.a.timing(n,{toValue:1.5,duration:2e3,useNativeDriver:!0})).start()}),[]),Object(A.jsxs)(O.a,{style:{width:t,height:t,borderRadius:t/2},children:[Object(A.jsx)(fe.a.View,{style:[{backgroundColor:g.b.white,width:t,height:t,borderRadius:t/2,opacity:fe.a.subtract(1.5,n)},{transform:[{scale:n}]}]}),Object(A.jsx)(O.a,{style:{position:"absolute",left:t/4,top:t/4,width:t/2,height:t/2,borderRadius:t/4,backgroundColor:g.b.white}})]})}var ge=n(171);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe=function(e){var t=e.name,n=void 0===t?"":t,r=e.action,a=void 0===r?function(){}:r,c=e.compact,o=void 0!==c&&c,i=e.withButton,s=void 0===i||i,l=e.withPadding,u=void 0===l||l,b=e.fullHeight,d=void 0!==b&&b,j=e.children,f=e.dark,h=e.style,p=Object(m.a)().t;return Object(A.jsx)(O.a,{style:he(he(he({},je.elevatedSmooth),je.border),{},{backgroundColor:g.b.white,width:o?"48%":"100%",flex:0},h),children:Object(A.jsx)(ge.a,{style:{paddingHorizontal:u?12:0,paddingVertical:u?8:0,flex:d?1:0},android_ripple:{color:g.b.lightGray},onPress:function(){a()},children:Object(A.jsxs)(O.a,{style:{flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",flex:1},children:[n?Object(A.jsx)(V.a,{w:"m",s:12*L.a,c:f?g.b.gray100:g.b.gray800,children:n}):null,j,s&&Object(A.jsx)(O.a,{style:{backgroundColor:g.b.lightGray,padding:8,borderRadius:8,marginVertical:4,width:"100%",flexDirection:"row",justifyContent:"center"},children:Object(A.jsx)(V.a,{w:"m",s:10*L.a,c:f?g.b.gray100:g.b.gray800,children:p("open")})})]})})})},ye=n(126);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=function(e){var t=e.liveClass,n=e.courseName,r=e.device,a=Object(j.useState)(!0),c=d()(a,2),o=c[0],i=c[1],l=Object(j.useState)(0),u=d()(l,2),b=(u[0],u[1]),f=Object(j.useRef)(),m=function(){return ae.a.utc(ae()(Date.now()).diff(ae()(t.date))).format("HH:mm:ss")};return Object(j.useEffect)((function(){return s()((function*(){f.current=setInterval((function(){o&&b(m())}),1e3)}))(),function(){clearInterval(f.current),i(!1)}}),[]),Object(A.jsx)(pe,{withButton:!1,withPadding:!1,action:function(){s()((function*(){yield Object(ye.a)((yield Object(be.getLessonURL)(r,t)).url||"")}))()},children:Object(A.jsxs)(de.a,{start:{x:.2,y:.1},end:{x:.7,y:.9},colors:["#EA0000","#C30000"],style:ve(ve(ve({paddingVertical:16,paddingHorizontal:24},je.elevatedSmooth),je.border),{},{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),children:[Object(A.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:-je.withHorizontalPadding.paddingHorizontal/2},children:[Object(A.jsx)(O.a,{style:{marginRight:8},children:Object(A.jsx)(Oe,{width:40})}),Object(A.jsxs)(O.a,{style:{flex:3,flexDirection:"column",justifyContent:"flex-start"},children:[Object(A.jsx)(V.a,{s:12*L.a,w:"b",c:g.b.white,children:"LIVE"}),Object(A.jsx)(V.a,{s:12*L.a,w:"b",c:g.b.white,children:m()})]})]}),Object(A.jsxs)(O.a,{style:{flex:1,flexDirection:"column",justifyContent:"center",alignItems:"flex-end"},children:[Object(A.jsx)(V.a,{s:10*L.a,w:"b",c:g.b.white,children:t.title}),Object(A.jsx)(V.a,{s:10*L.a,w:"b",c:g.b.white,children:n})]})]})})};function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=function(e){var t=e.title,n=e.dark,r=e.style,a=void 0===r?{}:r,c=e.children;return Object(A.jsxs)(O.a,{style:Ce({},a),children:[Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:n?g.b.gray100:g.b.gray800,children:t}),Object(A.jsx)(O.a,{style:{marginTop:16*L.a},children:c})]})},De=n(381),Pe=[{icon:"file-text",color:g.b.gray200,colorLight:g.b.gray700,extensions:["csv","log","md","txt"]},{icon:"archive",color:g.b.gray200,colorLight:g.b.gray700,extensions:["7z","bz","gz","rar","tar","zip","xz"]},{icon:"file-code",color:g.b.black,extensions:["asm","c","cpp","cs","css","go","h","hpp","htm","html","java","js","json","jsx","ts","tsx","php","py","rs","xml"]},{icon:"photo",color:g.b.gradient1,extensions:["bmp","gif","jpg","jpeg","png","svg","tiff"]},{icon:"movie",color:g.b.gradient1,extensions:["flv","mkv","mp4","mov","wmv","avi","webm"]},{icon:"headphones",color:g.b.red,extensions:["aac","alac","flac","m4a","mp3","ogg","wav","wma"]},{icon:"file-text",color:g.b.gradient1,extensions:["doc","docm","docx","odt"]},{icon:"file-text",color:"#ff3848",extensions:["pdf"]},{icon:"presentation",color:g.b.orange,extensions:["odp","ppt","pptm","pptx"]},{icon:"table",color:g.b.green,extensions:["ods","xls","xlsm","xlsx"]}];var Ie=["B","kB","MB","GB","TB"],_e=function(e,t){Object(De.getDownloadURL)(e,t).then((function(e){return Object(ye.a)(e)}))},Ee=function(e){var t=e.item,n=e.relativeDate,r=void 0!==n&&n,a=e.dark,c=e.course,o=void 0===c?"":c,i=e.onPress,s=void 0===i?function(){}:i,l=e.children,u=Object(j.useMemo)((function(){return"file"===t.type?(e=1e3*t.size,n=Math.floor(e),r=Math.min(n>0?Math.floor(Math.floor(Math.log10(n))/3):0,Ie.length-1),(n/Math.pow(10,0===r?1:3*r)).toFixed(2)+" "+Ie[r]):"";var e,n,r}),[t]),b=Object(j.useContext)(z.a).device,d=Object(j.useMemo)((function(){return"file"===t.type?function(e,t){for(var n=e.split(".").pop().toLowerCase(),r=0;r<Pe.length;r++){var a=Pe[r],c=a.icon;if(a.extensions.includes(n)){var o=t?Pe[r].color:Pe[r].colorLight||Pe[r].color;return Object(A.jsx)(H.a,{name:c,color:o,size:24*L.a})}}return Object(A.jsx)(H.a,{name:"file-unknown",color:g.b.gray500,size:24*L.a})}(t.filename,a):Object(A.jsx)(H.a,{name:"folder",color:a?g.b.gray200:g.b.gray700,size:24*L.a})}),[t,a]);return Object(A.jsxs)(O.a,{style:{flexDirection:"column"},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8,flex:1},children:[Object(A.jsxs)(oe.a,{parentStyle:[{flexDirection:"row",marginRight:0*L.a},"mobile"===v.a&&{flex:1}],onPress:function(){"file"===t.type?_e(b,t):s()},style:{flexDirection:"row",alignItems:"center"},children:[d,Object(A.jsxs)(O.a,{style:{flexDirection:"column",justifyContent:"center",marginLeft:10*L.a,flex:1},children:[Object(A.jsx)(O.a,{style:{marginRight:10*L.a,overflow:"hidden"},children:Object(A.jsx)(V.a,{c:a?g.b.gray100:g.b.gray800,w:"m",s:12*L.a,numberOfLines:1,children:t.name})}),"file"===t.type&&Object(A.jsx)(O.a,{style:{flexDirection:"column",flex:1},children:Object(A.jsxs)(V.a,{numberOfLines:1,w:"r",s:10*L.a,c:g.b.gray300,children:[u+" · ",r?ae()(t.creation_date).fromNow():ae()(t.creation_date).format("ll"),o?" · "+o:""]})})]})]}),"file"===t.type?Object(A.jsx)(oe.a,{android_ripple:{color:g.b.lightGray},onPress:function(){return _e(b,t)},children:Object(A.jsx)(H.a,{name:"download",size:24*L.a,color:g.b.accent300})}):null]}),"dir"===t.type?Object(A.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(A.jsx)(O.a,{style:{width:16*L.a,alignItems:"flex-start"},children:Object(A.jsx)(O.a,{style:{flex:1,marginLeft:4*L.a,width:2*L.a,backgroundColor:a?g.b.gray600:g.b.gray300}})}),Object(A.jsx)(O.a,{style:{flex:1},children:l})]}):null]})},Te=n(172),Me=n(922),Re=/<\/?\w+[^>]*>/g,ze=function(e){return void 0===e.topic},Le=function(e){var t,n=e.type,r=e.notification,a=e.dark,c=e.read,o=void 0===c||c,i=e.courseName,s=void 0===i?"":i,l=Object(j.useMemo)((function(){switch(n){case Te.NotificationType.TEST:return"test-pipe";case Te.NotificationType.DIRECT:return"message-dots";case Te.NotificationType.NOTICE:return"bell";case Te.NotificationType.MATERIAL:return"files";default:return"bell"}}),[n]),u=Object(j.useMemo)((function(){return ze(r)?(e=r.text,Object(Me.decode)(e).replace(Re,"")):r.title;var e}),[r]),b=Object(j.useMemo)((function(){return ze(r)?r.text:r.body}),[r]),d=Object(j.useMemo)((function(){return ae()(ze(r)?r.date:r.time).format("ll")}),[r]),f=Object(E.a)(o?0:1),m=Object(T.a)(((t=function(){return{width:8*L.a*f.value,height:8*L.a*f.value,backgroundColor:g.b.red,borderRadius:8*L.a}})._closure={p:L.a,offset:f,colors:{red:g.b.red}},t.asString="function _f(){const{p,offset,colors}=jsThis._closure;{return{width:8*p*offset.value,height:8*p*offset.value,backgroundColor:colors.red,borderRadius:8*p};}}",t.__workletHash=9456528118976,t.__location="/home/runner/work/open-polito/open-polito/src/ui/Notification.tsx (74:37)",t.__optimalization=3,t));return Object(j.useEffect)((function(){o&&(f.value=Object(M.a)(0,{duration:200}))}),[o]),Object(A.jsxs)(O.a,{style:{flexDirection:"column"},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(A.jsxs)(O.a,{style:{width:32*L.a,height:32*L.a,borderRadius:4*L.a,backgroundColor:a?g.b.gray700:g.b.gray200,alignItems:"center",justifyContent:"center",marginRight:16*L.a},children:[Object(A.jsx)(O.a,{style:{position:"absolute",justifyContent:"center",alignItems:"center",top:-4*L.a,right:-4*L.a,width:8*L.a,height:8*L.a},children:Object(A.jsx)(R.default.View,{style:[m]})}),Object(A.jsx)(H.a,{name:l,color:g.b.accent300,size:16*L.a})]}),Object(A.jsxs)(O.a,{style:{flexDirection:"column",flex:1},children:[Object(A.jsx)(V.a,{s:12*L.a,c:a?g.b.gray100:g.b.gray800,w:"r",numberOfLines:ze(r)?1:2,children:u}),Object(A.jsxs)(V.a,{s:10*L.a,c:a?g.b.gray200:g.b.gray700,w:"r",numberOfLines:2,children:[d,ze(r)?r.course_name&&" · "+r.course_name:s&&" · "+s]})]})]}),!!b&&Object(A.jsx)(O.a,{style:{marginTop:12*L.a,padding:16*L.a,borderRadius:4*L.a,backgroundColor:a?g.b.gray700:g.b.gray200},children:Object(A.jsx)(Y.RenderHTMLSource,{source:{html:b}})})]})};function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(e){var t,n,r,a,c,o=e.code,i=(e.changeTab,Object(m.a)().t),s=Object(j.useContext)(z.a),l=s.device,u=s.dark,b=Object(h.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name==o}))})),d=(null==b||null==(t=b.extendedInfo)?void 0:t.material)||[],f=function(e,t,n){return Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",marginBottom:(n+1)%3==0?0:8*L.a},children:[Object(A.jsx)(H.a,{name:t,size:16*L.a,color:u?g.b.gray200:g.b.gray700}),Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:u?g.b.gray200:g.b.gray700,style:{marginLeft:8*L.a},children:e})]},t)},y=Object(j.useMemo)((function(){var e,t,n,r;return[{name:(null==b||null==(e=b.extendedInfo)?void 0:e.professor.surname)+" "+(null==b||null==(t=b.extendedInfo)?void 0:t.professor.name),icon:"user-circle"},{name:(null==b?void 0:b.basicInfo.num_credits)+" "+i("credits"),icon:"north-star"},{name:null==b?void 0:b.basicInfo.code,icon:"grid-pattern"},{name:i("year")+" "+((null==b||null==(n=b.extendedInfo)?void 0:n.degree_year)||"")+", "+i("period")+" "+(null==b||null==(r=b.extendedInfo)?void 0:r.year_period)||"",icon:"calendar-time"}]}),[b]);return Object(A.jsxs)(O.a,{children:[Object(A.jsx)(Se,{dark:u,title:i("summary"),children:(null==b?void 0:b.status.code)==p.b.PENDING?Object(A.jsx)(ue.a,{}):Object(A.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(A.jsx)(O.a,{style:{flex:1},children:y.slice(0,2).map((function(e,t){return f(e.name||"",e.icon,t)}))}),Object(A.jsx)(O.a,{style:{flex:1},children:y.slice(2).map((function(e,t){return f(e.name||"",e.icon,t)}))})]})}),(null==b||null==(n=b.extendedInfo)?void 0:n.live_lessons.map((function(e){return Object(A.jsx)(we,{liveClass:e,courseName:b.basicInfo.name,device:l},e.meeting_id)})))||null,Object(A.jsx)(Se,{dark:u,title:i("latestFiles"),style:{marginTop:24},children:Object(A.jsx)(O.a,{style:{marginTop:-8},children:(null==b?void 0:b.status.code)==p.b.PENDING?Object(A.jsx)(ue.a,{}):(c=d||[],function e(t){return t.flatMap((function(t){return"file"==t.type?[t]:[t].concat(e(t.children))})).filter((function(e){return"file"==e.type}))}(c||[]).sort((function(e,t){return t.creation_date-e.creation_date})).slice(0,3)).map((function(e){return Object(A.jsx)(Ee,{item:e,dark:u})}))})}),Object(A.jsx)(Se,{dark:u,title:i("latestAlert"),style:{marginTop:16},children:(null==b?void 0:b.status.code)==p.b.PENDING?Object(A.jsx)(ue.a,{}):((null==b||null==(r=b.extendedInfo)?void 0:r.notices)||[]).length>0?Object(A.jsx)(Le,{notification:Be(Be({},null==b||null==(a=b.extendedInfo)?void 0:a.notices[0]),{},{course_code:(null==b?void 0:b.basicInfo.code)||"",course_name:(null==b?void 0:b.basicInfo.name)||""}),type:Te.NotificationType.NOTICE,dark:u}):null})]})};function Ve(e){var t=e.dark,n=e.item,r=Object(j.useState)(!1),a=d()(r,2),c=a[0],o=a[1];return Object(A.jsx)(O.a,{children:"file"==n.type?Object(A.jsx)(Ee,{dark:t,item:n}):Object(A.jsx)(O.a,{children:Object(A.jsx)(Ee,{dark:t,item:n,onPress:function(){o(!c)},children:c?n.children.map((function(e){return Object(A.jsx)(Ve,{dark:t,item:e},e.code)})):[]})})})}function Ae(e){var t,n,r=e.courseId,a=e.dark,c=Object(h.c)((function(e){return e.courses})).courses;return Object(A.jsx)(O.a,{children:"all"==r?c.map((function(e){var t;return Object(A.jsx)(Ve,{item:{type:"dir",code:e.basicInfo.code+e.basicInfo.name,name:e.basicInfo.name,children:(null==(t=e.extendedInfo)?void 0:t.material)||[]},dark:a},e.basicInfo.code+e.basicInfo.name)})):((null==(t=c.find((function(e){return e.basicInfo.code+e.basicInfo.name==r})))||null==(n=t.extendedInfo)?void 0:n.material)||[]).map((function(e){return Object(A.jsx)(Ve,{item:e,dark:a},e.code)}))})}var Fe=function(e){var t=e.alerts,n=e.dark,r=e.refreshControl,a=Object(j.useMemo)((function(){return Q.a.create({container:{paddingHorizontal:16*L.a,flex:1}})}),[n]);return Object(A.jsx)(O.a,{style:{flexDirection:"column",flex:1},children:Object(A.jsx)(ee.a,{style:a.container,ListEmptyComponent:Object(A.jsx)(ne,{}),ListHeaderComponent:function(){return Object(A.jsx)(O.a,{style:{height:24*L.a}})},refreshControl:r,data:t,initialNumToRender:1,keyExtractor:function(e){return e.id+e.date+e.text.slice(0,10)},renderItem:function(e){return Object(A.jsx)(O.a,{style:{marginBottom:24*L.a},children:Object(A.jsx)(Le,{type:Te.NotificationType.NOTICE,notification:e.item,dark:n})})}})})},Ue=n(180),Ge=n(167);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe,Je=Q.a.create({badge:{position:"absolute",width:20*L.a,height:20*L.a,borderRadius:20*L.a,backgroundColor:g.b.red,right:-10*L.a,top:-10*L.a,justifyContent:"center",alignItems:"center"}}),Xe=function(e){var t=e.children,n=e.style,r=void 0===n?{}:n,a=e.number,c=Object(j.useMemo)((function(){return"string"==typeof a?a:a>99?"99+":a}),[a]);return Object(A.jsxs)(O.a,{style:We({},r),children:[t,0!==c?Object(A.jsx)(O.a,{style:Je.badge,children:Object(A.jsx)(V.a,{w:"r",s:10*L.a,c:g.b.gray100,children:c})}):null]})},Qe=n(59);function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.MAIN=0]="MAIN",e[e.SECONDARY=1]="SECONDARY"}(qe||(qe={}));var $e=function(e){var t=e.title,n=e.headerType,r=Object(j.useContext)(z.a).dark,a=Object(h.c)((function(e){return e.user.notifications})),c=Object(h.c)((function(e){return e.session.config})),o=Object(h.b)(),i=Object(j.useMemo)((function(){return a.filter((function(e){return!e.is_read})).length}),[a]),s=Object($.p)(),l=Object(j.useMemo)((function(){return r?"moon-stars":"sun"}),[r]),u=Object(j.useCallback)((function(){o(Object(Qe.e)(Ze(Ze({},c),{},{theme:r?"light":"dark"})))}),[r,c,o]),b=Object(j.useMemo)((function(){return Q.a.create({header:{flexDirection:"row",marginHorizontal:12*L.a,marginVertical:16*L.a,alignItems:"center"},headerSection:{flex:1,flexDirection:"row",alignItems:"center"},headerMiddle:{flex:2,flexDirection:"row",justifyContent:"center"},headerEnd:{justifyContent:"flex-end"}})}),[]);return Object(A.jsx)(O.a,{style:b.header,children:n===qe.MAIN?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(O.a,{style:b.headerSection,children:Object(A.jsx)(oe.a,{onPress:function(){s.dispatch($.c.toggleDrawer())},children:Object(A.jsx)(Xe,{number:0,style:{marginRight:16*L.a},children:Object(A.jsx)(H.a,{name:"menu-2",size:24*L.a,color:r?g.b.gray100:g.b.gray800})})})}),Object(A.jsx)(O.a,{style:Ze(Ze({},b.headerSection),b.headerMiddle),children:Object(A.jsx)(V.a,{c:r?g.b.gray100:g.b.gray800,w:"m",s:16*L.a,numberOfLines:1,children:t})}),Object(A.jsxs)(O.a,{style:Ze(Ze({},b.headerSection),b.headerEnd),children:["mobile"!==v.a&&Object(A.jsx)(oe.a,{onPress:u,children:Object(A.jsx)(H.a,{name:l,size:24*L.a,color:r?g.b.gray100:g.b.gray800,style:{marginRight:16*L.a}})}),Object(A.jsx)(oe.a,{onPress:function(){return s.navigate("Search")},children:Object(A.jsx)(H.a,{name:"search",size:24*L.a,color:r?g.b.gray100:g.b.gray800,style:{marginRight:16*L.a}})}),Object(A.jsx)(oe.a,{onPress:function(){return s.navigate("Notifications")},children:Object(A.jsx)(Xe,{number:i,children:Object(A.jsx)(H.a,{name:"bell",size:24*L.a,color:r?g.b.gray100:g.b.gray800})})})]})]}):n===qe.SECONDARY?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(oe.a,{onPress:s.goBack,children:Object(A.jsx)(H.a,{name:"arrow-left",size:24*L.a,color:r?g.b.gray200:g.b.gray700})}),Object(A.jsx)(V.a,{s:16*L.a,w:"m",c:r?g.b.gray100:g.b.gray800,style:{marginLeft:16*L.a},children:t})]}):null})};function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nt=function(e){var t=e.adjusted,n=void 0!==t&&t,r=e.items,a=e.onChange,c=e.defaultIndex,o=void 0===c?0:c,i=e.dark,s=e.style,l=void 0===s?{}:s,u=Object(j.useState)(o),b=d()(u,2),f=b[0],m=b[1],h=Object(j.useMemo)((function(){return Q.a.create({container:{},adjusted:{marginTop:24*L.a,paddingHorizontal:16*L.a},tab:{},selectedIndicator:{marginTop:4*L.a,height:2*L.a,backgroundColor:g.b.accent300}})}),[i,n]);return Object(A.jsx)(O.a,{children:Object(A.jsx)(I.a,{contentContainerStyle:tt(tt(tt({},h.container),l),n?h.adjusted:{}),horizontal:!0,showsHorizontalScrollIndicator:!1,children:r.map((function(e,t){return Object(A.jsx)(O.a,{style:h.tab,children:Object(A.jsxs)(oe.a,{style:{marginRight:24*L.a},onPress:function(){return m(e=t),void a(e);var e},children:[Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:t==f?g.b.accent300:i?g.b.gray100:g.b.gray800,children:e.label}),t==f?Object(A.jsx)(O.a,{style:h.selectedIndicator}):null]})},e.value)}))})})};function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e){e.navigation;var t,n=e.route,r=Object(h.b)(),a=Object(m.a)().t,c=Object(j.useContext)(z.a),o=c.device,i=c.dark,s=n.params.courseCode,l=Object(h.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name==s}))})),u=Object(j.useState)(0),b=d()(u,2),f=b[0],g=b[1],y=Object(j.useMemo)((function(){return["overview","material","alerts","videos"]}),[]);Object(j.useEffect)((function(){l&&(null==l?void 0:l.status.code)!==p.b.PENDING&&(null==l?void 0:l.status.code)!==p.b.SUCCESS&&r(Object(Ue.c)({basicCourseInfo:l.basicInfo,device:o}))}),[l,o,r]);var x=Object(j.useCallback)((function(){r(Object(Ue.c)({basicCourseInfo:l.basicInfo,device:o}))}),[l,o,r]),v=Object(j.useMemo)((function(){return(null==l?void 0:l.status.code)===p.b.PENDING}),[l]),w=Object(j.useMemo)((function(){return Q.a.create({container:{paddingHorizontal:16*L.a,paddingBottom:16*L.a}})}),[]),k=Object(j.useMemo)((function(){var e;switch(y[f]){case"overview":return Object(A.jsxs)(I.a,{refreshControl:Object(A.jsx)(X.a,{refreshing:v,onRefresh:x}),style:w.container,children:[Object(A.jsx)(O.a,{style:{height:24*L.a}}),Object(A.jsx)(He,{code:s,changeTab:g}),Object(A.jsx)(O.a,{style:{height:16*L.a}})]});case"material":return Object(A.jsxs)(I.a,{refreshControl:Object(A.jsx)(X.a,{refreshing:v,onRefresh:x}),style:w.container,children:[Object(A.jsx)(O.a,{style:{height:24*L.a}}),Object(A.jsx)(Ae,{dark:i,courseId:s}),Object(A.jsx)(O.a,{style:{marginBottom:16*L.a}})]});case"alerts":return Object(A.jsx)(Fe,{refreshControl:Object(A.jsx)(X.a,{refreshing:v,onRefresh:x}),dark:i,alerts:(null==l||null==(e=l.extendedInfo)?void 0:e.notices.map((function(e){return at(at({},e),{},{course_code:l.basicInfo.code,course_name:l.basicInfo.name})})))||[]});case"videos":return Object(A.jsx)(le,{refreshControl:Object(A.jsx)(X.a,{refreshing:v,onRefresh:x}),dark:i,courseId:s})}}),[w.container,s,null==l?void 0:l.basicInfo.code,null==l?void 0:l.basicInfo.name,null==l||null==(t=l.extendedInfo)?void 0:t.notices,f,i,x,v,y]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:(null==l?void 0:l.basicInfo.name)||"",headerType:qe.SECONDARY}),Object(A.jsx)(nt,{adjusted:!0,dark:i,onChange:function(e){g(e)},items:y.map((function(e){return{label:a(e),value:e}}))}),Object(A.jsx)(O.a,{style:{flex:1},children:k})]})}var ot=n(147),it=function(e){var t=e.title,n=e.items,r=e.onSelect,a=Object(j.useContext)(z.a).dark,c=Object(j.useContext)(D.a).hideModal,o=Object(j.useCallback)((function(e){r(e),c()}),[r,c]);return Object(A.jsx)(F,{title:t,dismissable:!0,children:n.map((function(e){return Object(A.jsx)(_.a,{onPress:function(){return o(e.value)},children:Object(A.jsx)(O.a,{style:{paddingVertical:8*L.a},children:Object(A.jsx)(V.a,{s:12*L.a,w:"r",c:a?g.b.gray100:g.b.gray800,children:e.label})})},e.value)}))})};function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e){var t=e.navigation,n=Object(m.a)().t,r=(Object(h.b)(),Object(j.useContext)(z.a).dark),a=Object(j.useContext)(D.a).setModal,c=Object(h.c)((function(e){return e.courses.courses})),o=Object(j.useState)(""),i=d()(o,2),l=i[0],u=i[1],b=Object(j.useState)([]),f=d()(b,2),p=f[0],y=f[1],x=Object(j.useState)(""),v=d()(x,2),w=v[0],k=v[1],C=Object(j.useState)(!0),S=d()(C,2),P=S[0],I=S[1],_=Object(j.useState)(null),E=d()(_,2),T=E[0],M=E[1],R=Object(j.useState)(null),N=d()(R,2),B=N[0],F=N[1],U=Object(j.useMemo)((function(){return[{label:n("allCourses"),value:""}].concat(Z()(c.map((function(e){return{label:e.basicInfo.name,value:e.basicInfo.code+e.basicInfo.name}}))))}),[c]);Object(j.useEffect)((function(){G(l)}),[w,l]);var G=function(e){var t=e.toLowerCase().trim();T&&clearTimeout(T),B&&clearTimeout(B),I(!0),M(setTimeout((function(){W(t),F(setTimeout((function(){I(!1)}),500))}),50))},Y=function e(t,n,r,a){var c=[];return n.forEach((function(n){"file"==n.type?(n.name+n.filename).toLowerCase().includes(t)&&c.push(lt(lt({},n),{},{course_code:a,course_name:r})):"dir"==n.type&&c.push.apply(c,Z()(e(t,n.children,r,a)))})),c},W=function(e){s()((function*(){setTimeout((function(){var t=[];if(""!==e){if(w){var n,r,a=c.find((function(e){return w===""+e.basicInfo.code+e.basicInfo.name}));if(!a)return void(t=[]);(n=t).push.apply(n,Z()(Y(e,(null==(r=a.extendedInfo)?void 0:r.material)||[],a.basicInfo.name,a.basicInfo.code)))}else c.forEach((function(n){var r,a;(r=t).push.apply(r,Z()(Y(e,(null==(a=n.extendedInfo)?void 0:a.material)||[],n.basicInfo.name,n.basicInfo.code)))}));y(t)}else y([])}),0)}))()};return Object(A.jsxs)(Ge.a,{children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",paddingHorizontal:12*L.a,paddingVertical:16*L.a},children:[Object(A.jsx)(oe.a,{onPress:t.goBack,style:{marginRight:16*L.a},children:Object(A.jsx)(H.a,{name:"arrow-left",color:r?g.b.gray200:g.b.gray700,size:24*L.a})}),Object(A.jsx)(ot.a,{initiallyFocused:!0,icon:"search",dark:r,placeholder:n("searchForAnything"),autoFocus:!0,onChangeText:function(e){var t=e.toLowerCase().trim();u(t),G(t)},style:{flex:1}}),Object(A.jsx)(oe.a,{onPress:function(){a(Object(A.jsx)(it,{items:U,title:n("selectCourseDropdown"),onSelect:function(e){return k(e)}}))},style:{marginLeft:16*L.a},children:Object(A.jsx)(Xe,{number:""===w?0:"",children:Object(A.jsx)(H.a,{name:"adjustments",color:r?g.b.gray200:g.b.gray700,size:24*L.a})})})]}),Object(A.jsx)(nt,{dark:r,items:[{label:n("files"),value:"files"}],onChange:function(){},adjusted:!0}),Object(A.jsx)(ee.a,{style:{paddingTop:24*L.a,paddingHorizontal:16*L.a},contentContainerStyle:{flexGrow:1},data:P?p.slice(0,10):p,keyExtractor:function(e){return e.code},initialNumToRender:10,maxToRenderPerBatch:10,renderItem:function(e){var t=e.item;return Object(A.jsx)(O.a,{children:Object(A.jsx)(Ee,{item:t,dark:r,course:t.course_name},t.code)},t.code)},ListEmptyComponent:Object(A.jsxs)(O.a,{style:{flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(A.jsx)(H.a,{name:"search-off",size:64*L.a,color:r?g.b.gray300:g.b.gray600}),Object(A.jsxs)(O.a,{style:{marginTop:8*L.a,flexDirection:"column",alignItems:"center"},children:[Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:r?g.b.gray200:g.b.gray700,style:{marginBottom:8*L.a},children:n("noResults")}),Object(A.jsx)(V.a,{s:10*L.a,w:"m",c:r?g.b.gray300:g.b.gray600,children:n("tryADifferentTerm")})]})]}),ListFooterComponent:Object(A.jsx)(O.a,{style:{marginBottom:24*L.a}})})]})}var bt=n(178),dt=function(e){var t=e.video;return Object(A.jsx)("video",{src:t.url,controls:!0,autoPlay:!0})},jt=function(e){var t=e.courseData,n=e.video,r=e.dark;return Object(A.jsxs)(O.a,{children:[Object(A.jsx)(V.a,{s:16*L.a,w:"b",c:r?g.b.gray100:g.b.gray800,children:n.title}),Object(A.jsxs)(V.a,{s:12*L.a,w:"m",c:r?g.b.gray200:g.b.gray500,style:{marginTop:8*L.a},children:[null==t?void 0:t.basicInfo.name," · ",ae()(n.date).format("ll")]}),Object(A.jsx)(O.a,{style:{marginVertical:24*L.a}})]})},ft=function(e){var t=e.currentVideo,n=e.windowWidth,r=e.windowHeight;return Object(A.jsx)(O.a,{style:[{width:"100%"},"mobile"!==v.a&&{flex:1},!!n&&{height:n/1.78},!!r&&{maxHeight:r/2}],children:Object(A.jsx)(dt,{video:t})})},Ot=function(e){var t=e.currentVideo,n=e.relatedVideos,r=e.dark,a=e.setCurrentVideo,c=e.courseData,o=Object(m.a)().t;return Object(A.jsx)(ee.a,{data:n,renderItem:function(e){var n=e.item;return Object(A.jsx)(O.a,{style:[n.url===t.url?{backgroundColor:r?g.b.gray600:g.b.gray300}:{}],children:Object(A.jsx)(ie,{item:n,dark:r,onPress:function(){return a(n)}})})},keyExtractor:function(e){return e.url},ListHeaderComponent:function(){return Object(A.jsxs)(O.a,{style:{paddingHorizontal:16*L.a,paddingBottom:16*L.a},children:[!!c&&Object(A.jsx)(O.a,{style:{marginTop:16*L.a},children:Object(A.jsx)(jt,{video:t,courseData:c,dark:r})}),Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:r?g.b.gray100:g.b.gray800,children:o("relatedVideos")})]})}})};function gt(e){var t=e.route.params,n=t.video,r=t.courseId,a=Object(j.useState)(n),c=d()(a,2),o=c[0],i=c[1],s=Object(h.c)((function(e){return e.courses.courses.find((function(e){return e.basicInfo.code+e.basicInfo.name===r}))})),l=Object(j.useMemo)((function(){var e;return Z()((null==s||null==(e=s.extendedInfo)?void 0:e.vc_recordings.current)||[]).sort((function(e,t){return t.date-e.date}))}),[s]),u=Object(j.useContext)(z.a),b=u.dark,f=u.size,g=Object(bt.a)(),m=g.width,p=g.height,y=Object(j.useMemo)((function(){return Object(A.jsx)(ft,{currentVideo:o,windowWidth:"mobile"===v.a?m:void 0,windowHeight:f>=N.a.lg&&"mobile"===v.a?p:void 0})}),[o,p,f,m]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:n.title,headerType:qe.SECONDARY}),Object(A.jsx)(O.a,{style:{flex:1,overflow:"scroll"},children:Object(A.jsxs)(O.a,{style:f>=N.a.lg?{flexDirection:"row",alignItems:"flex-start",flex:1,paddingHorizontal:64*L.a}:{flexDirection:"column",justifyContent:"flex-start",flex:1},children:[Object(A.jsxs)(O.a,{style:f>=N.a.lg?{flex:2}:"mobile"===v.a&&{flex:1},children:[Object(A.jsx)(O.a,{children:y}),Object(A.jsx)(O.a,{style:f>=N.a.lg?{marginTop:24*L.a,flex:1}:{flex:1},children:f>=N.a.lg?Object(A.jsx)(jt,{courseData:s,video:o,dark:b}):Object(A.jsx)(O.a,{style:{flex:1},children:Object(A.jsx)(Ot,{courseData:s,currentVideo:o,relatedVideos:l,setCurrentVideo:i,dark:b})})})]}),f>=N.a.lg&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(O.a,{style:{width:32*L.a}}),Object(A.jsx)(O.a,{style:{flex:1},children:Object(A.jsx)(Ot,{currentVideo:o,relatedVideos:l,setCurrentVideo:i,dark:b})})]})]})})]})}function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=[{name:"Courses",icon:"school"},{name:"Material",icon:"folders"},{name:"Email",icon:"mail"},{name:"ExamSessions",icon:"ballpen"}],yt=[g.b.accent300,g.b.red,"#9b51e0","#f2c94c"],xt=function(){var e=Object(m.a)().t,t=Object(j.useContext)(z.a).dark,n=Object($.p)(),r=Object(h.c)((function(e){return e.courses})),a=r.courses,c=r.recentMaterial,o=r.loadExtendedCourseInfoStatus,i=Object(j.useMemo)((function(){return a.flatMap((function(e){var t;return(null==(t=e.extendedInfo)?void 0:t.notices.map((function(t){return ht(ht({},t),{},{course_name:e.basicInfo.name,course_code:e.basicInfo.code})})))||[]})).sort((function(e,t){return t.date-e.date}))[0]}),[a]),s=Object(j.useMemo)((function(){return Q.a.create({container:{marginTop:24*L.a,paddingHorizontal:16*L.a,paddingBottom:16*L.a},topSections:{flexDirection:"row",justifyContent:"space-between",paddingBottom:16},topSection:{justifyContent:"center",alignItems:"center"},topSectionInner:{width:40*L.a,height:40*L.a,borderRadius:4*L.a,marginBottom:4*L.a,justifyContent:"center",alignItems:"center"},topSectionText:{position:"absolute",bottom:-16*L.a}})}),[t]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:e("home"),headerType:qe.MAIN}),Object(A.jsx)(I.a,{children:Object(A.jsxs)(O.a,{style:s.container,children:[Object(A.jsx)(oe.a,{onPress:function(){n.navigate("Search")},children:Object(A.jsx)(ot.a,{editable:!1,placeholder:e("searchForAnything"),dark:t,icon:"search",style:{marginBottom:32*L.a}})}),Object(A.jsxs)(O.a,{style:s.topSections,children:[pt.map((function(r,a){return Object(A.jsxs)(oe.a,{style:s.topSection,onPress:function(){n.navigate(r.name)},children:[Object(A.jsx)(O.a,{style:ht(ht({},s.topSectionInner),{},{backgroundColor:yt[a]}),children:Object(A.jsx)(H.a,{name:r.icon,size:24*L.a,color:g.b.gray100})}),Object(A.jsx)(V.a,{numberOfLines:1,s:10*L.a,w:"r",c:t?g.b.gray100:g.b.gray800,style:s.topSectionText,children:e(r.name[0].toLowerCase()+r.name.slice(1))})]},r.name)})),Object(A.jsxs)(oe.a,{style:s.topSection,onPress:function(){n.toggleDrawer()},children:[Object(A.jsx)(O.a,{style:ht(ht({},s.topSectionInner),{},{borderColor:g.b.gray200,borderWidth:1*L.a}),children:Object(A.jsx)(H.a,{name:"plus",size:24*L.a,color:g.b.gray200})}),Object(A.jsx)(V.a,{numberOfLines:1,s:10*L.a,w:"r",c:t?g.b.gray100:g.b.gray800,style:s.topSectionText,children:e("more")})]})]}),Object(A.jsx)(Se,{dark:t,title:e("latestFiles"),style:{marginTop:32*L.a},children:o.code!=p.b.SUCCESS?Object(A.jsx)(ue.a,{}):c.slice(0,3).map((function(e){return Object(A.jsx)(O.a,{children:Object(A.jsx)(Ee,{relativeDate:!0,dark:t,item:e,course:e.course_name})},e.code)}))}),Object(A.jsx)(Se,{dark:t,title:e("latestAlert"),style:{marginTop:24*L.a},children:o.code!=p.b.SUCCESS?Object(A.jsx)(ue.a,{}):Object(A.jsx)(Le,{type:Te.NotificationType.NOTICE,notification:i,dark:t})})]})})]})},vt=n(949),wt=n(125),kt=n(332),Ct=function(){var e=s()((function*(e){return yield Object(kt.emailUrl)(e)}));return function(t){return e.apply(this,arguments)}}();function St(){var e=Object(m.a)().t,t=Object(j.useContext)(z.a),n=t.dark,r=t.device,a=Object(h.b)(),c=Object(j.useState)(!0),o=d()(c,2),i=o[0],l=o[1],u=Object(j.useState)(!1),b=d()(u,2),f=b[0],p=b[1],y=Object(j.useState)(null),x=d()(y,2),w=(x[0],x[1]),k=Object(j.useState)(""),C=d()(k,2),S=C[0],D=C[1];Object(j.useEffect)((function(){return function(){return l(!1)}}),[]),Object(j.useEffect)((function(){s()((function*(){a(Object(wt.e)(r)),!S&&i&&D(yield Ct(r)),S&&"mobile"!==v.a&&p(!0)}))()}),[r,a,i,S]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:e("email"),headerType:qe.MAIN}),Object(A.jsxs)(R.default.View,{style:{flex:1},children:[f?"mobile"!==v.a?Object(A.jsxs)(O.a,{style:{flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:n?g.b.gray100:g.b.gray800,style:{marginRight:16*L.a},children:e("emailCannotBeShownWeb",{genericPlatform:v.a})}),Object(A.jsx)(V.a,{href:S,s:12*L.a,w:"m",c:n?g.b.gray100:g.b.gray800,style:{marginRight:16*L.a},children:e("openBrowser")})]}):null:Object(A.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:n?g.b.gray100:g.b.gray800,style:{marginRight:16*L.a},children:e("loading")}),Object(A.jsx)(ue.a,{})]}),"mobile"===v.a&&Object(A.jsx)(O.a,{style:{flex:f?1:0},children:Object(A.jsx)(vt.a,{ref:function(e){return!e&&w(e)},source:{uri:S},onNavigationStateChange:function(e){"mobile"===v.a&&(e.loading||f||!i||p(!0))}})})]})]})}var Dt=n(515),Pt=function(e){var t=e.icon,n=e.name,r=e.description,a=e.disabled,c=void 0!==a&&a,o=e.settingsFunction,i=void 0===o?function(){}:o,s=e.toggle,l=void 0!==s&&s,u=e.toggleValue,b=e.padding,d=void 0!==b&&b,f=e.paddingBottom,m=void 0===f||f,h=e.children,p=void 0===h?null:h,y=Object(j.useContext)(z.a).dark,x=Object(j.useMemo)((function(){return Q.a.create({container:{flexDirection:"row",alignItems:"center"},textContainer:{flex:1,flexDirection:"column",justifyContent:"flex-start"}})}),[]);return Object(A.jsxs)(O.a,{style:[d?{paddingHorizontal:16*L.a}:{},m?{paddingBottom:16*L.a}:{}],children:[Object(A.jsxs)(oe.a,{disabled:!!p||c,onPress:i,android_ripple:{color:g.b.gray200},style:[x.container,c?{opacity:.5}:{}],children:[t?Object(A.jsx)(O.a,{style:{marginRight:12*L.a},children:Object(A.jsx)(H.a,{name:t,size:24*L.a,color:y?g.b.gray300:g.b.gray600})}):null,Object(A.jsxs)(O.a,{style:x.textContainer,children:[Object(A.jsx)(V.a,{w:"m",s:12*L.a,c:y?g.b.gray100:g.b.gray800,style:{marginBottom:2*L.a},children:n}),r?Object(A.jsx)(V.a,{w:"r",s:10*L.a,c:y?g.b.gray200:g.b.gray700,children:r}):null]}),l?Object(A.jsx)(Dt.a,{value:u,onChange:i}):null]}),Object(A.jsx)(O.a,{children:p})]})},It=n(433);function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=function(){var e=Object(m.a)().t,t=Object(h.b)(),n=Object(h.c)((function(e){return e.session.config}));return Object(A.jsx)(U,{title:e("debugEnableLogging"),icon:"alert-triangle",accentColor:g.b.red,onConfirm:function(){t(Object(Qe.e)(Et(Et({},n),{},{logging:!n.logging}))),t(Object(Qe.g)({message:e("restartToastMessage"),type:"warn",visible:!0}))},children:Object(A.jsx)(Y.RenderHTMLSource,{source:{html:e("debugEnableLoggingDialogMessage",{path:It.default.logsDirectoryPath})}})})};function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(){var e=Object(m.a)().t,t=Object(j.useContext)(z.a),n=t.dark,r=t.device,a=Object(j.useContext)(D.a).setModal,c=Object(h.c)((function(e){return e.session.config})),o=Object(h.b)(),i=[{icon:"bug",name:e("debugEnableLogging"),description:e("debugEnableLoggingDesc"),settingsFunction:function(){c.logging?o(Object(Qe.e)(Rt(Rt({},c),{},{logging:!1}))):a(Object(A.jsx)(Tt,{}))},toggle:!0,toggleValue:c.logging},{icon:"arrow-back",name:e("debugResetConfig"),description:e("debugResetConfigDesc"),settingsFunction:function(){o(Object(Qe.d)())}},{icon:"bell-ringing",name:e("debugTestNotification"),description:e("debugTestNotificationDesc"),settingsFunction:function(){o(Object(Qe.g)({message:e("pleaseWait"),type:"info",visible:!0})),s()((function*(){yield Object(Te.sendTestPushNotification)(r)}))()}}],l=Object(j.useMemo)((function(){return Q.a.create({container:{marginTop:24*L.a,paddingHorizontal:16*L.a,paddingBottom:16*L.a}})}),[]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{headerType:qe.MAIN,title:e("settings")}),Object(A.jsx)(O.a,{style:l.container,children:parseInt(y.a.ENABLE_DEBUG_OPTIONS)?Object(A.jsx)(Se,{dark:n,title:e("debugSettings"),children:Object(A.jsx)(O.a,{style:{marginTop:-8*L.a},children:i.map((function(e){return function(e){return Object(A.jsx)(Pt,Rt({},e),e.name)}(e)}))})}):null}),Object(A.jsx)(O.a,{style:{marginTop:8,marginBottom:16,flexDirection:"row",justifyContent:"center"},children:Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:n?g.b.gray200:g.b.gray700,children:"v"+x.version})})]})}var Lt=["explore","recentlyAdded"];function Nt(){var e=Object(m.a)().t,t=Object(h.b)(),n=Object($.p)(),r=Object(h.c)((function(e){return e.courses.courses})),a=Object(h.c)((function(e){return e.courses})),c=a.getRecentMaterialStatus,o=a.recentMaterial,i=Object(j.useState)(0),s=d()(i,2),l=s[0],u=s[1],b=Object(j.useContext)(z.a),f=b.dark,g=b.device,y=Object(j.useState)(!1),x=d()(y,2),v=x[0],w=x[1],k=Object(j.useState)(!1),C=d()(k,2),S=(C[0],C[1]);Object(j.useEffect)((function(){var e=!0;r.forEach((function(n){n.status.code!=p.b.SUCCESS&&(e=!1,t(Object(Ue.c)({basicCourseInfo:n.basicInfo,device:g})))})),e&&w(!0)}),[]),Object(j.useEffect)((function(){if(!v){var e=!0;r.forEach((function(t){t.status.code!=p.b.SUCCESS&&(e=!1)})),e&&w(!0)}}),[r]),Object(j.useEffect)((function(){v&&c.code!=p.b.SUCCESS&&c.code!=p.b.PENDING&&t(Object(Ue.b)())}),[v]),Object(j.useEffect)((function(){c.code==p.b.SUCCESS&&S(!0)}),[c]);var D=Object(j.useMemo)((function(){return Q.a.create({container:{marginTop:24*L.a,paddingHorizontal:16*L.a,paddingBottom:16*L.a}})}),[f]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{headerType:qe.MAIN,title:e("material")}),Object(A.jsx)(ee.a,{data:[0],renderItem:function(){return Object(A.jsxs)(O.a,{style:D.container,children:[Object(A.jsx)(oe.a,{onPress:function(){n.navigate("Search")},children:Object(A.jsx)(ot.a,{editable:!1,placeholder:e("searchForAnything"),dark:f,icon:"search"})}),Object(A.jsx)(nt,{style:{marginTop:24*L.a,marginBottom:16*L.a},onChange:function(e){return u(e)},dark:f,items:Lt.map((function(t){return{label:e(t),value:t}}))}),0==l?Object(A.jsx)(Ae,{courseId:"all",dark:f}):Object(A.jsx)(ee.a,{data:o,keyExtractor:function(e){return e.code},renderItem:function(e){var t=e.item;return Object(A.jsx)(Ee,{item:t,dark:f,course:t.course_name},t.code)}})]})}})]})}var Bt=n(958),Ht=n(42),Vt=n.n(Ht),At=n(840),Ft=[{name:"general",items:[{name:"Home",icon:"layout-dashboard"},{name:"Email",icon:"mail"},{name:"Notifications",icon:"bell"},{name:"Settings",icon:"settings"}]},{name:"classes",items:[{name:"Courses",icon:"school"},{name:"Material",icon:"folders"},{name:"Bookings",icon:"ticket"},{name:"Timetable",icon:"clock"}]},{name:"exams",items:[{name:"Exams",icon:"book-2"},{name:"ExamSessions",icon:"ballpen"}]},{name:"headquarters",items:[{name:"Maps",icon:"map-2"},{name:"Classrooms",icon:"building-arch"},{name:"People",icon:"user"}]}],Ut=["dark"];function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wt=function(e){return["Maps","Classrooms","People"].includes(e)},qt=Ft.flatMap((function(e){return e.items.map((function(e){return e.name}))})),Jt=function(e){var t=e.dark,n=Vt()(e,Ut),r=Object(m.a)().t,a=Object(h.b)(),c=Object(j.useContext)(z.a),o=Object(h.c)((function(e){return e.user.userInfo})),i=Object(j.useMemo)((function(){return null==o?"":(e=o.degree_type,t=o.degree_name,("corso di laurea in"==e.toLowerCase()?"L3":"corso di laurea magistrale in"==e.toLowerCase()?"LM":"")+" "+t.toLowerCase().replace("ingegneria","").toUpperCase().trim());var e,t}),[o]),s=Object(j.useState)(qt[0]),l=d()(s,2),u=l[0],b=l[1],f=Object(j.useCallback)((function(){a(Object(Qe.c)(c.device))}),[a,c]),p=Object(j.useMemo)((function(){return Q.a.create({drawerScrollView:{backgroundColor:t?g.b.gray800:g.b.gray100},drawer:{flexDirection:"column",paddingHorizontal:16*L.a,paddingVertical:24*L.a},hr:{backgroundColor:g.b.gray500,height:1*L.a,marginBottom:16*L.a},category:{marginBottom:16*L.a}})}),[t]);return Object(A.jsx)(At.a,Yt(Yt({style:p.drawerScrollView},n),{},{children:Object(A.jsxs)(O.a,{style:p.drawer,children:[Object(A.jsxs)(O.a,{style:{justifyContent:"flex-start",marginBottom:16*L.a},children:[Object(A.jsx)(V.a,{s:14*L.a,w:"b",c:t?g.b.gray100:g.b.gray800,children:"Open PoliTo"}),Object(A.jsxs)(V.a,{s:10*L.a,w:"r",c:t?g.b.gray200:g.b.gray700,children:["v",x.version]})]}),Object(A.jsx)(O.a,{style:p.hr}),Ft.map((function(e){return Object(A.jsxs)(O.a,{style:p.category,children:[Object(A.jsx)(O.a,{style:{marginBottom:8*L.a},children:Object(A.jsx)(V.a,{s:10*L.a,w:"m",c:t?g.b.gray200:g.b.gray700,children:r(e.name).toUpperCase()})}),e.items.map((function(e){return Object(A.jsxs)(oe.a,{disabled:Wt(e.name),style:{paddingVertical:4*L.a,flexDirection:"row",alignItems:"center",opacity:Wt(e.name)?.3:1},onPress:function(){b(e.name),n.navigation.navigate(e.name)},children:[Object(A.jsx)(H.a,{name:e.icon,size:24*L.a,color:e.name==u?g.b.accent300:t?g.b.gray100:g.b.gray700,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:e.name==u?g.b.accent300:t?g.b.gray100:g.b.gray800,children:r(e.name.charAt(0).toLowerCase()+e.name.slice(1))})]},e.name)}))]})})),Object(A.jsx)(O.a,{style:p.hr}),Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(A.jsx)(O.a,{style:{width:24*L.a,height:24*L.a,borderRadius:24*L.a,backgroundColor:g.b.accent100,marginRight:8*L.a}}),Object(A.jsxs)(O.a,{style:{justifyContent:"flex-start",flex:1},children:[Object(A.jsxs)(V.a,{numberOfLines:1,w:"b",c:t?g.b.gray100:g.b.gray800,s:12*L.a,children:[null==o?void 0:o.surname," ",null==o?void 0:o.name]}),Object(A.jsx)(V.a,{numberOfLines:1,w:"r",c:t?g.b.gray200:g.b.gray700,s:10*L.a,children:i})]}),Object(A.jsx)(oe.a,{onPress:function(){f()},children:Object(A.jsx)(H.a,{name:"logout",size:24*L.a,color:g.b.accent300})})]})]})}))},Xt=n(146),Qt=n(161),Kt=n(452);function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var en=function(e){var t,n=e.dark,r=e.title,a=e.description,c=e.onPress,o=e.expanded,i=e.sideElement,s=e.expandedElement,l=e.children,u=Object(E.a)(0),b=Object(E.a)(0),f=Object(E.a)(1),m=Object(j.useState)(null),h=d()(m,2),p=h[0],y=h[1],x=Object(E.a)(0),v=Object(E.a)(0),w=Object(T.a)(((t=function(){return{opacity:b.value}})._closure={opacity:b},t.asString="function _f(){const{opacity}=jsThis._closure;{return{opacity:opacity.value};}}",t.__workletHash=1880562015862,t.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (55:41)",t.__optimalization=3,t)),k=Object(j.useState)(s),C=d()(k,2),S=C[0],D=C[1];Object(j.useEffect)((function(){var e;(e=o||!p?s:Object(A.jsx)(O.a,{}))&&setTimeout((function(){D(e)}),o?0:200)}),[o,s,p]);var P=Object(j.useCallback)((function(e){null===p&&(b.value=Object(M.a)(1,{duration:200}),y(e.nativeEvent.layout.height))}),[p,b]);Object(j.useEffect)((function(){if(0!==p){var e=o&&s;u.value=Object(M.a)(e?90:0,{duration:200}),v.value=Object(M.a)(1,{duration:400})}}),[o,u,v,s,p]),Object(j.useEffect)((function(){f.value=Object(M.a)(i?1:0,{duration:400})}),[i,f]);var I=Object(T.a)(function(){var e=function(){return{transform:[{rotate:u.value+"deg"}]}};return e._closure={rotation:u},e.asString='function _f(){const{rotation}=jsThis._closure;{return{transform:[{rotate:rotation.value+"deg"}]};}}',e.__workletHash=0xb8f92e0794d,e.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (125:44)",e.__optimalization=3,e}());Object(j.useEffect)((function(){p&&(x.value=Object(M.a)(o?p:0,{duration:200}))}),[p,x,o]);var _=Object(T.a)(function(){var e=function(){return $t($t({},null!==p?{height:x.value}:{}),{},{opacity:Object(M.a)(o&&null!==p?1:0,{duration:200})})};return e._closure={computedHeight:p,expandedElementHeight:x,withTiming:M.a,expanded:o},e.asString="function _f(){const{computedHeight,expandedElementHeight,withTiming,expanded}=jsThis._closure;{return{...(computedHeight!==null?{height:expandedElementHeight.value}:{}),opacity:withTiming(expanded&&computedHeight!==null?1:0,{duration:200})};}}",e.__workletHash=8846081890926,e.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (144:48)",e.__optimalization=2,e}()),z=Object(T.a)(function(){var e=function(){return{opacity:f.value}};return e._closure={sideElementOpacity:f},e.asString="function _f(){const{sideElementOpacity}=jsThis._closure;{return{opacity:sideElementOpacity.value};}}",e.__workletHash=0xf81030983f6,e.__location="/home/runner/work/open-polito/open-polito/src/ui/core/PressableCard.tsx (155:44)",e.__optimalization=3,e}()),N=Object(j.useMemo)((function(){return Q.a.create({button:{paddingVertical:8*L.a,paddingLeft:16*L.a,paddingRight:8*L.a,marginBottom:16*L.a,backgroundColor:n?g.b.gray700:g.b.gray200,borderRadius:4*L.a}})}),[n]);return Object(A.jsx)(R.default.View,{style:[w],children:Object(A.jsx)(oe.a,{onPress:c,android_ripple:{color:n?g.b.gray400:g.b.gray500},style:N.button,children:Object(A.jsx)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:s?"flex-start":"center"},children:Object(A.jsxs)(O.a,{style:{flex:1},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(A.jsxs)(O.a,{style:{flex:4},children:[r&&Object(A.jsx)(V.a,{s:12*L.a,c:n?g.b.gray200:g.b.gray700,w:"m",children:r}),a&&Object(A.jsx)(V.a,{s:10*L.a,c:n?g.b.gray300:g.b.gray600,w:"r",children:a})]}),Object(A.jsx)(R.default.View,{style:[z,{flex:i?1:0}],children:i}),Object(A.jsx)(O.a,{style:{justifyContent:"flex-start",alignItems:"center"},children:Object(A.jsx)(O.a,{children:Object(A.jsx)(R.default.View,{style:[I],children:Object(A.jsx)(H.a,{name:"chevron-right",color:n?g.b.gray200:g.b.gray700,size:24*L.a})})})})]}),Object(A.jsxs)(O.a,{style:{paddingRight:8*L.a},children:[l,Object(A.jsx)(R.default.View,{onLayout:function(e){return P(e)},style:[_],children:S})]})]})})})})};function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rn=function(e){e.ctxId;var t=e.subctx,n=e.language,r=e.dark,a=(Object(j.useContext)(z.a).device,Object(j.useState)({loaded:!1,expanded:!1,mounted:!0,slots:[]})),c=d()(a,2),o=(c[0],c[1]);return Object(j.useEffect)((function(){return function(){return o((function(e){return nn(nn({},e),{},{mounted:!1})}))}}),[]),Object(A.jsxs)(O.a,{children:[Object(A.jsx)(ge.a,{onPress:function(){return o((function(e){return nn(nn({},e),{},{expanded:!e.expanded})}))},android_ripple:{color:g.b.lightGray},style:{paddingVertical:8*L.a},children:Object(A.jsx)(V.a,{s:10*L.a,w:"m",c:r?g.b.gray200:g.b.gray700,children:"it"===n?t.ita.name:t.eng.name})}),Object(A.jsx)(O.a,{})]},t.id)},an=function(e){var t,n=e.ctx,r=e.language,a=e.dark,c=Object(j.useState)(!1),o=d()(c,2),i=o[0],s=o[1];return Object(A.jsx)(O.a,{children:Object(A.jsx)(en,{expanded:i,dark:a,onPress:function(){s(!i)},description:"it"===r?n.ita.description:n.eng.description,title:"it"===r?n.ita.name:n.eng.name,expandedElement:n.subcontexts&&n.subcontexts.length>0?Object(A.jsx)(O.a,{style:{marginTop:16*L.a},children:null==(t=n.subcontexts)?void 0:t.map((function(e){return Object(A.jsx)(rn,{dark:a,subctx:e,language:r,ctxId:n.id},e.id)}))}):null})})},cn=function(e){var t=e.dark,n=e.booking,r=e.barcodeUrl,a=Object(j.useState)(!1),c=d()(a,2),o=c[0],i=c[1],s=Object(j.useMemo)((function(){return[{type:"date",label:ae()(n.start_time).format("ll"),icon:"calendar-time"},{type:"time",label:ae()(n.start_time).format("LT")+" - "+ae()(n.end_time).format("LT"),icon:"clock"}]}),[n]);return Object(A.jsx)(en,{title:n.course_id?n.course_name+" - "+n.course_id:n.subcontext_name,description:n.context_name,expanded:o,dark:t,sideElement:!o&&Object(A.jsx)(ce.a,{source:{uri:r},style:{width:"100%",aspectRatio:2.5,resizeMode:"contain"},resizeMode:"contain"}),expandedElement:Object(A.jsx)(O.a,{style:{flex:1,marginTop:16*L.a},children:Object(A.jsx)(ce.a,{source:{uri:r},style:{width:"100%",aspectRatio:2.5,resizeMode:"contain"}})}),onPress:function(){return i((function(e){return!e}))},children:Object(A.jsx)(O.a,{style:{marginTop:16*L.a},children:s.map((function(e,n){return Object(A.jsxs)(O.a,{style:[{flexDirection:"row",alignItems:"center"},n>0&&{marginTop:8*L.a}],children:[Object(A.jsx)(H.a,{name:e.icon,size:16*L.a,color:t?g.b.gray200:g.b.gray700,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{style:{marginRight:8*L.a},s:10*L.a,w:"r",c:t?g.b.gray200:g.b.gray700,children:e.label})]})}))})})},on=function(){var e=Object(m.a)().t,t=Object(j.useContext)(z.a),n=t.device,r=t.dark,a=Object(h.b)(),c=Object(h.c)((function(e){return e.user})),o=c.userInfo,i=c.getBookingsStatus,l=c.getBookingContextsStatus,u=c.bookings,b=c.bookingContexts,f=Object(j.useRef)(!0),g=Object(j.useMemo)((function(){return["myBookings","newBooking"]}),[]),y=Object(j.useState)({currentTab:g[0],barcodeUrl:""}),x=d()(y,2),v=x[0],w=x[1],k=Object(j.useMemo)((function(){return i.code===p.b.PENDING||l.code===p.b.PENDING}),[i,l]),C=Object(j.useCallback)((function(e){"myBookings"===e&&a(Object(wt.c)(n)),"newBooking"===e&&a(Object(wt.b)(n))}),[n,a]);Object(j.useEffect)((function(){""===v.barcodeUrl&&o&&w((function(e){return nn(nn({},e),{},{barcodeUrl:Object(Qt.barcode_url)(o.current_id)})}))}),[v.barcodeUrl,o]),Object(j.useEffect)((function(){s()((function*(){v.currentTab===g[0]?a(Object(wt.c)(n)):v.currentTab===g[1]&&a(Object(wt.b)(n))}))()}),[v.currentTab,o,n,a,g]),Object(j.useEffect)((function(){return function(){f.current=!1}}),[]);var S=Object(j.useMemo)((function(){return Q.a.create({container:{marginTop:24*L.a,paddingHorizontal:16*L.a,flex:1}})}),[]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:e("bookings"),headerType:qe.MAIN}),Object(A.jsx)(nt,{adjusted:!0,dark:r,onChange:function(e){return w((function(t){return nn(nn({},t),{},{currentTab:g[e]})}))},items:g.map((function(t){return{label:e(t),value:t}}))}),Object(A.jsx)(O.a,{style:S.container,children:Object(A.jsx)(Kt.ScrollView,{refreshControl:Object(A.jsx)(X.a,{refreshing:k,onRefresh:function(){return C(v.currentTab===g[0]?"myBookings":"newBooking")}}),children:v.currentTab===g[0]&&i.code===p.b.PENDING||v.currentTab===g[1]&&l.code===p.b.PENDING?Object(A.jsx)(ue.a,{}):v.currentTab===g[0]?0===u.length?Object(A.jsx)(ne,{}):u.map((function(e){return Object(A.jsx)(cn,{dark:r,booking:e,barcodeUrl:v.barcodeUrl},""+e.context_id+e.subcontext_id+e.start_time+e.end_time)})):0===b.length?Object(A.jsx)(ne,{}):b.map((function(e){return Object(A.jsx)(an,{dark:r,ctx:e,language:Xt.b.language},e.id)}))})})]})},sn=n(927),ln=n(38),un=n(491),bn=n.n(un),dn=function(e){var t=e.width,n=e.height,r=e.children;return Object(A.jsx)(O.a,{style:{width:t,height:n},children:r})},jn=function(e){var t,n=e.children,r=Object(j.useState)(!1),a=d()(r,2),c=a[0],o=a[1],i=Object(j.useState)(!0),l=d()(i,2),u=l[0],b=l[1],f=Object(E.a)(0),O=Object(T.a)(((t=function(){return{opacity:f.value,transform:[{translateY:8-8*f.value},{translateX:8-8*f.value}]}})._closure={offset:f},t.asString="function _f(){const{offset}=jsThis._closure;{return{opacity:offset.value,transform:[{translateY:8-offset.value*8},{translateX:8-offset.value*8}]};}}",t.__workletHash=4069580825127,t.__location="/home/runner/work/open-polito/open-polito/src/components/loaders/LoaderBase.tsx (16:37)",t.__optimalization=3,t));return Object(j.useEffect)((function(){return s()((function*(){setTimeout((function(){u&&o(!0)}),150)}))(),function(){b(!1)}}),[]),Object(j.useEffect)((function(){c&&(f.value=Object(M.a)(1,{duration:200}))}),[c]),c?Object(A.jsx)(R.default.View,{style:[O],children:n}):null},fn=function(e){var t=e.w,n=e.h,r=Object(j.useState)(Math.ceil(2*Math.random())),a=d()(r,1)[0],c=Object(j.useState)(Array.from({length:a},(function(e,t){return(t+1)*(3+Math.random())*n}))),o=d()(c,1)[0];return Object(A.jsx)(O.a,{style:{height:10*n,position:"absolute"},children:Object(A.jsx)(jn,{children:Object(A.jsx)(dn,{width:t,height:15*n,children:Array.from({length:a}).map((function(e,r){return Object(A.jsx)(un.Rect,{x:0,y:o[r],rx:4*L.a,ry:4*L.a,width:t-4,height:2*n},r)}))})})})},On=function(e){var t=e.slot,n=Object(j.useContext)(z.a).dark,r=Object(j.useMemo)((function(){return[{icon:"map-pin",name:t.room},{icon:"align-justified",name:t.type},{icon:"clock",name:ae()(t.start_time).format("HH:mm")+" - "+ae()(t.end_time).format("HH:mm")+" ("+ae()(t.start_time).format("ll")+")"},{icon:"user",name:t.professor.surname+" "+t.professor.name}]}),[t]);return Object(A.jsx)(F,{title:t.course_name,children:r.map((function(e,t){return Object(A.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginTop:(0==t?0:8)*L.a},children:[Object(A.jsx)(H.a,{name:e.icon,size:16*L.a,color:n?g.b.gray300:g.b.gray600,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{s:12*L.a,c:n?g.b.gray100:g.b.gray800,w:"r",children:e.name})]})}))})},gn=function(e){var t=e.overlapGroup,n=e.slot,r=e.w,a=e.h,c=e.courseNames,o=e.index,i=Object(j.useContext)(D.a).setModal,s=Object(E.a)(0),l=Object(E.a)(0),u=Object(E.a)(0),b=Object(j.useState)(0),f=d()(b,2),m=f[0],h=f[1];Object(j.useEffect)((function(){l.value=1}),[]),Object(j.useEffect)((function(){s.value=r,r>=60&&setTimeout((function(){u.value=1}),100)}),[r]);var p,y=Object(T.a)(((p=function(){return{opacity:Object(M.a)(u.value,{duration:500})}})._closure={withTiming:M.a,textOpacity:u},p.asString="function _f(){const{withTiming,textOpacity}=jsThis._closure;{return{opacity:withTiming(textOpacity.value,{duration:500})};}}",p.__workletHash=3417517497760,p.__location="/home/runner/work/open-polito/open-polito/src/components/timetable/TimetableEvent.tsx (53:48)",p.__optimalization=2,p)),x=Object(T.a)(function(){var e=function(){return{width:Object(M.a)(t.length>0?s.value/t.length:s.value,{duration:250}),left:Object(M.a)(t.length>0?o*(s.value/t.length):0,{duration:250})}};return e._closure={withTiming:M.a,overlapGroup:t,offset:s,index:o},e.asString="function _f(){const{withTiming,overlapGroup,offset,index}=jsThis._closure;{return{width:withTiming(overlapGroup.length>0?offset.value/overlapGroup.length:offset.value,{duration:250}),left:withTiming(overlapGroup.length>0?index*(offset.value/overlapGroup.length):0,{duration:250})};}}",e.__workletHash=0xa9304f61bed,e.__location="/home/runner/work/open-polito/open-polito/src/components/timetable/TimetableEvent.tsx (57:37)",e.__optimalization=2,e}());return Object(A.jsx)(R.default.View,{onLayout:function(e){return h(e.nativeEvent.layout.width)},style:[{overflow:"hidden",position:"absolute",top:a+ae.a.duration(ae()(n.start_time).diff(ae()(n.start_time).set({h:8,m:0}))).as("ms")/36e5*a-a/2,borderRadius:4*L.a,backgroundColor:g.a[c.findIndex((function(e){return e==n.course_name}))],height:ae.a.duration(n.end_time-n.start_time).as("ms")/36e5*a},x],children:Object(A.jsxs)(_.a,{style:{flex:1,padding:4*L.a},onPress:function(){i(Object(A.jsx)(On,{slot:n}))},children:[m>=25?Object(A.jsx)(R.default.View,{style:[y],children:Object(A.jsx)(V.a,{w:"r",s:8*L.a,c:g.b.white,numberOfLines:2,children:n.course_name})}):null,m>=60?Object(A.jsxs)(R.default.View,{style:[y],children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",marginTop:8*L.a,alignItems:"center",justifyContent:"flex-start",overflow:"hidden"},children:[Object(A.jsx)(H.a,{name:"map-pin",size:8*L.a,color:g.b.gray50}),Object(A.jsx)(V.a,{w:"r",s:8*L.a,c:g.b.gray50,numberOfLines:2,style:{marginLeft:2*L.a},children:n.room})]}),Object(A.jsxs)(O.a,{style:{opacity:l.value,flexDirection:"row",marginTop:4*L.a,alignItems:"center",justifyContent:"flex-start",overflow:"hidden"},children:[Object(A.jsx)(H.a,{name:"list",size:8*L.a,color:g.b.gray50}),Object(A.jsx)(V.a,{w:"r",s:8*L.a,c:g.b.gray50,numberOfLines:2,style:{marginLeft:2*L.a},children:n.type})]})]}):null]})})},mn=function(e){var t=e.fake,n=void 0!==t&&t,r=e.day,a=e.h,c=e.courseNames,o=e.config,i=(e.index,Object(j.useState)(0)),s=d()(i,2),l=s[0],u=s[1],b=Object(j.useMemo)((function(){return Z()(r).sort((function(e,t){return o.timetablePriority.indexOf(t.course_name)-o.timetablePriority.indexOf(e.course_name)}))}),[o.timetablePriority,r]),f=Object(j.useMemo)((function(){if("priority"===o.timetableOverlap)return[];if(0===r.length)return[];for(var e=[],t=ae()(r[0].start_time).set({h:8,m:45}),n=function(){t.add(90,"m");var n=[];r.map((function(e){e.start_time<t.toDate().getTime()&&t.toDate().getTime()<e.end_time&&n.push(e)})),n.length>1&&e.push(n)},a=0;a<9;a++)n();return e}),[r,o.timetableOverlap]);return Object(A.jsx)(O.a,{onLayout:function(e){u(e.nativeEvent.layout.width)},style:{backgroundColor:g.b.white,flex:1,zIndex:200,flexDirection:"column",justifyContent:"flex-start",alignItems:"center",borderColor:g.b.gray200,marginHorizontal:1*L.a},children:n?Object(A.jsx)(fn,{w:l,h:a}):"priority"===o.timetableOverlap?b.map((function(e,t){return Object(A.jsx)(gn,{overlapGroup:[],slot:e,w:l,h:a,courseNames:c,index:t},t)})):r.map((function(e,t){var n=function(e){var t=[];return f.forEach((function(n){n.includes(e)&&(t=n)})),t}(e),r=n.findIndex((function(t){return e===t}));return Object(A.jsx)(gn,{overlapGroup:n,slot:e,w:l,h:a,courseNames:c,index:r},t)}))})};function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yn=function(e){var t=e.loaded,n=e.timetableDays,r=e.layout,a=e.selectedDay,c=Object(h.b)(),o=Object(h.c)((function(e){return e.session.config})),i=Object(j.useState)(ln.a.get("window").height/15),s=d()(i,2),l=s[0],u=(s[1],Object(j.useState)(["","",""])),b=d()(u,2),f=b[0],g=b[1],m=Object(j.useMemo)((function(){return 1===n.length?n:n.slice(1,6)}),[n]);return Object(j.useEffect)((function(){var e;g((e=[],n.forEach((function(t){t.forEach((function(t){e.includes(t.course_name)||e.push(t.course_name)}))})),e.sort()))}),[m]),Object(j.useEffect)((function(){if(o.timetableOverlap&&o.timetablePriority){var e=Z()(o.timetablePriority),t=!1;f.forEach((function(n){""===n.trim()||o.timetablePriority.includes(n)||(e.push(n),t=!0)})),t&&c(Object(Qe.e)(pn(pn({},o),{},{timetablePriority:e})))}}),[m,f,o,c]),Object(A.jsx)(O.a,{style:{position:"absolute",left:0,right:0,top:0,bottom:0,flex:1,marginLeft:32*L.a,marginRight:16*L.a,flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:("week"===r?m:[m[a-1]]).map((function(e,n){return Object(A.jsx)(mn,{fake:!t,config:o,day:e,h:l,index:n,courseNames:f},n)}))})},xn=function(e){var t=e.showLine,n=e.dark,r=Object(j.useState)(ln.a.get("window").height/15),a=d()(r,2),c=a[0],o=(a[1],Object(j.useState)(ae()())),i=d()(o,2),s=i[0],l=i[1],u=Object(j.useState)(!0),b=d()(u,2),f=b[0],m=b[1],h=Object(j.useState)(null),p=d()(h,2),y=p[0];p[1];Object(j.useEffect)((function(){return m(!0),function(){y&&clearTimeout(y),m(!1)}}),[]),Object(j.useEffect)((function(){setTimeout((function(){f&&l(ae()())}),1e4)}),[s,f]);var x=Q.a.create({padding:{paddingLeft:8*L.a,paddingRight:16*L.a,paddingBottom:16*L.a}});return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(O.a,{style:[x.padding,{flex:1,flexDirection:"column",justifyContent:"flex-start",alignItems:"stretch"}],children:Array.from({length:14}).map((function(e,t){return Object(A.jsxs)(O.a,{style:{width:"100%",height:0==t?c/2:c,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end"},children:[Object(A.jsx)(V.a,{s:8*L.a,c:n?g.b.gray200:g.b.gray700,w:"r",style:{transform:[{translateY:4*L.a}]},children:8+t+":00"}),Object(A.jsx)(O.a,{style:{flex:1,borderBottomWidth:.5*L.a,borderColor:n?g.b.gray500:g.b.gray200,marginLeft:4*L.a,height:c,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-end"}})]},t)}))}),t?Object(A.jsx)(O.a,{style:[x.padding,{position:"absolute",left:0,right:0,zIndex:300}],children:Object(A.jsx)(O.a,{style:{height:0,borderTopColor:g.b.red,borderBottomColor:g.b.red,backgroundColor:g.b.red,borderTopWidth:.5*L.a,borderBottomWidth:.5*L.a,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",transform:[{translateY:c+ae.a.duration(s.diff(ae()().set({h:8,m:0}))).as("ms")/36e5*c-c/2}]},children:Object(A.jsx)(O.a,{style:{backgroundColor:g.b.red,width:8*L.a,height:8*L.a,borderRadius:16*L.a}})})}):null]})},vn=function(e){var t=e.items,n=e.label,r=void 0===n?"":n,a=e.onValueChange,c=e.defaultValue,o=void 0===c?t[0].value:c,i=e.dark,s=Object(j.useState)(o),l=d()(s,2),u=l[0],b=l[1];return Object(j.useEffect)((function(){a(u)}),[u]),Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[r?Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:i?g.b.gray100:g.b.gray800,style:{marginRight:4*L.a},children:r}):null,Object(A.jsx)(O.a,{style:{flexDirection:"row",backgroundColor:i?g.b.gray700:g.b.gray200,marginLeft:4*L.a,borderRadius:4*L.a},children:t.map((function(e,n){return Object(A.jsx)(oe.a,{onPress:function(){b(e.value)},style:[{backgroundColor:e.value==u?g.b.accent300:"rgba(0,0,0,0)",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:4*L.a},0===n?{borderTopLeftRadius:4*L.a,borderBottomLeftRadius:4*L.a}:n===t.length-1?{borderTopRightRadius:4*L.a,borderBottomRightRadius:4*L.a}:{}],children:Object(A.jsx)(H.a,{name:e.icon,size:16*L.a,color:e.value==u?g.b.gray50:i?g.b.gray200:g.b.gray700})},e.value)}))})]})},wn=n(342),kn=n(945),Cn=n(928),Sn=n.n(Cn),Dn=function(e){var t=e.items,n=e.callback,r=e.disabled,a=e.dark,c=Object(j.useState)(t),o=d()(c,2),i=o[0],s=o[1];Object(j.useEffect)((function(){n(i.map((function(e){return e.label})))}),[i]);return Object(A.jsx)(Kt.GestureHandlerRootView,{children:Object(A.jsx)(Sn.a,{onDragEnd:function(e){var t=e.data;return s(t)},data:i,keyExtractor:function(e){return e.value},renderItem:function(e){var t=e.item,n=(e.index,e.drag);return Object(A.jsx)(Cn.ScaleDecorator,{children:Object(A.jsx)(_.a,{disabled:r,onLongPress:n,onPressIn:n,onPress:n,style:{paddingVertical:4*L.a},children:Object(A.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:0*L.a,opacity:r?.5:1},children:[Object(A.jsx)(H.a,{name:"grid-dots",size:24*L.a,color:a?g.b.gray300:g.b.gray600}),Object(A.jsx)(O.a,{style:{marginLeft:8*L.a},children:Object(A.jsx)(V.a,{s:12*L.a,c:a?g.b.gray100:g.b.gray800,w:"r",children:t.label})})]})})})}})})};function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _n=function(){var e=Object(h.b)(),t=Object(m.a)().t,n=Object(j.useContext)(z.a).dark,r=Object(j.useState)(!1),a=d()(r,2),c=a[0],o=a[1];Object(j.useEffect)((function(){setTimeout((function(){return o(!0)}),0)}),[]);var i=Object(h.c)((function(e){return e.session.config})),s=Object(j.useMemo)((function(){return i.timetablePriority.map((function(e){return{label:e,value:e}}))}),[i]),l=Object(j.useCallback)((function(){var t="split"===i.timetableOverlap?"priority":"split";e(Object(Qe.e)(In(In({},i),{},{timetableOverlap:t})))}),[i,e]),u=Object(j.useMemo)((function(){return[{name:t("timetablePriority"),description:t("timetablePriorityDesc"),icon:"stack-2",toggle:!0,toggleValue:"priority"===i.timetableOverlap,settingsFunction:l},{name:t("timetablePriorityList"),settingsFunction:function(){},disabled:"priority"!==i.timetableOverlap,children:Object(A.jsx)(O.a,{children:Object(A.jsx)(Dn,{dark:n,disabled:"priority"!==i.timetableOverlap,items:s,callback:function(t){return e(Object(Qe.e)(In(In({},i),{},{timetablePriority:t.filter((function(e){return""!==e}))})))}})}),paddingBottom:!1}]}),[i,n,e,s,t,l]);return Object(A.jsx)(F,{title:t("timetableOptions"),children:Object(A.jsx)(O.a,{children:c?u.map((function(e){return Object(A.jsx)(Pt,In({},e),e.name)})):Object(A.jsx)(ue.a,{color:g.b.accent300})})})},En=function(e){var t,n=e.selectedDay,r=void 0===n?null:n,a=e.timetableDays,c=e.weekStartDate,o=e.onLayoutChanged,i=e.onDayChanged,s=e.onWeekStartDateChanged,l=Object(m.a)().t,u=Object(j.useContext)(z.a).dark,b=Object(j.useContext)(D.a).setModal,d=function(e){h.value=Object(wn.a)(Object(M.a)(0,{duration:250}),Object(M.a)(1,{duration:250})),s(e)},h=Object(E.a)(1),p=Object(T.a)(((t=function(){return{opacity:h.value}})._closure={opacity:h},t.asString="function _f(){const{opacity}=jsThis._closure;{return{opacity:opacity.value};}}",t.__workletHash=1880562015862,t.__location="/home/runner/work/open-polito/open-polito/src/components/timetable/TimetableHeader.tsx (70:37)",t.__optimalization=3,t)),y=Object(j.useMemo)((function(){var e=ae()(c),t=ae()(c).add(4,"day");return c?c.getTime()==ae()().startOf("w").toDate().getTime()?l("thisWeek"):e.get("date")+" "+(e.get("month")!=t.get("month")?e.format("MMM "):"")+(e.get("year")!=t.get("year")?e.format("YYYY "):"")+"- "+t.format("D MMM YYYY"):l("thisWeek")}),[c,l]);return Object(A.jsxs)(O.a,{style:{borderBottomWidth:1*L.a,borderBottomColor:g.b.gray200},children:[Object(A.jsxs)(O.a,{style:{marginBottom:16*L.a,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:["android"===f.a.OS?Object(A.jsx)(B.a,{secondary:!0,small:!0,text:l("jumpToDate"),icon:"chevrons-right",onPress:function(){return e=function(e){e&&d(new Date(e))},void kn.a.open({mode:"date",value:new Date,onChange:function(t){return e(t.nativeEvent.timestamp)}});var e}}):Object(A.jsx)(O.a,{}),Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(A.jsx)(vn,{defaultValue:"week",onValueChange:function(e){!function(e){o(e)}(e)},label:"Layout:",items:[{icon:"layout-rows",value:"day"},{icon:"layout-columns",value:"week"}],dark:u}),Object(A.jsx)(Kt.TouchableOpacity,{style:{marginLeft:24*L.a},onPress:function(){return b(Object(A.jsx)(_n,{}))},children:Object(A.jsx)(H.a,{name:"settings",size:20*L.a,color:u?g.b.gray100:g.b.gray800})})]})]}),Object(A.jsxs)(O.a,{style:{marginBottom:16*L.a,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(A.jsx)(ge.a,{onPress:function(){return d(ae()(c).subtract(1,"w").toDate())},children:Object(A.jsx)(H.a,{name:"arrow-left",size:24*L.a,color:u?g.b.gray100:g.b.gray800})}),Object(A.jsx)(R.default.View,{style:[p],children:Object(A.jsx)(V.a,{c:u?g.b.gray100:g.b.gray800,s:12*L.a,w:"m",children:y})}),Object(A.jsx)(ge.a,{onPress:function(){return d(ae()(c).add(1,"w").toDate())},children:Object(A.jsx)(H.a,{name:"arrow-right",size:24*L.a,color:u?g.b.gray100:g.b.gray800})})]}),Object(A.jsx)(O.a,{style:{marginLeft:12,flexDirection:"row",alignItems:"flex-start",justifyContent:"space-around",paddingBottom:12},children:a.slice(1,6).map((function(e,t){return Object(A.jsxs)(ge.a,{onPress:function(){i(t+1)},style:{opacity:c?1:0,flexDirection:"column",justifyContent:"center",alignItems:"center",paddingHorizontal:12,paddingVertical:4,borderRadius:4,backgroundColor:r==t+1?g.b.accent300:u?g.b.gray700:g.b.gray200},children:[Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:r==t+1||u?g.b.gray100:g.b.gray800,children:c?ae()(c).add(t,"d").format("ddd"):""}),Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:r==t+1||u?g.b.gray100:g.b.gray700,children:c?ae()(c).add(t,"d").date():""},t)]},t)}))})]})},Tn=function(){var e,t=Object(m.a)().t,n=Object(j.useContext)(z.a),r=n.device,a=n.dark,c=Object(j.useState)(!1),o=d()(c,2),i=o[0],l=o[1],u=Object(j.useState)(null),b=d()(u,2),f=b[0],g=b[1],h=Object(j.useState)([]),p=d()(h,2),y=p[0],x=p[1],v=Object(j.useMemo)((function(){var e=Array.from({length:7},(function(){return[]}));return y.forEach((function(t){e[ae()(t.start_time).day()].push(t)})),e}),[y]),w=Object(j.useState)("day"),k=d()(w,2),C=k[0],S=k[1],D=Object(j.useState)(!0),P=d()(D,2),_=P[0],N=P[1],B=Object(j.useState)(1),H=d()(B,2),V=H[0],F=H[1],U=Object(j.useState)(null),G=d()(U,2),Y=G[0],W=G[1],q=Object(j.useState)(!1),J=d()(q,2),X=J[0],Q=J[1],K=Object(E.a)(0),Z=Object(E.a)(0),$=Object(T.a)(((e=function(){return{opacity:Object(M.a)(Z.value,{duration:500}),transform:[{translateX:K.value}]}})._closure={withTiming:M.a,opacity:Z,offset:K},e.asString="function _f(){const{withTiming,opacity,offset}=jsThis._closure;{return{opacity:withTiming(opacity.value,{duration:500}),transform:[{translateX:offset.value}]};}}",e.__workletHash=9560942952119,e.__location="/home/runner/work/open-polito/open-polito/src/screens/Timetable.tsx (51:37)",e.__optimalization=2,e)),ee=function(e){Z.value=Object(wn.a)(Object(M.a)(0,{duration:250}),Object(M.a)(0,{duration:500}),Object(M.a)(1,{duration:250})),K.value="l"===e?Object(wn.a)(Object(M.a)(32,{duration:750}),Object(M.a)(-32,{duration:0}),Object(M.a)(0,{duration:750})):Object(wn.a)(Object(M.a)(-32,{duration:750}),Object(M.a)(32,{duration:0}),Object(M.a)(0,{duration:750}))};Object(j.useEffect)((function(){return s()((function*(){f||ee("r"),Y&&clearTimeout(Y),W(setTimeout(s()((function*(){l(!1);var e=[];x([]);try{e=yield Object(sn.getTimetable)(r,null!=f?f:new Date),l(!0)}catch(e){}finally{if(!f){var t=ae()().startOf("isoWeek").toDate();_&&g(t)}x(e)}})),250))}))(),function(){clearTimeout(Y),N(!1)}}),[X]);var te=Object(j.useMemo)((function(){return"week"===C&&(null==f?void 0:f.getTime())===ae()().startOf("isoWeek").toDate().getTime()||"day"===C&&ae()(f).add(V-1,"days").toDate().getTime()===ae()().startOf("day").toDate().getTime()}),[f,V,C]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{headerType:qe.MAIN,title:t("timetable")}),Object(A.jsxs)(O.a,{style:{flex:1,paddingTop:24*L.a},children:[Object(A.jsx)(O.a,{style:{paddingHorizontal:16*L.a},children:Object(A.jsx)(En,{selectedDay:"week"===C?null:V,onDayChanged:function(e){F(e)},onLayoutChanged:function(e){S(e)},weekStartDate:f,onWeekStartDateChanged:function(e){f&&e.getTime()<f.getTime()?ee("l"):ee("r"),g(ae()(e).startOf("isoWeek").toDate()),Q(!X)},timetableDays:v})}),Object(A.jsx)(I.a,{style:{flex:1},children:Object(A.jsxs)(R.default.View,{style:[$,{flex:1}],children:[Object(A.jsx)(xn,{showLine:te,dark:a}),Object(A.jsx)(yn,{loaded:i,timetableDays:v,layout:C,selectedDay:V})]})})]})]})},Mn=function(e){var t=e.label,n=e.value,r=e.max,a=e.radius,c=e.strokeWidth,o=void 0===c?4*L.a:c,i=e.fontSize,s=e.backgroundColor,l=e.dark,u=e.children,b=2*Math.PI*a,d=Object(j.useMemo)((function(){return n<=r?n:r}),[n,r]);return Object(A.jsxs)(O.a,{style:{position:"relative"},children:[Object(A.jsxs)(bn.a,{width:2*(a+o),height:2*(a+o),children:[Object(A.jsx)(un.Circle,{transform:"rotate(-90 "+(a+o)+" "+(a+o)+")",strokeWidth:o,fill:s||"transparent",stroke:l?g.b.gray700:g.b.gray200,r:a,cx:a+o,cy:a+o}),Object(A.jsx)(un.Circle,{transform:"rotate(-90 "+(a+o)+" "+(a+o)+")",strokeWidth:o,fill:"transparent",stroke:g.b.accent300,strokeDasharray:b,strokeDashoffset:"number"==typeof d?(100-100*d/r)*b/100:0,r:a,cx:a+o,cy:a+o})]}),Object(A.jsxs)(O.a,{style:{position:"absolute",width:2*(a+o),height:2*(a+o),flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(A.jsx)(V.a,{s:i||(t||"string"==typeof d?10*L.a:16*L.a),c:l?g.b.gray100:g.b.gray800,w:"b",children:t||d}),u]})]})},Rn=n(947),zn=function(e){var t=e.marks,n=e.dark,r=Object(m.a)().t,a=Object(bt.a)().width-(Object(j.useContext)(z.a).size>=N.a.lg?300:32)*L.a,c=Object(j.useMemo)((function(){return Z()(t.filter((function(e){return parseInt(e.mark)&&ae.a.duration(Date.now()-e.date).asDays()<=365}))).sort((function(e,t){return e.date-t.date}))}),[t]),o=Object(j.useMemo)((function(){for(var e=new Array(c.length),t=0,n=0;n<c.length;n++)0===n?(t+=c[n].num_credits,e[n]=parseInt(c[n].mark)||0):(e[n]=(e[n-1]*t+(parseInt(c[n].mark)||0)*c[n].num_credits)/(t+c[n].num_credits),t+=c[n].num_credits);return e}),[c]),i=Object(j.useMemo)((function(){return{labels:c.map((function(e){return ae()(e.date).format("MMM D")})),datasets:[{data:o,color:function(){return g.b.accent300},strokeWidth:2*L.a}],legend:[r("weightedAverage")]}}),[c,o,r]);return Object(A.jsx)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:0===c.length?Object(A.jsx)(V.a,{s:12,w:"m",c:n?g.b.gray200:g.b.gray700,children:"You'll see your progress when you get at least 1 permament mark."}):Object(A.jsx)(Rn.a,{data:i,width:a,height:220,yAxisInterval:1,chartConfig:{backgroundColor:"#e26a00",backgroundGradientFrom:g.b.gray900,backgroundGradientTo:g.b.gray700,decimalPlaces:2,color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(255, 255, 255, "+e+")"},labelColor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(255, 255, 255, "+e+")"},style:{borderRadius:16},propsForDots:{r:"6",strokeWidth:"2",stroke:g.b.accent300}},style:{borderRadius:4*L.a}})})},Ln=["overview","permanentMarks","provisionalMarks"],Nn=function(e){var t=e.avg,n=e.dark,r=Object(m.a)().t;return Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(A.jsx)(Mn,{strokeWidth:8*L.a,radius:30*L.a,value:t,dark:n,max:30}),Object(A.jsxs)(O.a,{style:{marginLeft:16*L.a},children:[Object(A.jsxs)(V.a,{s:16*L.a,w:"m",c:n?g.b.gray100:g.b.gray800,style:{marginBottom:8*L.a},children:[r("yourAverageMark"),"*"]}),Object(A.jsxs)(V.a,{s:10*L.a,w:"r",c:n?g.b.gray300:g.b.gray600,children:["*",r("yourAverageMarkNotice")]})]})]})},Bn=function(e){var t,n=e.mark,r=e.provisional,a=e.dark,c=Object(j.useMemo)((function(){return Hn(n,r,a)}),[n,r,a]),o=Object(m.a)().t;return Object(A.jsxs)(O.a,{style:{flexDirection:"row",padding:16*L.a,borderRadius:4*L.a,backgroundColor:a?g.b.gray700:g.b.gray200,alignItems:"flex-start"},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"column",flex:1},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row"},children:[r?Object(A.jsx)(O.a,{style:{width:16*L.a,height:16*L.a,borderRadius:16*L.a,marginRight:8*L.a,backgroundColor:g.b.gray200,flexDirection:"row",alignItems:"center",justifyContent:"center"},children:Object(A.jsx)(V.a,{s:10,w:"b",c:g.b.gray900,children:n.status})}):null,Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:a?g.b.gray200:g.b.gray700,children:n.name})]}),Object(A.jsx)(O.a,{style:{flexDirection:r?"column":"row",marginTop:16*L.a},children:c})]}),parseInt(n.mark)?Object(A.jsx)(Mn,{radius:20*L.a,value:parseInt(n.mark),max:30,dark:a,children:("30 e lode"===(null==(t=n.mark)?void 0:t.toLowerCase())||parseInt(n.mark)>30)&&Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(V.a,{style:{marginTop:-4*L.a},s:8*L.a,c:a?g.b.gray100:g.b.gray800,w:"b",children:"LODE"})})}):Object(A.jsxs)(O.a,{style:[{padding:8*L.a,borderRadius:4*L.a,backgroundColor:g.b.accent300},!n.mark||n.failed||n.absent?{backgroundColor:g.b.red}:null],children:[n.failed?Object(A.jsx)(V.a,{s:12,w:"m",c:g.b.gray100,children:o("examFailed")}):null,n.absent?Object(A.jsx)(V.a,{s:12,w:"m",c:g.b.gray100,children:o("examAbsent")}):null,n.mark?Object(A.jsx)(V.a,{s:12,w:"m",c:g.b.gray100,children:n.mark}):null]})]})},Hn=function(e,t,n){var r=t?["date","message"]:["date","credits"],a=[],c=[];return r.forEach((function(t){switch(t){case"date":a.push("calendar-time"),c.push(ae()(e.date).format("ll"));break;case"credits":a.push("north-star"),c.push(e.num_credits+" "+Xt.b.t("credits"));break;case"message":a.push("message"),c.push(e.message||"");break;default:a.push(null),c.push("")}})),r.map((function(e,r){return Object(A.jsxs)(O.a,{style:[{flexDirection:"row",alignItems:"message"==e?"flex-start":"center",flex:1},t&&r>0?{marginTop:8*L.a}:{}],children:[null!==a[r]&&Object(A.jsx)(H.a,{name:a[r],size:16*L.a,color:n?g.b.gray200:g.b.gray700,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{style:{marginRight:8*L.a},s:10*L.a,w:"r",c:n?g.b.gray200:g.b.gray700,children:c[r]||""})]})}))},Vn=function(){var e=Object(m.a)().t,t=Object(j.useContext)(z.a).dark,n=Object(h.c)((function(e){return e.courses})).marks,r=Object(j.useState)(Ln[0]),a=d()(r,2),c=a[0],o=a[1],i=Object(j.useMemo)((function(){return c==Ln[1]?n.permanent:c==Ln[2]?n.provisional:[]}),[n,c]),l=Object(j.useMemo)((function(){return function(e){var t=e.filter((function(e){return!!parseInt(e.mark||"")})),n=t.reduce((function(e,t){return e+t.num_credits}),0);return parseFloat((t.reduce((function(e,t){return e+parseInt(t.mark)*t.num_credits}),0)/n).toFixed(2))}(n.permanent)}),[n]),u=Object(j.useMemo)((function(){return Q.a.create({container:{paddingTop:24*L.a,flex:1},paddingHorizontal:{paddingHorizontal:16*L.a},list:{paddingHorizontal:16*L.a,paddingBottom:24*L.a}})}),[]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:e("exams"),headerType:qe.MAIN}),Object(A.jsx)(nt,{dark:t,adjusted:!0,items:Ln.map((function(t){return{label:e(t),value:t}})),onChange:function(e){return o(Ln[e])}}),Object(A.jsxs)(O.a,{style:u.container,children:[c===Ln[2]?Object(A.jsx)(O.a,{style:u.paddingHorizontal,children:Object(A.jsxs)(Kt.TouchableOpacity,{onPress:s()((function*(){return yield Object(ye.a)("https://didattica.polito.it/img/RE_stati.jpg")})),style:{flexDirection:"row",alignItems:"center",marginBottom:16*L.a},children:[Object(A.jsx)(H.a,{name:"help",size:12*L.a,color:t?g.b.gray200:g.b.gray700,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{s:12,w:"m",c:t?g.b.gray200:g.b.gray700,children:e("statusCodeHelp")})]})}):null,c===Ln[0]?Object(A.jsxs)(O.a,{style:u.list,children:[Object(A.jsx)(Nn,{avg:l,dark:t}),Object(A.jsx)(O.a,{style:{height:1*L.a,backgroundColor:g.b.gray500,marginVertical:24*L.a}}),Object(A.jsx)(Se,{title:e("progressOverTime"),dark:t,children:Object(A.jsx)(O.a,{children:Object(A.jsx)(zn,{marks:n.permanent||[],dark:t})})})]}):Object(A.jsx)(ee.a,{contentContainerStyle:u.list,data:i,keyExtractor:function(e){return e.date+e.name},renderItem:function(e){var n=e.item;return Object(A.jsx)(Bn,{mark:(Ln[1],n),provisional:c==Ln[2],dark:t})},ItemSeparatorComponent:function(){return Object(A.jsx)(O.a,{style:{height:16*L.a}})},ListEmptyComponent:Object(A.jsx)(ne,{})})]})]})},An=n(345),Fn=n(185),Un=n(177),Gn=function(e){var t=e.examSession,n=Object(j.useContext)(z.a).device;return Object(A.jsx)(U,{title:Object(Xt.c)("confirmExamBooking"),onConfirm:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};s()((function*(){var r=!1;try{yield Object(Fn.bookExamSession)(e,t.session_id,t.course_id),r=!0}catch(e){console.log(e)}finally{Un.a.dispatch(Object(Qe.g)({visible:!0,message:Xt.b.t(r?"examsExamBookedToastMessage":"examsExamBookingErrorToastMessage"),type:r?"success":"err"})),n()}}))()}(n,t)},children:Object(A.jsx)(Y.RenderHTMLSource,{source:{html:Object(Xt.c)("confirmExamBookingDialogMessage",{code:t.course_id,name:t.exam_name,date:ae()(t.date).format("lll"),rooms:t.rooms})}})})},Yn=function(e){var t=e.examSession,n=Object(j.useContext)(z.a).device;return Object(A.jsx)(U,{title:Object(Xt.c)("cancelExamBooking"),accentColor:g.b.red,icon:"alert-triangle",onConfirm:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};s()((function*(){var r=!1;try{yield Object(Fn.cancelExamSession)(e,t.session_id,t.course_id),r=!0}catch(e){console.log(e)}finally{Un.a.dispatch(Object(Qe.g)({visible:!0,message:Xt.b.t(r?"examsExamCanceledToastMessage":"examsExamCancelingErrorToastMessage"),type:r?"success":"err"})),n()}}))()}(n,t)},children:Object(A.jsx)(Y.RenderHTMLSource,{source:{html:Object(Xt.c)("cancelExamBookingDialogMessage",{code:t.course_id,name:t.exam_name,date:ae()(t.date).format("lll"),rooms:t.rooms})}})})},Wn=n(131),qn=function(e){return e.user_is_signed_up},Jn=function(e){return!e.user_is_signed_up&&0===e.error.id},Xn=["allExams","myBookings","availableToBook","unavailableExams"];function Qn(){var e=Object(m.a)().t,t=Object(h.b)(),n=Object(j.useContext)(z.a),r=n.dark,a=n.device,c=Object(j.useContext)(D.a).setModal,o=Object(h.c)((function(e){return e.exams})),i=o.exams,l=o.getExamsStatus,u=Object(j.useState)(Xn[0]),b=d()(u,2),f=b[0],y=b[1],x=Object(j.useState)("en"),v=d()(x,2),w=v[0],k=v[1];Object(j.useEffect)((function(){l.code!==p.b.IDLE&&l.code!==p.b.ERROR||t(Object(An.b)(a)),s()((function*(){switch(Object(Wn.a)()){case"en":k("en");break;case"it":k("it");break;default:k("en")}}))()}),[a,t,l.code]);var C=Object(j.useMemo)((function(){l.code!==p.b.PENDING&&t(Object(An.b)(a))}),[l,a,t]),S=Object(j.useMemo)((function(){switch(f){case Xn[0]:return i;case Xn[1]:return i.filter((function(e){return qn(e)}));case Xn[2]:return i.filter((function(e){return Jn(e)}));case Xn[3]:return i.filter((function(e){return!(t=e).user_is_signed_up&&0!==t.error.id;var t}));default:return[]}}),[f,i]),P=function(t){return Object(A.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"column",flex:1,padding:16*L.a,paddingRight:8*L.a,paddingBottom:8*L.a,borderTopLeftRadius:4*L.a,borderBottomLeftRadius:4*L.a,backgroundColor:r?g.b.gray700:g.b.gray200},children:[Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(A.jsx)(H.a,{name:t.user_is_signed_up?"circle-check":0===t.error.id?"circle":"circle-off",color:t.user_is_signed_up?g.b.green:0===t.error.id?g.b.accent200:g.b.red,size:24*L.a,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:r?g.b.gray200:g.b.gray700,children:t.exam_name})]}),Object(A.jsx)(O.a,{style:{flexDirection:"column",marginTop:16*L.a},children:["course","date","deadline","rooms"].map((function(n){return c=t,o="date"===(a=n)?"calendar-time":"course"===a?"grid-pattern":"type"===a?"writing":"deadline"===a?"alert-triangle":"rooms"===a?"map-pin":"user-circle",i="date"===a?ae()(c.date).format("lll")+" ("+ae()(c.date).fromNow()+")":"course"===a?c.course_id:"type"===a?c.type:"deadline"===a?e("bookingDeadline")+": "+ae()(c.signup_deadline).format("lll")+" ("+ae()(c.signup_deadline).fromNow()+")":"rooms"===a?c.rooms.join(", "):"(coming soon)",Object(A.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",marginBottom:8*L.a},children:[Object(A.jsx)(H.a,{name:o,size:16*L.a,color:r?g.b.gray200:g.b.gray700,style:{marginRight:8*L.a}}),Object(A.jsx)(V.a,{numberOfLines:1,style:{marginRight:8*L.a},s:10*L.a,w:"r",c:r?g.b.gray200:g.b.gray700,children:i})]});var a,c,o,i}))}),0===t.error.id||""===t.error.eng&&""===t.error.ita?null:Object(A.jsx)(V.a,{s:10*L.a,w:"r",c:g.b.red,style:{marginVertical:8*L.a},children:"it"===w?t.error.ita:t.error.eng})]}),Object(A.jsx)(O.a,{style:{flexDirection:"column",justifyContent:"center",borderTopRightRadius:4*L.a,borderBottomRightRadius:4*L.a,backgroundColor:r?g.b.gray600:g.b.gray300},children:Jn(t)||qn(t)?Object(A.jsx)(_.a,{onPress:function(){return c(Jn(t)?Object(A.jsx)(Gn,{examSession:t}):Object(A.jsx)(Yn,{examSession:t}))},children:Object(A.jsxs)(O.a,{style:{flexDirection:"column",alignItems:"center",padding:8*L.a},children:[Object(A.jsx)(O.a,{style:{marginBottom:4*L.a},children:Object(A.jsx)(H.a,{name:Jn(t)?"circle-plus":"circle-x",color:Jn(t)?g.b.accent300:g.b.red,size:20*L.a})}),Object(A.jsx)(V.a,{s:10*L.a,w:"m",c:Jn(t)?g.b.accent300:g.b.red,children:e(Jn(t)?"bookVerb":"cancel")})]})}):null})]})};return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:e("examSessions"),headerType:qe.MAIN}),Object(A.jsx)(nt,{dark:r,adjusted:!0,items:Xn.map((function(t){return{label:e(t),value:t}})),onChange:function(e){return y(Xn[e])}}),Object(A.jsx)(ee.a,{contentContainerStyle:{paddingTop:24*L.a,paddingHorizontal:16*L.a,paddingBottom:24*L.a},data:S,keyExtractor:function(e){return e.session_id+e.course_id+e.date},renderItem:function(e){var t=e.item;return P(t)},ItemSeparatorComponent:function(){return Object(A.jsx)(O.a,{style:{height:16*L.a}})},ListEmptyComponent:Object(A.jsx)(ne,{}),refreshing:l.code==p.b.PENDING,refreshControl:Object(A.jsx)(X.a,{refreshing:l.code==p.b.PENDING,onRefresh:C})})]})}var Kn=function(){return Object(A.jsx)(O.a,{})},Zn=function(){return Object(A.jsx)(O.a,{})},$n=function(){return Object(A.jsx)(O.a,{})};function er(e){var t=e.navigation,n=Object(m.a)().t,r=Object(j.useContext)(z.a).dark,a=Object(h.c)((function(e){return e.courses.courses})),c=Object(j.useCallback)((function(e){t.navigate("Course",{courseCode:e.basicInfo.code+e.basicInfo.name})}),[t]),o=Object(j.useMemo)((function(){return Q.a.create({container:{marginTop:24*L.a,paddingHorizontal:16*L.a,paddingBottom:16*L.a}})}),[]);return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)($e,{title:n("courses"),headerType:qe.MAIN}),Object(A.jsx)(I.a,{children:Object(A.jsxs)(O.a,{style:o.container,children:[a.filter((function(e){return e.isMain})).map((function(e){return Object(A.jsx)(en,{dark:r,onPress:function(){return c(e)},title:e.basicInfo.name},e.basicInfo.code+e.basicInfo.name)})),a.filter((function(e){return!e.isMain})).length>0?Object(A.jsx)(Se,{dark:r,title:n("otherCourses"),style:{marginTop:8},children:a.filter((function(e){return!e.isMain})).map((function(e){return Object(A.jsx)(en,{dark:r,onPress:function(){return c(e)},title:e.basicInfo.name},e.basicInfo.code+e.basicInfo.name)}))}):null]})})]})}var tr=n(470),nr=function(e){var t,n=e.selected,r=e.onChange,a=Object(E.a)(1),c=Object(T.a)(((t=function(){return{width:20*L.a*a.value,height:20*L.a*a.value,borderRadius:4*L.a,backgroundColor:g.b.accent300,alignItems:"center",justifyContent:"center"}})._closure={p:L.a,offset:a,colors:{accent300:g.b.accent300}},t.asString="function _f(){const{p,offset,colors}=jsThis._closure;{return{width:20*p*offset.value,height:20*p*offset.value,borderRadius:4*p,backgroundColor:colors.accent300,alignItems:'center',justifyContent:'center'};}}",t.__workletHash=0xf364d967be,t.__location="/home/runner/work/open-polito/open-polito/src/ui/core/Checkbox.tsx (21:37)",t.__optimalization=3,t));return Object(j.useEffect)((function(){a.value=n?Object(M.a)(1,{duration:100}):Object(M.a)(0,{duration:100})}),[n]),Object(A.jsx)(oe.a,{style:{padding:4*L.a},onPress:function(){r(!n)},children:Object(A.jsx)(O.a,{style:{width:20*L.a,height:20*L.a,backgroundColor:g.b.gray700,borderColor:g.b.gray600,borderWidth:1*L.a,borderRadius:4*L.a,alignItems:"center",justifyContent:"center"},children:Object(A.jsx)(R.default.View,{style:[c],children:Object(A.jsx)(H.a,{name:"check",size:12*L.a,color:g.b.gray50})})})})};function rr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ar,cr,or=function(e){var t,n=e.dark,r=e.n,a=e.handlePress,c=e.courseName,o=e.selecting,i=e.setSelecting,s=e.selected,l=e.onSelectionChange,u=Object(E.a)(0),b=Object(T.a)(((t=function(){return{width:32*L.a*u.value,transform:[{scale:u.value}],alignItems:"flex-start"}})._closure={p:L.a,offset:u},t.asString="function _f(){const{p,offset}=jsThis._closure;{return{width:32*p*offset.value,transform:[{scale:offset.value}],alignItems:'flex-start'};}}",t.__workletHash=0xdf564b7d8b3,t.__location="/home/runner/work/open-polito/open-polito/src/screens/Notifications.tsx (72:45)",t.__optimalization=3,t));return Object(j.useEffect)((function(){u.value=Object(M.a)(o?1:0,{duration:150})}),[o]),Object(A.jsx)(O.a,{style:{flex:1},children:Object(A.jsx)(Kt.LongPressGestureHandler,{onHandlerStateChange:function(e){e.nativeEvent.state===Kt.State.ACTIVE&&(o||(i(!0),l(r.id,!0)))},children:Object(A.jsxs)(R.default.View,{style:{marginBottom:24*L.a,flexDirection:"row",alignItems:"center"},children:[Object(A.jsx)(R.default.View,{style:[b],children:Object(A.jsx)(nr,{selected:s,onChange:function(e){return l(r.id,e)}})}),Object(A.jsx)(oe.a,{parentStyle:{flex:1},onPress:function(){return a(r.id)},children:Object(A.jsx)(Le,{type:r.topic,notification:r,dark:n,read:r.is_read,courseName:c})})]})})})},ir=function(){var e=Object(m.a)().t,t=Object(h.b)(),n=[{label:e("allF"),value:"all"},{label:e("readF"),value:"read"},{label:e("unreadF"),value:"unread"},{label:e("directAlerts"),value:"direct"},{label:e("courses"),value:"course"},{label:e("material"),value:"material"}],r=Object(j.useMemo)((function(){return Q.a.create({container:{paddingTop:24*L.a,flex:1},paddingHorizontal:{paddingHorizontal:16*L.a},list:{paddingHorizontal:16*L.a,paddingBottom:24*L.a}})}),[]),a=Object(h.c)((function(e){return e.user})),c=a.notifications,o=a.getNotificationsStatus,i=Object(h.c)((function(e){return e.courses})),l=Object(j.useContext)(z.a),b=l.device,f=l.dark,y=Object(j.useState)("all"),x=d()(y,2),v=x[0],w=x[1],k=Object(j.useState)(!1),C=d()(k,2),S=C[0],D=C[1],P=function(){D(!0),t(Object(wt.d)(b))};Object(j.useEffect)((function(){S&&o.code!==p.b.PENDING&&D(!1)}),[c,S,o.code,i]);var I,_=function(e){var t=c.findIndex((function(t){return t.id==e}));if(-1!==t&&!c[t].is_read){s()((function*(){yield Object(Te.markNotificationRead)(b,e)}))();var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rr(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},c[t]);n.is_read=!0,Un.a.dispatch(Object(wt.f)([].concat(Z()(c.slice(0,t)),[n],Z()(c.slice(t+1)))))}},N=Object(j.useMemo)((function(){switch(v){case"all":return c;case"read":return c.filter((function(e){return e.is_read}));case"unread":return c.filter((function(e){return!e.is_read}));case"direct":return c.filter((function(e){return e.topic===Te.NotificationType.DIRECT}));case"course":return c.filter((function(e){return e.topic===Te.NotificationType.NOTICE}));case"material":return c.filter((function(e){return e.topic===Te.NotificationType.MATERIAL}));default:return[]}}),[c,v]),B=Object(j.useState)(!1),F=d()(B,2),U=F[0],G=F[1],Y=Object(j.useState)([]),W=d()(Y,2),q=W[0],J=W[1],K=Object(E.a)(1),$=Object(T.a)(((I=function(){return{transform:[{scale:.75+.25*K.value},{translateY:128*L.a*(1-K.value)}]}})._closure={tabOffset:K,p:L.a},I.asString="function _f(){const{tabOffset,p}=jsThis._closure;{return{transform:[{scale:0.75+0.25*tabOffset.value},{translateY:128*p*(1-tabOffset.value)}]};}}",I.__workletHash=4306454263167,I.__location="/home/runner/work/open-polito/open-polito/src/screens/Notifications.tsx (253:37)",I.__optimalization=3,I));Object(j.useEffect)((function(){K.value=Object(M.a)(U?1:0,{duration:200})}),[U]),Object(j.useEffect)((function(){U||J([])}),[U]);Object(j.useEffect)((function(){0===q.length&&G(!1)}),[q]);var te=Object(j.useCallback)((function(){return U?(G(!1),!0):(J([]),!1)}),[U]);Object(j.useEffect)((function(){J([]),G(!1)}),[v]),Object(j.useEffect)((function(){return tr.a.addEventListener("hardwareBackPress",te),function(){G(!1),J([]),tr.a.removeEventListener("hardwareBackPress",te)}}),[]);var re=Object(j.useState)(!1),ae=d()(re,2),ce=ae[0],ie=ae[1],se=function(){for(var e=!0,t=0;t<N.length;t++)if(!q.includes(N[t].id)){e=!1;break}return e},le=[{icon:se()?"circle-minus":"circle-plus",value:"selectAll",label:se()?e("deselectAll"):e("selectAll"),action:function(){return se()?J([]):J(N.map((function(e){return e.id})))}},{icon:ce?"loading":"trash",value:"delete",label:e("delete"),action:function(){s()((function*(){ie(!0);for(var e=0;e<q.length;e++)yield Object(Te.deleteNotification)(b,q[e]);setTimeout((function(){ie(!1),G(!1)}),500),P()}))()}},{icon:"checks",value:"markAsRead",label:e("markAsRead"),action:function(){q.forEach((function(e){return _(e)})),G(!1)}}];return Object(A.jsxs)(Ge.a,{children:[Object(A.jsx)(R.default.View,{style:[$,{position:"absolute",bottom:16*L.a,left:0,right:0,zIndex:1e3,backgroundColor:f?g.b.gray700:g.b.gray200,paddingVertical:8*L.a,marginHorizontal:16*L.a,borderRadius:16*L.a,borderWidth:1*L.a,borderColor:f?g.b.gray600:g.b.gray300,flexDirection:"row",justifyContent:"center",alignItems:"center"}],children:le.map((function(e){return Object(A.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(A.jsxs)(oe.a,{disabled:"loading"===e.icon,style:{justifyContent:"center",alignItems:"center"},onPress:e.action,children:["loading"===e.icon?Object(A.jsx)(ue.a,{color:g.b.accent300,size:20*L.a}):Object(A.jsx)(H.a,{name:e.icon,color:g.b.accent300,size:20*L.a}),Object(A.jsx)(O.a,{style:{height:4*L.a}}),Object(A.jsx)(V.a,{c:g.b.accent300,w:"r",s:10*L.a,children:e.label})]})})}))}),Object(A.jsx)($e,{headerType:qe.MAIN,title:e("notifications")}),Object(A.jsx)(nt,{adjusted:!0,dark:f,items:n,onChange:function(e){return w(n[e].value)}}),Object(A.jsx)(O.a,{style:r.container,children:Object(A.jsx)(ee.a,{contentContainerStyle:r.paddingHorizontal,data:N,keyExtractor:function(e){return e.id.toString()},ListEmptyComponent:Object(A.jsx)(ne,{}),refreshControl:Object(A.jsx)(X.a,{refreshing:S,onRefresh:P}),initialNumToRender:10,maxToRenderPerBatch:10,renderItem:function(e){return Object(A.jsx)(or,{dark:f,n:e.item,handlePress:function(e){return _(e)},courseName:(t=e.item,(null==(n=i.courses.find((function(e){return e.basicInfo.id_incarico===t.course})))?void 0:n.basicInfo.name)||""),selecting:U,setSelecting:function(e){return G(e)},selected:q.includes(e.item.id),onSelectionChange:function(e,t){return function(e,t){J(t?[].concat(Z()(q),[e]):q.filter((function(t){return t!==e})))}(e,t)}});var t,n}})})]})},sr=n(45),lr=sr.a.UpdaterModule,ur=sr.a.NotificationModule,br=function(e,t){return"mobile"!==v.a?function(){throw new Error("Native function "+t+" is not available on "+v.a)}:e[t]||function(){}};function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(ar||(ar={})).installUpdate=br(lr,"installUpdate"),(cr||(cr={})).getToken=br(ur,"getToken");var jr=Object(Bt.a)();function fr(){var e=Object(h.b)(),t=Object(j.useContext)(z.a),n=t.dark,r=t.device,a=t.size,c=Object(h.c)((function(e){return e.user})).getNotificationsStatus,o=Object(h.c)((function(e){return e.session})).loginStatus,i=Object(h.c)((function(e){return e.courses})),l=i.courses,b=i.getRecentMaterialStatus,d=i.loadCoursesStatus;Object(j.useEffect)((function(){o.code===p.b.IDLE&&e(Object(Qe.b)({method:"token",device:r}))}),[o,r,e]),Object(j.useEffect)((function(){c.code===p.b.IDLE&&o.code===p.b.SUCCESS&&e(Object(wt.d)(r))}),[c,o]),Object(j.useEffect)((function(){o.code===p.b.SUCCESS&&(e(Object(Ue.d)(r)),e(Object(wt.e)(r)),s()((function*(){if("android"===f.a.OS&&"debug"!==y.a.VARIANT){var e=yield cr.getToken();yield Object(Te.registerPushNotifications)(r,e)}}))())}),[o]),Object(j.useEffect)((function(){s()((function*(){d.code===p.b.SUCCESS&&(e(Object(Ue.e)(Object(p.e)())),l.forEach((function(t){t.status.code===p.b.IDLE&&e(Object(Ue.c)({basicCourseInfo:t.basicInfo,device:r}))})))}))()}),[d]),Object(j.useEffect)((function(){if(b.code===p.b.IDLE&&d.code===p.b.SUCCESS){var t=!0;l.forEach((function(e){e.status.code!==p.b.SUCCESS&&(t=!1)})),t&&(e(Object(Ue.e)(Object(p.g)())),e(Object(Ue.b)()))}}),[l,b]);var O=Object(j.useCallback)((function(e){return Object(A.jsx)(Jt,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({dark:n},e))}),[n]);return Object(A.jsxs)(jr.Navigator,{screenOptions:{headerShown:!1,drawerType:a>=N.a.lg?"permanent":"front"},useLegacyImplementation:!0,drawerContent:function(e){return O(e)},children:[Object(A.jsx)(jr.Screen,{name:"Home",component:xt}),Object(A.jsx)(jr.Screen,{name:"Email",component:St}),Object(A.jsx)(jr.Screen,{name:"Notifications",component:ir}),Object(A.jsx)(jr.Screen,{name:"Settings",component:zt}),Object(A.jsx)(jr.Screen,{name:"Courses",component:er}),Object(A.jsx)(jr.Screen,{name:"Material",component:Nt}),Object(A.jsx)(jr.Screen,{name:"Bookings",component:on}),Object(A.jsx)(jr.Screen,{name:"Timetable",component:Tn}),Object(A.jsx)(jr.Screen,{name:"Exams",component:Vn}),Object(A.jsx)(jr.Screen,{name:"ExamSessions",component:Qn}),Object(A.jsx)(jr.Screen,{name:"Maps",component:Kn}),Object(A.jsx)(jr.Screen,{name:"Classrooms",component:Zn}),Object(A.jsx)(jr.Screen,{name:"People",component:$n})]})}var Or=Object(J.a)(),gr=function(){return Object(A.jsx)(q.a,{children:Object(A.jsxs)(Or.Navigator,{screenOptions:{headerShown:!1},children:[Object(A.jsx)(Or.Screen,{name:"HomeRouter",component:fr}),Object(A.jsx)(Or.Screen,{name:"Search",component:ut}),Object(A.jsx)(Or.Screen,{name:"Course",component:ct}),Object(A.jsx)(Or.Screen,{name:"Video",component:gt})]})})},mr=n(661),hr=n(333);function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xr(){var e=Object(m.a)().t,t=Object(j.useContext)(D.a).setModal,n=Object(j.useContext)(z.a).dark;Object(j.useEffect)((function(){Object(Wn.d)(Object(Wn.a)())}),[]);var r=Object(j.useState)({checked:!1,acceptedUpdate:!1}),a=d()(r,2),c=a[0],o=a[1];Object(j.useEffect)((function(){c.checked||C().then((function(e){return o((function(t){return yr(yr({},t),{},{releaseData:e,checked:!0})}))})),S()}),[c.checked]),Object(j.useEffect)((function(){s()((function*(){if(c.acceptedUpdate&&"desktop"===v.a){var e=(yield hr.a.process).exit;yield Object(ye.a)("https://github.com/open-polito/open-polito/releases/latest"),e(0)}}))()}),[c.acceptedUpdate]),Object(j.useEffect)((function(){if(c.releaseData){var r=Object(G.getLocales)()[0].languageCode,a=c.releaseData.notes.find((function(e){return e.language===r}));t(Object(A.jsxs)(U,{title:e("newUpdateModalTitle"),icon:"download",accentColor:"#2dba2a",onConfirm:function(){return o((function(e){return yr(yr({},e),{},{acceptedUpdate:!0})}))},children:[Object(A.jsx)(V.a,{s:12*L.a,w:"m",c:n?g.b.gray100:g.b.gray800,children:e("newUpdateModalText")+"\n\n"+e("newUpdateModalNotes")+"\n"}),"text"===c.releaseData.format?((null==a?void 0:a.content)||[]).map((function(e){return Object(A.jsx)(V.a,{s:12*L.a,w:"r",c:n?g.b.gray100:g.b.gray800,children:"  • "+e})})):((null==a?void 0:a.content)||[]).map((function(e){return Object(A.jsx)(Y.RenderHTMLSource,{source:{html:e}})}))]}))}}),[c.releaseData,n,t,e]);var i=Object(h.c)((function(e){return e.session})).authStatus,l=Object(h.c)((function(e){return e.session.config})).logging,u=Object(j.useState)(null),b=d()(u,2),y=b[0],x=b[1];Object(j.useEffect)((function(){x(l?w({text:e("Logging enabled"),type:"warn"}):null)}),[l,e]);var w=function(e){var t=e.text,n=void 0===t?"":t,r=e.type,a=void 0===r?"warn":r;return Object(A.jsx)(O.a,{style:{backgroundColor:"warn"==a?g.b.orange:g.b.black,paddingVertical:4,flexDirection:"row",justifyContent:"center"},children:Object(A.jsx)(V.a,{s:10*L.a,w:"m",c:g.b.white,children:n})})},k=Object(j.useMemo)((function(){return Object(A.jsxs)(A.Fragment,{children:[y,c.acceptedUpdate&&"android"===f.a.OS?Object(A.jsx)(W,{releaseData:c.releaseData}):i!==p.a.NOT_VALID?Object(A.jsx)(gr,{}):null]})}),[i,y,c]);return"web"===v.a?Object(A.jsx)(mr.default,{children:k}):k}}}]);
//# sourceMappingURL=4.b3917f5d.chunk.js.map